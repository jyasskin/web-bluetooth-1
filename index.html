<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <title>Web Bluetooth</title>
<style data-fill-with="stylesheet">/* This section copied from the W3C's ED styles. */

	body {
		color: black;
		font-family: sans-serif;
		margin: 0 auto;
		max-width: 50em;
		padding: 2em 1em 2em 70px;
	}
	:link { color: #00C; background: transparent }
	:visited { color: #609; background: transparent }
	a[href]:active { color: #C00; background: transparent }
	a[href]:hover { background: #ffa }

	a[href] img { border-style: none }

	h1, h2, h3, h4, h5, h6 { text-align: left }
	h1, h2, h3 { color: #005A9C; }
	h1 { font: 170% sans-serif }
	h2 { font: 140% sans-serif }
	h3 { font: 120% sans-serif }
	h4 { font: bold 100% sans-serif }
	h5 { font: italic 100% sans-serif }
	h6 { font: small-caps 100% sans-serif }

	.hide { display: none }

	div.head { margin-bottom: 1em }
	div.head h1 { margin-top: 2em; clear: both }
	div.head table { margin-left: 2em; margin-top: 2em }

	p.copyright { font-size: small }
	p.copyright small { font-size: small }

	pre { margin-left: 2em }
	dt { font-weight: bold }

	ul.toc, ol.toc {
		list-style: none;
	}

/* The rest copied from the CSSWG's default.css */

	body {
		counter-reset: exampleno figure issue;
		max-width: 50em;
		margin: 0 auto !important;
		line-height: 1.5;
	}

/******************************************************************************/
/*                                Sectioning                                  */
/******************************************************************************/

/** Headings ******************************************************************/

	h1, h2, h3, h4, h5, h6, dt {
		page-break-after: avoid;
	}

	h2, h3, h5, h6 {
		margin-top: 3em;
	}
	h4 {
		 margin-top: 4em;
	}

/** Subheadings ***************************************************************/

	h1 + h2,
	#subtitle + h2 {
		/* #subtitle is a subtitle in an H2 under the H1 */
		margin-top: 0;
	}
	h2 + h3,
	h3 + h4,
	h4 + h5,
	h5 + h6 {
		margin-top: 1.2em; /* = 1 x line-height */
	}

/** Section divider ***********************************************************/
	/* &lt;hr> used to separate TMI into the second half of a section              */
	hr:not([title]) {
		font-size: 1.5em;
		text-align: center;
		margin: 1em auto;
		height: auto;
		border: transparent solid 0;
		background: transparent;
	}
	hr:not([title])::before {
		content: "\1F411\2003\2003\1F411\2003\2003\1F411";
	}
	/* note: &lt;hr> with title separates document header from contents */

/******************************************************************************/
/*                            Paragraphs and Lists                            */
/******************************************************************************/

	p {
		margin: 1em 0;
	}
	dd     > p:first-child,
	li     > p:first-child {
		margin-top: 0;
	}

	ul, ol {
		margin-left: 0;
		padding-left: 2em;
	}
	li {
		margin: 0.25em 2em 0.5em 0;
		padding-left: 0;
	}

	dl dd {
		margin: 0 0 1em 2em;
	}
	.head dd {
		margin-bottom: 0;
	}

	/* Style for algorithms */
	ol.algorithm ol {
	 border-left: 1px solid #90b8de;
	 margin-left: 1em;
	}
	ol.algorithm ol.algorithm {
	 border-left: none;
	 margin-left: 0;
	}

	/* Style for switch/case &lt;dl>s */
	dl.switch > dd > ol.only {
	 margin-left: 0;
	}
	dl.switch > dd > ol.algorithm {
	 margin-left: -2em;
	}
	dl.switch {
	 padding-left: 2em;
	}
	dl.switch > dt {
	 text-indent: -1.5em;
	 margin-top: 1em;
	}
	dl.switch > dt + dt {
	 margin-top: 0;
	}
	dl.switch > dt::before {
	 content: '\21AA';
	 padding: 0 0.5em 0 0;
	 display: inline-block;
	 width: 1em;
	 text-align: right;
	 line-height: 0.5em;
	}

	/* Style for paragraphs I know are in MD-genned lists */
	[data-md] > :first-child {
		margin-top: 0;
	}
	[data-md] > :last-child {
		margin-bottom: 0;
	}

/** Inline Lists **************************************************************/
	/* This is mostly to make the list inside the CR exit criteria more compact. */

	ol.inline, ol.inline li {
		display: inline;
		padding: 0; margin: 0;
	}
	ol.inline {
		counter-reset: list-item;
	}
	ol.inline li {
		counter-increment: list-item;
	}
	ol.inline li::before {
		content: "(" counter(list-item) ") ";
		font-weight: bold;
	}

/** Terminology Markup ********************************************************/


/******************************************************************************/
/*                                 Inline Markup                              */
/******************************************************************************/

/** Terminology Markup ********************************************************/
	dfn   { /* Defining instance */
		font-weight: bolder;
	}
	a > i { /* Instance of term */
		font-style: normal;
	}
	dt dfn code, code.idl {
		font-size: inherit;
	}
	dfn var {
		font-style: normal;
	}

/** Change Marking ************************************************************/

	del { color: red;  text-decoration: line-through; }
	ins { color: #080; text-decoration: underline;    }

/** Miscellaneous improvements to inline formatting ***************************/

	sup {
		vertical-align: super;
		font-size: 80%
	}

/******************************************************************************/
/*                                    Code                                    */
/******************************************************************************/

/** General monospace/pre rules ***********************************************/

	pre, code {
		font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
		font-size: .9em;
		page-break-inside: avoid;
	}
	pre {
		margin-top: 1em;
		margin-bottom: 1em;
		overflow: auto;
	}

/** Syntax-Highlighted Code ***************************************************/

	.example pre[class*="language-"],
	.example [class*="language-"] pre,
	.example pre[class*="lang-"],
	.example [class*="lang-"] pre {
		background: transparent; /* Prism applies a gray background that doesn't work well in the template. */
	}

/** Example Code **************************************************************/

	div.html, div.xml,
	pre.html, pre.xml {
		padding: 0.5em;
		margin: 1em 0;
		position: relative;
		clear: both;
		color: #600;
	}
	pre.example,
	pre.html,
	pre.xml {
		padding-top: 1.5em;
	}

	pre.illegal, .illegal pre
	pre.deprecated, .deprecated pre {
		color: red;
	}

/** IDL fragments *************************************************************/

	pre.idl {
		/* Match blue propdef boxes */
		padding: .5em 1em;
		background: #DEF;
		margin: 1.2em 0;
		border-left: 0.5em solid #8CCBF2;
	}
	pre.idl :link, pre.idl :visited {
		color:inherit;
		background:transparent;
	}

/** Inline CSS fragments ******************************************************/

	.css.css, .property.property, .descriptor.descriptor {
		color: #005a9c;
		font-size: inherit;
		font-family: inherit;
	}
	.css::before, .property::before, .descriptor::before {
		content: "‘";
	}
	.css::after, .property::after, .descriptor::after {
		content: "’";
	}
	.property, .descriptor {
		/* Don't wrap property and descriptor names */
		white-space: nowrap;
	}
	.type { /* CSS value &lt;type> */
	font-style: italic;
	}
	pre .property::before, pre .property::after {
		content: "";
	}

/** Inline markup fragments ***************************************************/

	code.html, code.xml {
		color: #660000;
	}

/** Autolinks produced using Bikeshed *****************************************/

	[data-link-type="property"]::before,
	[data-link-type="propdesc"]::before,
	[data-link-type="descriptor"]::before,
	[data-link-type="value"]::before,
	[data-link-type="function"]::before,
	[data-link-type="at-rule"]::before,
	[data-link-type="selector"]::before,
	[data-link-type="maybe"]::before {
		content: "‘";
	}
	[data-link-type="property"]::after,
	[data-link-type="propdesc"]::after,
	[data-link-type="descriptor"]::after,
	[data-link-type="value"]::after,
	[data-link-type="function"]::after,
	[data-link-type="at-rule"]::after,
	[data-link-type="selector"]::after,
	[data-link-type="maybe"]::after {
		content: "’";
	}

	[data-link-type].production::before,
	[data-link-type].production::after,
	.prod [data-link-type]::before,
	.prod [data-link-type]::after {
		content: "";
	}

	[data-link-type=element]         { font-family: monospace; }
	[data-link-type=element]::before { content: "&lt;" }
	[data-link-type=element]::after  { content: ">" }

	[data-link-type=biblio] {
		white-space: pre;
	}


/******************************************************************************/
/*                                    Links                                   */
/******************************************************************************/

/** General Hyperlinks ********************************************************/

	/* We hyperlink a lot, so make it less intrusive */
	a:link, a:visited {
		color: inherit;
		text-decoration: none;
		border-bottom: 1px solid silver;
	}
	@supports (text-decoration-color: silver) {
		a:link, a:visited {
			border-bottom: none;
			text-decoration: underline;
			text-decoration-color: silver;
		}
		a:visited {
			text-decoration-style: dotted;
		}
	}

	a.logo:link, a.logo:visited { /* backout above styling for W3C logo */
		padding: 0;
		border: none;
		text-decoration: none;
	}

/** Self-Links ****************************************************************/
	/* Auto-generated links from an element to its own anchor, for usability */

	.heading, .issue, .note, .example, li, dt {
		position: relative;
	}
	a.self-link {
		position: absolute;
		top: 0;
		left: -2.5em;
		width: 2em;
		height: 2em;
		text-align: center;
		border: none;
		transition: opacity .2s;
		opacity: .5;
	}
	a.self-link:hover {
		opacity: 1;
	}
	.heading > a.self-link {
		font-size: 83%;
	}
	li > a.self-link {
		left: -3.5em;
	}
	dfn > a.self-link {
		top: auto;
		left: auto;
		opacity: 0;
		width: 1.5em;
		height: 1.5em;
		background: gray;
		color: white;
		font-style: normal;
		transition: opacity .2s, background-color .2s, color .2s;
	}
	dfn:hover > a.self-link {
		opacity: 1;
	}
	dfn > a.self-link:hover {
		color: black;
	}

	a.self-link::before            { content: "¶"; }
	.heading > a.self-link::before { content: "§"; }
	dfn > a.self-link::before      { content: "#"; }

/******************************************************************************/
/*                                    Images                                  */
/******************************************************************************/

	img {
		border-style: none;
		color: white;
	}

	figure, div.figure, div.sidefigure {
		page-break-inside: avoid;
	}

	div.figure, p.figure, div.sidefigure, figure {
		text-align: center;
		margin: 2.5em 0;
	}
	div.figure pre, div.sidefigure pre, figure pre {
		text-align: left;
		display: table;
		margin: 1em auto;
	}
	.figure table, figure table {
		margin: auto;
	}
	div.sidefigure, figure.sidefigure {
		float: right;
		width: 50%;
		margin: 0 0 0.5em 0.5em
	}
	div.figure img, div.sidefigure img, figure img,
	div.figure object, div.sidefigure object, figure object {
		display: block;
		margin: auto;
		max-width: 100%
	}
	p.caption, figcaption, caption {
		text-align: center;
		font-style: italic;
		font-size: 90%;
	}
	p.caption:not(.no-marker)::before, figcaption:not(.no-marker)::before {
		content: "Figure " counter(figure) ". ";
	}
	p.caption::before, figcaption::before, figcaption > .marker {
		font-weight: bold;
	}
	p.caption, figcaption {
		counter-increment: figure;
	}

	/* DL list is indented 2em, but figure inside it is not */
	dd > div.figure, dd > figure { margin-left: -2em }

	pre.ascii-art {
		display: table; /* shrinkwrap */
		margin: 1em auto;
	}

	/* Displaying the output of text layout, particularly when
		 line-breaking is being invoked, and thus having a
		 visible width is good. */
	pre.output {
		margin: 1em;
		border: solid thin silver;
		padding: 0.25em;
		display: table;
	}

/******************************************************************************/
/*                             Colored Boxes                                  */
/******************************************************************************/

	.issue, .note, .example, .why, .advisement, blockquote {
		padding: .5em;
		border: .5em;
		border-left-style: solid;
		page-break-inside: avoid;
	}
	span.issue, span.note {
		padding: .1em .5em .15em;
		border-right-style: solid;
	}

	div.issue,
	div.note,
	div.example,
	details.why,
	blockquote {
		margin: 1em auto;
	}
	.note  > p:first-child,
	.issue > p:first-child,
	blockquote > :first-child {
		margin-top: 0;
	}
	blockquote > :last-child {
		margin-bottom: 0;
	}

/** Blockquotes ***************************************************************/

	blockquote {
		border-color: silver;
	}

/** Open issue ****************************************************************/
	/* not intended for CR+ publication */

	.issue {
		border-color: #E05252;
		background: #FBE9E9;
		counter-increment: issue;
		overflow: auto;
	}
	.issue:not(.no-marker)::before {
		content: "ISSUE " counter(issue);
		padding-right: 1em;
	}
	.issue::before, .issue > .marker {
		color: #AE1E1E;
	}

/** Example *******************************************************************/

	.example {
		border-color: #E0CB52;
		background: #FCFAEE;
		counter-increment: exampleno;
		overflow: auto;
		clear: both;
	}
	.example::before, .example > .marker {
		color: #827017;
		font-family: sans-serif;
		min-width: 7.5em;
		display: block;
	}
	.example:not(.no-marker)::before {
		content: "EXAMPLE";
		content: "EXAMPLE " counter(exampleno);
	}
	.invalid.example::before, .invalid.example > .marker,
	.illegal.example::before, .illegal.example > .marker {
		color: red;
	}
	.invalid.example:not(.no-marker)::before,
	.illegal.example:not(.no-marker)::before {
		content: "INVALID EXAMPLE";
		content: "INVALID EXAMPLE" counter(exampleno);
	}

/** Non-normative Note ********************************************************/

	.note, .why {
		border-color: #52E052;
		background: #E9FBE9;
		overflow: auto;
	}
	.note::before, .note > .marker {
		display: block;
		color: hsl(120, 70%, 30%);
	}

/** Advisement Box ************************************************************/
	/*  for attention-grabbing normative statements */

	.advisement {
		border-color: orange;
		border-style: none solid;
		background: #FFEECC;
		text-align: center;
	}
	strong.advisement {
		display: block;
	}
	/*.advisement::before { color: #FF8800; } */

/** ??? ***********************************************************************/

	details.why {
		border-color: #52E052;
		background: #E9FBE9;
		display: block;
	}

	details.why > summary {
		font-style: italic;
		display: block;
	}

	details.why[open] > summary {
		border-bottom: 1px silver solid;
	}

/** Spec Obsoletion Notice ****************************************************/
	/* obnoxious obsoletion notice for older/abandoned specs. */

	details.annoying-warning {
		display: block;
	}

	details.annoying-warning[open] {
		background: #fdd;
		color: red;
		font-weight: bold;
		text-align: center;
		padding: .5em;
		border: thick solid red;
		border-radius: 1em;
	}
@media not print {
	details.annoying-warning[open] {
		position: fixed;
		left: 1em;
		right: 1em;
		bottom: 1em;
		z-index: 1000;
	}
}

	details.annoying-warning:not([open]) > summary {
		background: #fdd;
		color: red;
		font-weight: bold;
		text-align: center;
		padding: .5em;
	}

/******************************************************************************/
/*                                    Tables                                  */
/******************************************************************************/

/** Property/Descriptor Definition Tables *************************************/

	table.propdef, table.propdef-extra,
	table.descdef, table.definition-table {
		page-break-inside: avoid;
		width: 100%;
		margin: 1.2em 0;
		border-left: 0.5em solid #8CCBF2;
		padding: 0.5em 1em;
		background: #DEF;
		border-spacing: 0;
	}

	table.propdef td, table.propdef-extra td,
	table.descdef td, table.definition-table td,
	table.propdef th, table.propdef-extra th,
	table.descdef th, table.definition-table th {
		padding: 0.5em;
		vertical-align: baseline;
		border-bottom: 1px solid #bbd7e9;
	}
	table.propdef > tbody > tr:last-child th,
	table.propdef-extra > tbody > tr:last-child th,
	table.descdef > tbody > tr:last-child th,
	table.definition-table > tbody > tr:last-child th,
	table.propdef > tbody > tr:last-child td,
	table.propdef-extra > tbody > tr:last-child td,
	table.descdef > tbody > tr:last-child td,
	table.definition-table > tbody > tr:last-child td {
		border-bottom: 0;
	}

	table.propdef th,
	table.propdef-extra th,
	table.descdef th,
	table.definition-table th {
		font-style: italic;
		font-weight: normal;
		width: 8.3em;
		padding-left: 1em;
	}

	/* For when values are extra-complex and need formatting for readability */
	table td.pre {
		white-space: pre-wrap;
	}

	/* A footnote at the bottom of a propdef */
	table.propdef td.footnote,
	table.propdef-extra td.footnote,
	table.descdef td.footnote,
	table.definition-table td.footnote {
		padding-top: 0.6em;
	}
	table.propdef td.footnote::before,
	table.propdef-extra td.footnote::before,
	table.descdef td.footnote::before,
	table.definition-table td.footnote::before {
		content: " ";
		display: block;
		height: 0.6em;
		width: 4em;
		border-top: thin solid;
	}

/** Profile Tables ************************************************************/
	/* table of required features in a CSS profile */

	table.features th {
		background: #00589f;
		color: #fff;
		text-align: left;
		padding: 0.2em 0.2em 0.2em 0.5em;
	}
	table.features td {
		vertical-align: top;
		border-bottom: 1px solid #ccc;
		padding: 0.3em 0.3em 0.3em 0.7em;
	}

/** Data tables (and properly marked-up proptables) ***************************/
	/*
		 &lt;table class="data"> highlights structural relationships in a table
		 when correct markup is used (e.g. thead/tbody, th vs. td, scope attribute)

		 Use class="complex data" for particularly complicated tables --
		 (This will draw more lines: busier, but clearer.)

		 Use class="long" on table cells with paragraph-like contents
		 (This will adjust text alignment accordingly.)
	*/

	.data, .proptable {
		margin: 1em auto;
		border-collapse: collapse;
		width: 100%;
		border: hidden;
	}
	.data {
		text-align: center;
		width: auto;
	}
	.data caption {
		width: 100%;
	}

	.data td, .data th,
	.proptable td, .proptable th {
		padding: 0.5em;
		border-width: 1px;
		border-color: silver;
		border-top-style: solid;
	}

	.data thead td:empty {
		padding: 0;
		border: 0;
	}

	.data thead th[scope="row"],
	.proptable thead th[scope="row"] {
		text-align: right;
		color: inherit;
	}

	.data thead,
	.proptable thead,
	.data tbody,
	.proptable tbody {
		color: inherit;
		border-bottom: 2px solid;
	}

	.data colgroup {
		border-left: 2px solid;
	}

	.data tbody th:first-child,
	.proptable tbody th:first-child ,
	.data tbody td[scope="row"]:first-child,
	.proptable tbody td[scope="row"]:first-child {
		text-align: right;
		color: inherit;
		border-right: 2px solid;
		border-top: 1px solid silver;
		padding-right: 1em;
	}
	.data.define td:last-child {
		text-align: left;
	}

	.data tbody th[rowspan],
	.proptable tbody th[rowspan],
	.data tbody td[rowspan],
	.proptable tbody td[rowspan]{
		border-left:  1px solid silver;
		border-right: 1px solid silver;
	}

	.complex.data th,
	.complex.data td {
		border: 1px solid silver;
	}

	.data td.long {
	 vertical-align: baseline;
	 text-align: left;
	}

	.data img {
		vertical-align: middle;
	}


/******************************************************************************/
/*                                  Indices                                   */
/******************************************************************************/


/** Table of Contents *********************************************************/

	/* ToC not indented, but font style shows hierarchy */
	ul.toc           { margin: 1em 0;     font-weight: bold; /*text-transform: uppercase;*/ }
	ul.toc ul        { margin: 0;        font-weight: normal; text-transform: none; }
	ul.toc ul ul     { margin: 0 0 0 2em; font-style: italic; }
	ul.toc ul ul ul  { margin: 0; }
	ul.toc > li      { margin: 1.5em 0; }
	ul.toc ul.toc li { margin: 0.3em 0 0 0; }

	ul.toc, ul.toc ul, ul.toc li { padding: 0; line-height: 1.3; }
	ul.toc a { text-decoration: none; border-bottom-style: none; }
	ul.toc a:hover, ul.toc a:focus  { border-bottom-style: solid; }
	@supports (text-decoration-style: solid) {
		ul.toc a:hover, ul.toc a:focus  {
			border-bottom-style: none;
			text-decoration-style: solid;
		}
	}
	/*
	ul.toc li li li, ul.toc li li li ul {margin-left: 0; display: inline}
	ul.toc li li li ul, ul.toc li li li ul li {margin-left: 0; display: inline}
	*/

	/* Section numbers in a column of their own */
	ul.toc {
		margin-left: 5em
	}
	ul.toc span.secno {
		float: left;
		width: 4em;
		margin-left: -5em;
	}
	ul.toc ul ul span.secno {
		margin-left: -7em;
	}
	/*ul.toc span.secno {text-align: right}*/
	ul.toc li {
		clear: both;
	}
	/* If we had 'tab', floats would not be needed here:
		 ul.toc span.secno {tab: 5em right; margin-right: 1em}
		 ul.toc li {text-indent: 5em hanging}
	 The second line in case items wrap
	*/

/** At-risk List **************************************************************/
	/* Style for At Risk features (intended as editorial aid, not intended for publishing) */

	.atrisk::before {
	 float: right;
	 margin-top: -0.25em;
	 padding: 0.5em 1em 0.5em 0;
	 text-indent: -0.9em;
	 border: 1px solid;
	 content: '\25C0    Not yet widely implemented';
	 white-space: pre;
	 font-size: small;
	 background-color: white;
	 color: gray;
	 text-align: center;
	}

	.toc .atrisk::before { content:none }

/** Index *********************************************************************/

	/* Index Lists: Layout */
	ul.indexlist       { margin-left: 0; columns: 15em; -webkit-columns: 15em; text-indent: 1em hanging; }
	ul.indexlist li    { margin-left: 0; list-style: none; break-inside: avoid; word-break: break-word; }
	ul.indexlist li li { margin-left: 1em }
	ul.indexlist dl    { margin-top: 0; }
	ul.indexlist dt    { margin: .2em 0 .2em 20px;}
	ul.indexlist dd    { margin: .2em 0 .2em 40px;}
	/* Index Lists: Typography */
	ul.indexlist ul,
	ul.indexlist dl { font-size: smaller; }
	ul.indexlist li span {
		white-space: nowrap;
		position: absolute;
		color: transparent; }
	ul.indexlist li a:hover + span,
	ul.indexlist li a:focus + span {
		color: gray;
	}
	@media print {
		ul.indexlist li span { color: gray; }
	}

/** Property Index Tables *****************************************************/
	/* See also the data table styling section, which this effectively subclasses */

	table.proptable {
		font-size: small;
		border-collapse: collapse;
		border-spacing: 0;
		text-align: left;
		margin: 1em 0;
	}

	table.proptable td,
	table.proptable th {
		padding: 0.4em;
		text-align: center;
	}

	table.proptable tr:hover td {
		background: #DEF;
	}
	.propdef th {
		font-style: italic;
		font-weight: normal;
		text-align: left;
		width: 3em;
	}
	/* The link in the first column in the property table (formerly a TD) */
	table.proptable td .property,
	table.proptable th .property {
		display: block;
		text-align: left;
		font-weight: bold;
	}

/******************************************************************************/
/*                                    Print                                   */
/******************************************************************************/

	@media print {
		html {
			margin: 0 !important; }
		body {
			font-family: serif; }
		th, td {
			font-family: inherit; }
		a {
			color: inherit !important; }

		a:link, a:visited {
			text-decoration: none !important }
		a:link::after, a:visited::after { /* create a cross-ref "see..." */ }
		.example::before {
			font-family: serif !important; }
	}
	@page {
		margin: 1.5cm 1.1cm;
	}

</style>
  <meta content="Bikeshed 1.0.0" name="generator">
<style>
  body {
    padding-left: 160px;
    background-image: url('https://www.w3.org/community/src/css/spec/back-cg-draft.png');
    background-position: top left;
    background-attachment: fixed;
    background-repeat: no-repeat;
  }
</style>
<style>
      .argument-list { display: inline-block; vertical-align: top; }
    </style>
<style>.highlight .hll { background-color: #ffffcc }
.highlight  { background: #ffffff; }
.highlight .c { color: #708090 } /* Comment */
.highlight .k { color: #990055 } /* Keyword */
.highlight .l { color: #669900 } /* Literal */
.highlight .n { color: #0077aa } /* Name */
.highlight .o { color: #999999 } /* Operator */
.highlight .p { color: #999999 } /* Punctuation */
.highlight .cm { color: #708090 } /* Comment.Multiline */
.highlight .cp { color: #708090 } /* Comment.Preproc */
.highlight .c1 { color: #708090 } /* Comment.Single */
.highlight .cs { color: #708090 } /* Comment.Special */
.highlight .kc { color: #990055 } /* Keyword.Constant */
.highlight .kd { color: #990055 } /* Keyword.Declaration */
.highlight .kn { color: #990055 } /* Keyword.Namespace */
.highlight .kp { color: #990055 } /* Keyword.Pseudo */
.highlight .kr { color: #990055 } /* Keyword.Reserved */
.highlight .kt { color: #990055 } /* Keyword.Type */
.highlight .ld { color: #669900 } /* Literal.Date */
.highlight .m { color: #990055 } /* Literal.Number */
.highlight .s { color: #669900 } /* Literal.String */
.highlight .na { color: #0077aa } /* Name.Attribute */
.highlight .nc { color: #0077aa } /* Name.Class */
.highlight .no { color: #0077aa } /* Name.Constant */
.highlight .nd { color: #0077aa } /* Name.Decorator */
.highlight .ni { color: #0077aa } /* Name.Entity */
.highlight .ne { color: #0077aa } /* Name.Exception */
.highlight .nf { color: #0077aa } /* Name.Function */
.highlight .nl { color: #0077aa } /* Name.Label */
.highlight .nn { color: #0077aa } /* Name.Namespace */
.highlight .py { color: #0077aa } /* Name.Property */
.highlight .nt { color: #0077aa } /* Name.Tag */
.highlight .nv { color: #0077aa } /* Name.Variable */
.highlight .ow { color: #999999 } /* Operator.Word */
.highlight .mb { color: #990055 } /* Literal.Number.Bin */
.highlight .mf { color: #990055 } /* Literal.Number.Float */
.highlight .mh { color: #990055 } /* Literal.Number.Hex */
.highlight .mi { color: #990055 } /* Literal.Number.Integer */
.highlight .mo { color: #990055 } /* Literal.Number.Oct */
.highlight .sb { color: #669900 } /* Literal.String.Backtick */
.highlight .sc { color: #669900 } /* Literal.String.Char */
.highlight .sd { color: #669900 } /* Literal.String.Doc */
.highlight .s2 { color: #669900 } /* Literal.String.Double */
.highlight .se { color: #669900 } /* Literal.String.Escape */
.highlight .sh { color: #669900 } /* Literal.String.Heredoc */
.highlight .si { color: #669900 } /* Literal.String.Interpol */
.highlight .sx { color: #669900 } /* Literal.String.Other */
.highlight .sr { color: #669900 } /* Literal.String.Regex */
.highlight .s1 { color: #669900 } /* Literal.String.Single */
.highlight .ss { color: #669900 } /* Literal.String.Symbol */
.highlight .vc { color: #0077aa } /* Name.Variable.Class */
.highlight .vg { color: #0077aa } /* Name.Variable.Global */
.highlight .vi { color: #0077aa } /* Name.Variable.Instance */
.highlight .il { color: #990055 } /* Literal.Number.Integer.Long */
        .highlight { background: hsl(24, 20%, 95%); }
        code.highlight { padding: .1em; border-radius: .3em; }
        pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }
        </style>
 </head>
 <body class="h-entry">
  <div class="head">
   <div data-fill-with="logo"></div>
   <h1 class="p-name no-ref" id="title">Web Bluetooth</h1>
   <h2 class="no-num no-toc no-ref heading settled" id="subtitle"><span class="content">Draft Community Group Report, <time class="dt-updated" datetime="2015-09-13">13 September 2015</time></span></h2>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>This version:
     <dd><a class="u-url" href="https://webbluetoothcg.github.io/web-bluetooth/">https://webbluetoothcg.github.io/web-bluetooth/</a>
     <dt>Issue Tracking:
     <dd><a href="https://github.com/WebBluetoothCG/web-bluetooth/issues/">GitHub</a>
     <dd><a href="#issues-index">Inline In Spec</a>
     <dt class="editor">Editor:
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-url url" href="https://github.com/WebBluetoothCG/web-bluetooth/graphs/contributors">See contributors on GitHub</a>
     <dt>Participate:
     <dd><span><a href="https://www.w3.org/community/web-bluetooth/">Join the W3C Community Group</a></span>
     <dd><span><a href="https://github.com/WebBluetoothCG/web-bluetooth">Fix the text through GitHub</a></span>
     <dd><span><a href="mailto:public-web-bluetooth@w3.org">public-web-bluetooth@w3.org</a> (<a href="https://lists.w3.org/Archives/Public/public-web-bluetooth/" rel="discussion">archives</a>)</span>
     <dd><span><a href="irc://irc.w3.org:6665/#web-bluetooth">IRC: #web-bluetooth on W3C’s IRC</a></span>
     <dd><span></span>
    </dl>
   </div>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 2015 the Contributors to the Web Bluetooth Specification, published by the <a href="https://www.w3.org/community/web-bluetooth/">Web Bluetooth Community Group</a> under the <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a>.
A human-readable <a href="http://www.w3.org/community/about/agreements/cla-deed/">summary</a> is available. </p>
   <hr title="Separator for header">
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
  <div class="p-summary" data-fill-with="abstract">
   <p>This document describes an API to discover and communicate with devices

over the Bluetooth 4 wireless standard using the Generic Attribute Profile (GATT).</p>
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="status"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p> This specification was published by the <a href="https://www.w3.org/community/web-bluetooth/">Web Bluetooth Community Group</a>.
  It is not a W3C Standard nor is it on the W3C Standards Track.

  Please note that under the <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a> there is a limited opt-out and other conditions apply.

  Learn more about <a href="http://www.w3.org/community/">W3C Community and Business Groups</a>. </p>
   <p> Changes to this document may be tracked at <a href="https://github.com/WebBluetoothCG/web-bluetooth/commits/gh-pages">https://github.com/WebBluetoothCG/web-bluetooth/commits/gh-pages</a>. </p>
   <p>If you wish to make comments regarding this document, please send them to <a href="mailto:public-web-bluetooth@w3.org">public-web-bluetooth@w3.org</a> (<a href="mailto:public-web-bluetooth-request@w3.org?subject=subscribe">subscribe</a>, <a href="http://lists.w3.org/Archives/Public/public-web-bluetooth/">archives</a>).</p>
   <p></p>
  </div>
  <div data-fill-with="at-risk"></div>
  <h2 class="no-num no-toc no-ref heading settled" id="contents"><span class="content">Table of Contents</span></h2>
  <div data-fill-with="table-of-contents" role="navigation">
   <ul class="toc" role="directory">
    <li>
     <a href="#introduction"><span class="secno">1</span> <span class="content">Introduction</span></a>
     <ul class="toc">
      <li><a href="#introduction-examples"><span class="secno">1.1</span> <span class="content">Examples</span></a>
     </ul>
    <li>
     <a href="#security-and-privacy"><span class="secno">2</span> <span class="content">Security and privacy considerations</span></a>
     <ul class="toc">
      <li><a href="#device-access-is-powerful"><span class="secno">2.1</span> <span class="content">Device access is powerful</span></a>
      <li><a href="#attacks-on-devices"><span class="secno">2.2</span> <span class="content">Attacks on devices</span></a>
      <li>
       <a href="#bluetooth-device-identifiers"><span class="secno">2.3</span> <span class="content">Bluetooth device identifiers</span></a>
       <ul class="toc">
        <li><a href="#remote-device-identifiers"><span class="secno">2.3.1</span> <span class="content">Identifiers for remote Bluetooth devices</span></a>
        <li><a href="#ua-bluetooth-address"><span class="secno">2.3.2</span> <span class="content">The UA’s Bluetooth address</span></a>
       </ul>
     </ul>
    <li><a href="#device-discovery"><span class="secno">3</span> <span class="content">Device Discovery</span></a>
    <li>
     <a href="#device-representation"><span class="secno">4</span> <span class="content">Device Representation</span></a>
     <ul class="toc">
      <li><a href="#global-device-properties"><span class="secno">4.1</span> <span class="content">Global Bluetooth device properties</span></a>
      <li><a href="#per-origin-device-properties"><span class="secno">4.2</span> <span class="content">Per-origin Bluetooth device properties</span></a>
      <li>
       <a href="#bluetoothdevice"><span class="secno">4.3</span> <span class="content"><span>BluetoothDevice</span></span></a>
       <ul class="toc">
        <li><a href="#bluetoothadvertisingdata"><span class="secno">4.3.1</span> <span class="content"><span>BluetoothAdvertisingData</span></span></a>
       </ul>
     </ul>
    <li>
     <a href="#gatt-interaction"><span class="secno">5</span> <span class="content">GATT Interaction</span></a>
     <ul class="toc">
      <li>
       <a href="#information-model"><span class="secno">5.1</span> <span class="content">GATT Information Model</span></a>
       <ul class="toc">
        <li><a href="#bluetooth-cache"><span class="secno">5.1.1</span> <span class="content">The Bluetooth cache</span></a>
        <li><a href="#navigating-bluetooth-hierarchy"><span class="secno">5.1.2</span> <span class="content">Navigating the Bluetooth Hierarchy</span></a>
        <li><a href="#identifying-attributes"><span class="secno">5.1.3</span> <span class="content">Identifying Services, Characteristics, and Descriptors</span></a>
       </ul>
      <li><a href="#bluetoothgattremoteserver"><span class="secno">5.2</span> <span class="content"><span>BluetoothGATTRemoteServer</span></span></a>
      <li><a href="#bluetoothgattservice"><span class="secno">5.3</span> <span class="content"><span>BluetoothGATTService</span></span></a>
      <li>
       <a href="#bluetoothgattcharacteristic"><span class="secno">5.4</span> <span class="content"><span>BluetoothGATTCharacteristic</span></span></a>
       <ul class="toc">
        <li><a href="#characteristicproperties"><span class="secno">5.4.1</span> <span class="content"><span>BluetoothCharacteristicProperties</span></span></a>
       </ul>
      <li><a href="#bluetoothgattdescriptor"><span class="secno">5.5</span> <span class="content"><span>BluetoothGATTDescriptor</span></span></a>
      <li>
       <a href="#events"><span class="secno">5.6</span> <span class="content">Events</span></a>
       <ul class="toc">
        <li><a href="#bluetooth-tree"><span class="secno">5.6.1</span> <span class="content">Bluetooth Tree</span></a>
        <li><a href="#event-types"><span class="secno">5.6.2</span> <span class="content">Event types</span></a>
        <li><a href="#notification-events"><span class="secno">5.6.3</span> <span class="content">Responding to Notifications and Indications</span></a>
        <li><a href="#service-change-events"><span class="secno">5.6.4</span> <span class="content">Responding to Service Changes</span></a>
        <li><a href="#idl-event-handlers"><span class="secno">5.6.5</span> <span class="content">IDL event handlers</span></a>
       </ul>
      <li><a href="#error-handling"><span class="secno">5.7</span> <span class="content">Error handling</span></a>
     </ul>
    <li>
     <a href="#uuids"><span class="secno">6</span> <span class="content">UUIDs</span></a>
     <ul class="toc">
      <li><a href="#standardized-uuids"><span class="secno">6.1</span> <span class="content">Standardized UUIDs</span></a>
     </ul>
    <li><a href="#gatt-blacklist"><span class="secno">7</span> <span class="content">The GATT Blacklist</span></a>
    <li><a href="#navigator-extensions"><span class="secno">8</span> <span class="content">Extensions to the Navigator Interface</span></a>
    <li><a href="#terminology"><span class="secno">9</span> <span class="content">Terminology and Conventions</span></a>
    <li><a href="#conformance"><span class="secno"></span> <span class="content"> Conformance</span></a>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ul class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ul>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ul class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
     </ul>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
    <li><a href="#issues-index"><span class="secno"></span> <span class="content">Issues Index</span></a>
   </ul>
  </div>
  <main>
   <section>
    <h2 class="heading settled" data-level="1" id="introduction"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#introduction"></a></h2>
    <p><em>This section is non-normative.</em></p>
    <p> <a href="https://developer.bluetooth.org/">Bluetooth</a> is
        a standard for short-range wireless communication between devices.
        Bluetooth "Classic" (<abbr title="Basic Rate">BR</abbr>/<abbr title="Enhanced Data Rate">EDR</abbr>)
        defines a set of binary protocols and supports speeds up to about 24Mbps.
        Bluetooth 4.0 introduced a new "Low Energy" mode known as "Bluetooth Smart", <abbr title="Bluetooth Low Energy">BLE</abbr>, or just <abbr title="Low Energy">LE</abbr> which is limited to about 1Mbps but
        allows devices to leave their transmitters off most of the time.
        BLE provides most of its functionality through key/value pairs provided by
        the <a data-link-type="dfn" href="#generic-attribute-profile">Generic Attribute Profile
        (<abbr title="Generic Attribute Profile">GATT</abbr>)</a>. </p>
    <p> BLE defines multiple roles that devices can play.
        The <a data-link-type="dfn" href="#broadcaster">Broadcaster</a> and <a data-link-type="dfn" href="#observer">Observer</a> roles are
        for transmitter- and receiver-only applications, respectively.
        Devices acting in the <a data-link-type="dfn" href="#peripheral">Peripheral</a> role can receive connections,
        and devices acting in the <a data-link-type="dfn" href="#central">Central</a> role can connect to <a data-link-type="dfn" href="#peripheral">Peripheral</a> devices. </p>
    <p> A device acting in either the <a data-link-type="dfn" href="#peripheral">Peripheral</a> or <a data-link-type="dfn" href="#central">Central</a> role
        can host a <a data-link-type="dfn" href="#gatt-server">GATT Server</a>,
        which exposes a hierarchy of <a data-link-type="dfn" href="#service">Service</a>s, <a data-link-type="dfn" href="#characteristic">Characteristic</a>s, and <a data-link-type="dfn" href="#descriptor">Descriptor</a>s.
        See <a href="#information-model">§5.1 GATT Information Model</a> for more details about this hierarchy.
        Despite being designed to support BLE transport,
        the GATT protocol can also run over BR/EDR transport. </p>
    <p> The first version of this specification allows web pages,
        running on a UA in the <a data-link-type="dfn" href="#central">Central</a> role, to connect to <a data-link-type="dfn" href="#gatt-server">GATT Server</a>s
        over either a BR/EDR or LE connection.
        While this specification cites the <a data-link-type="biblio" href="#biblio-bluetooth42">[BLUETOOTH42]</a> specification,
        it intends to also support communication
        among devices that only implement Bluetooth 4.0 or 4.1. </p>
    <section>
     <h3 class="heading settled" data-level="1.1" id="introduction-examples"><span class="secno">1.1. </span><span class="content">Examples</span><a class="self-link" href="#introduction-examples"></a></h3>
     <div class="example" id="example-fb23f348">
      <a class="self-link" href="#example-fb23f348"></a> 
      <p> To discover and retrieve data from a standard heart rate monitor,
            a website would use code like the following: </p>
<pre>let chosenHeartRateService = null;

navigator.bluetooth.<a data-link-type="idl" href="#dom-bluetooth-requestdevice">requestDevice</a>({
  filters: [{
    services: ['heart_rate'],
  }]
}).then(device => device.<a data-link-type="functionish" href="#dom-bluetoothdevice-connectgatt">connectGATT()</a>)
.then(server => server.<a data-link-type="idl" href="#dom-bluetoothgattremoteserver-getprimaryservice">getPrimaryService</a>(<a data-link-type="idl" href="https://developer.bluetooth.org/gatt/services/Pages/ServiceViewer.aspx?u=org.bluetooth.service.heart_rate.xml#">'heart_rate'</a>))
.then(service => {
  chosenHeartRateService = service;
  return Promise.all([
    service.<a data-link-type="idl" href="#dom-bluetoothgattservice-getcharacteristic">getCharacteristic</a>(<a data-link-type="idl" href="https://developer.bluetooth.org/gatt/characteristics/Pages/CharacteristicViewer.aspx?u=org.bluetooth.characteristic.body_sensor_location.xml#">'body_sensor_location'</a>)
      .then(handleBodySensorLocationCharacteristic),
    service.<a data-link-type="idl" href="#dom-bluetoothgattservice-getcharacteristic">getCharacteristic</a>(<a data-link-type="idl" href="https://developer.bluetooth.org/gatt/characteristics/Pages/CharacteristicViewer.aspx?u=org.bluetooth.characteristic.heart_rate_measurement.xml#">'heart_rate_measurement'</a>))
      .then(handleHeartRateMeasurementCharacteristic),
  ]);
});

function handleBodySensorLocationCharacteristic(characteristic) {
  if (characteristic === null) {
    console.log("Unknown sensor location.");
    return Promise.resolve();
  }
  return characteristic.<a data-link-type="functionish" href="#dom-bluetoothgattcharacteristic-readvalue">readValue()</a>
  .then(sensorLocationArray => {
    let sensorLocation = new Uint8Array(sensorLocationArray)[0];
    switch (sensorLocation) {
      case 0: return 'Other';
      case 1: return 'Chest';
      case 2: return 'Wrist';
      case 3: return 'Finger';
      case 4: return 'Hand';
      case 5: return 'Ear Lobe';
      case 6: return 'Foot';
      default: return 'Unknown';
    }
  }).then(location => console.log(location));
}

function handleHeartRateMeasurementCharacteristic(characteristic) {
  characteristic.addEventListener('<a class="idl-code" data-link-type="event" href="#dom-bluetoothgattcharacteristic-characteristicvaluechanged">characteristicvaluechanged</a>', onHeartRateChanged);
  return characteristic.<a data-link-type="functionish" href="#dom-bluetoothgattcharacteristic-startnotifications">startNotifications()</a>;
}

function onHeartRateChanged(event) {
  let characteristic = event.target;
  console.log(parseHeartRate(characteristic.<a class="idl-code" data-link-type="attribute" href="#dom-bluetoothgattcharacteristic-value">value</a>));
}
</pre>
      <p> <code>parseHeartRate()</code> would be defined using the <a data-link-type="idl" href="https://developer.bluetooth.org/gatt/characteristics/Pages/CharacteristicViewer.aspx?u=org.bluetooth.characteristic.heart_rate_measurement.xml#"><code>heart_rate_measurement</code> documentation</a> to read the <code class="idl"><a data-link-type="idl" href="http://ecma-international.org/ecma-262/6.0/#sec-arraybuffer-constructor">ArrayBuffer</a></code> stored
            in a <code class="idl"><a data-link-type="idl" href="#bluetoothgattcharacteristic0">BluetoothGATTCharacteristic</a></code>'s <code class="idl"><a data-link-type="idl" href="#dom-bluetoothgattcharacteristic-value">value</a></code> field. </p>
<pre class="highlight"><span class="kd">function</span> <span class="nx">parseHeartRate</span><span class="p">(</span><span class="nx">buffer</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">let</span> <span class="nx">data</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">DataView</span><span class="p">(</span><span class="nx">buffer</span><span class="p">);</span>
  <span class="kd">let</span> <span class="nx">flags</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">getUint8</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="kd">let</span> <span class="nx">rate16Bits</span> <span class="o">=</span> <span class="nx">flags</span> <span class="o">&amp;</span> <span class="mh">0x1</span><span class="p">;</span>
  <span class="kd">let</span> <span class="nx">result</span> <span class="o">=</span> <span class="p">{};</span>
  <span class="kd">let</span> <span class="nx">index</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">rate16Bits</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">result</span><span class="p">.</span><span class="nx">heartRate</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">getUint16</span><span class="p">(</span><span class="nx">index</span><span class="p">,</span> <span class="cm">/*littleEndian=*/</span><span class="kc">true</span><span class="p">);</span>
    <span class="nx">index</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">result</span><span class="p">.</span><span class="nx">heartRate</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">getUint8</span><span class="p">(</span><span class="nx">index</span><span class="p">);</span>
    <span class="nx">index</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="kd">let</span> <span class="nx">contactDetected</span> <span class="o">=</span> <span class="nx">flags</span> <span class="o">&amp;</span> <span class="mh">0x2</span><span class="p">;</span>
  <span class="kd">let</span> <span class="nx">contactSensorPresent</span> <span class="o">=</span> <span class="nx">flags</span> <span class="o">&amp;</span> <span class="mh">0x4</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">contactSensorPresent</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">result</span><span class="p">.</span><span class="nx">contactDetected</span> <span class="o">=</span> <span class="o">!!</span><span class="nx">contactDetected</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="kd">let</span> <span class="nx">energyPresent</span> <span class="o">=</span> <span class="nx">flags</span> <span class="o">&amp;</span> <span class="mh">0x8</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">energyPresent</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">result</span><span class="p">.</span><span class="nx">energyExpended</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">getUint16</span><span class="p">(</span><span class="nx">index</span><span class="p">,</span> <span class="cm">/*littleEndian=*/</span><span class="kc">true</span><span class="p">);</span>
    <span class="nx">index</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="kd">let</span> <span class="nx">rrIntervalPresent</span> <span class="o">=</span> <span class="nx">flags</span> <span class="o">&amp;</span> <span class="mh">0x10</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">rrIntervalPresent</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">rrIntervals</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">for</span> <span class="p">(;</span> <span class="nx">index</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="nx">data</span><span class="p">.</span><span class="nx">byteLength</span><span class="p">;</span> <span class="nx">index</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">rrIntervals</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">getUint16</span><span class="p">(</span><span class="nx">index</span><span class="p">,</span> <span class="cm">/*littleEndian=*/</span><span class="kc">true</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="nx">result</span><span class="p">.</span><span class="nx">rrIntervals</span> <span class="o">=</span> <span class="nx">rrIntervals</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
<span class="p">}</span></pre>
      <p> <code>onHeartRateChanged()</code> might log an object like </p>
<pre class="highlight"><span class="p">{</span>
  <span class="nx">heartRate</span><span class="o">:</span> <span class="mi">70</span><span class="p">,</span>
  <span class="nx">contactDetected</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="nx">energyExpended</span><span class="o">:</span> <span class="mi">750</span><span class="p">,</span>     <span class="c1">// Meaning 750kJ.</span>
  <span class="nx">rrIntervals</span><span class="o">:</span> <span class="p">[</span><span class="mi">890</span><span class="p">,</span> <span class="mi">870</span><span class="p">]</span>  <span class="c1">// Meaning .87s and .85s.</span>
<span class="p">}</span></pre>
      <p> If the heart rate sensor reports the <code>energyExpended</code> field,
            the web application can reset its value to <code>0</code> by writing to the <code class="idl"><a data-link-type="idl" href="https://developer.bluetooth.org/gatt/characteristics/Pages/CharacteristicViewer.aspx?u=org.bluetooth.characteristic.heart_rate_control_point.xml#">heart_rate_control_point</a></code> characteristic: </p>
<pre>function resetEnergyExpended() {
  if (!chosenHeartRateService) {
    return Promise.reject(new Error('No heart rate sensor selected yet.'));
  }
  return chosenHeartRateService.<a data-link-type="idl" href="#dom-bluetoothgattservice-getcharacteristic">getCharacteristic</a>(<a data-link-type="idl" href="https://developer.bluetooth.org/gatt/characteristics/Pages/CharacteristicViewer.aspx?u=org.bluetooth.characteristic.heart_rate_control_point.xml#">'heart_rate_control_point'</a>))
    .then(controlPoint => {
      let resetEnergyExpended = new Uint8Array([1]);
      return controlPoint.<a data-link-type="idl" href="#dom-bluetoothgattcharacteristic-writevalue">writeValue</a>(resetEnergyExpended);
    });
}
</pre>
     </div>
    </section>
   </section>
   <section>
    <h2 class="heading settled" data-level="2" id="security-and-privacy"><span class="secno">2. </span><span class="content">Security and privacy considerations</span><a class="self-link" href="#security-and-privacy"></a></h2>
    <section>
     <h3 class="heading settled" data-level="2.1" id="device-access-is-powerful"><span class="secno">2.1. </span><span class="content">Device access is powerful</span><a class="self-link" href="#device-access-is-powerful"></a></h3>
     <p> When a website requests access to devices using <code class="idl"><a data-link-type="idl" href="#dom-bluetooth-requestdevice">requestDevice()</a></code>,
          it gets the ability to access all GATT services mentioned in the call.
          The UA MUST inform the user what capabilities these services give the website
          before asking which devices to entrust to it.
          If any services in the list aren’t known to the UA,
          the UA MUST assume they give the site complete control over the device
          and inform the user of this risk.
          The UA MUST also allow the user to inspect what sites have access to what devices
          and revoke these pairings. </p>
     <p> The UA MUST NOT allow the user to pair entire classes of devices with a website.
          It is possible to construct a class of devices
          for which each individual device sends the same Bluetooth-level identifying information.
          UAs are not required to attempt to detect this sort of forgery
          and MAY let a user pair this pseudo-device with a website. </p>
     <p> To help ensure that only the entity the user approved for access actually has access,
          this specification requires that only <a data-link-type="dfn" href="https://w3c.github.io/webappsec/specs/powerfulfeatures/#secure-context">secure context</a>s
          can access Bluetooth devices
          (<a href="#requestDevice-secure-context">requestDevice</a>). </p>
    </section>
    <section>
     <h3 class="heading settled" data-level="2.2" id="attacks-on-devices"><span class="secno">2.2. </span><span class="content">Attacks on devices</span><a class="self-link" href="#attacks-on-devices"></a></h3>
     <p><em>This section is non-normative.</em></p>
     <p> Communication from websites can break the security model of some devices,
          which assume they only receive messages from
          the trusted operating system of a remote device.
          Human Interface Devices are a prominent example,
          where allowing a website to communicate would allow that site to log keystrokes.
          This specification includes a blacklist of
          such vulnerable services, characteristics, and descriptors
          to prevent websites from taking advantage of them. </p>
     <p> We expect that many devices are vulnerable to unexpected data delivered to their radio.
          In the past, these devices had to be exploited one-by-one,
          but this API makes it plausible to conduct large-scale attacks.
          This specification takes several approaches to make such attacks more difficult: </p>
     <ul>
      <li> Pairing individual devices instead of device classes
            requires at least a user action before a device can be exploited. 
      <li>
        Constraining access to <a data-link-type="dfn" href="#generic-attribute-profile">GATT</a>, as opposed to generic byte-stream access,
            denies malicious websites access to most parsers on the device. 
       <p> On the other hand,
              GATT’s <a data-link-type="dfn" href="#characteristic">Characteristic</a> and <a data-link-type="dfn" href="#descriptor">Descriptor</a> values are still byte arrays,
              which may be set to lengths and formats the device doesn’t expect.
              UAs are encouraged to validate these values when they can. </p>
      <li> This API never exposes Bluetooth addressing, data signing or encryption keys
            (<a data-link-type="dfn" href="#definition-of-keys-and-values">Definition of Keys and Values</a>) to websites.
            This makes it more difficult for a website to predict the bits that will be sent over the radio,
            which blocks <a href="https://www.usenix.org/legacy/events/woot11/tech/final_files/Goodspeed.pdf">packet-in-packet injection attacks</a>.
            Unfortunately, this only works over encrypted links,
            which not all BLE devices are required to support. 
     </ul>
     <p> UAs can also take further steps to protect their users: </p>
     <ul>
      <li> A web service may collect lists of malicious websites and vulnerable devices.
            UAs can deny malicious websites access to any device
            and any website access to vulnerable devices. 
     </ul>
    </section>
    <section>
     <h3 class="heading settled" data-level="2.3" id="bluetooth-device-identifiers"><span class="secno">2.3. </span><span class="content">Bluetooth device identifiers</span><a class="self-link" href="#bluetooth-device-identifiers"></a></h3>
     <p><em>This section is non-normative.</em></p>
     <p> Each Bluetooth BR/EDR device has a unique 48-bit MAC address
          known as the <a data-link-type="dfn" href="#bd_addr">BD_ADDR</a>.
          Each Bluetooth LE device has at least one of a <a data-link-type="dfn" href="#public-device-address">Public Device Address</a> and a <a data-link-type="dfn" href="#static-device-address">Static Device Address</a>.
          The <a data-link-type="dfn" href="#public-device-address">Public Device Address</a> is a MAC address.
          The <a data-link-type="dfn" href="#static-device-address">Static Device Address</a> may be regenerated on each restart.
          A BR/EDR/LE device will use the same value
          for the <a data-link-type="dfn" href="#bd_addr">BD_ADDR</a> and the <a data-link-type="dfn" href="#public-device-address">Public Device Address</a> (specified in the <a data-link-type="dfn" href="#read-bd_addr-command">Read BD_ADDR Command</a>). </p>
     <p> An LE device may also have a unique, 128-bit <a data-link-type="dfn" href="#identity-resolving-key">Identity Resolving Key</a>,
          which is sent to trusted devices during the bonding process.
          To avoid leaking a persistent identifier, an LE device may scan and advertise using
          a random Resolvable or Non-Resolvable <a data-link-type="dfn" href="#private-address">Private Address</a> instead of its Static or Public Address.
          These are regenerated periodically (approximately every 15 minutes),
          but a bonded device can check whether one of its stored <a data-link-type="dfn" href="#identity-resolving-key">IRK</a>s matches
          any given Resolvable Private Address
          using the <a data-link-type="dfn" href="#resolvable-private-address-resolution-procedure">Resolvable Private Address Resolution Procedure</a>. </p>
     <p> Each Bluetooth device also has a human-readable <a data-link-type="dfn" href="#bluetooth-device-name">Bluetooth Device Name</a>.
          These aren’t guaranteed to be unique, but may well be, depending on the device type. </p>
     <section>
      <h4 class="heading settled" data-level="2.3.1" id="remote-device-identifiers"><span class="secno">2.3.1. </span><span class="content">Identifiers for remote Bluetooth devices</span><a class="self-link" href="#remote-device-identifiers"></a></h4>
      <p><em>This section is non-normative.</em></p>
      <p> If a website can retrieve any of the persistent device IDs,
            these can be used, in combination with a large effort to catalog ambient devices,
            to discover a user’s location.
            A device ID can also be used to identify that a user who
            pairs two different websites with the same Bluetooth device
            is a single user.
            On the other hand, many GATT services are available
            that could be used to fingerprint a device,
            and a device can easily expose a custom GATT service to make this easier. </p>
      <p> This specification <a data-link-type="dfn" href="#add-an-allowed-bluetooth-device">generates a new device ID</a> for each origin for a given device,
            which makes it difficult for websites to abuse the device address like this.
            Device makers can still design their devices to help track users,
            but it takes work. </p>
     </section>
     <section>
      <h4 class="heading settled" data-level="2.3.2" id="ua-bluetooth-address"><span class="secno">2.3.2. </span><span class="content">The UA’s Bluetooth address</span><a class="self-link" href="#ua-bluetooth-address"></a></h4>
      <p><em>This section is non-normative.</em></p>
      <p> In BR/EDR mode, or in LE mode during active scanning without the <a data-link-type="dfn" href="#privacy-feature">Privacy Feature</a>,
            the UA broadcasts its persistent ID to any nearby Bluetooth radio.
            This makes it easy to scatter hostile devices in an area and track the UA.
            As of 2014-08, few or no platforms document that they implement the <a data-link-type="dfn" href="#privacy-feature">Privacy Feature</a>,
            so despite this spec recommending it, few UAs are likely to use it.
            This spec does <a href="#requestDevice-user-gesture">require a user gesture</a> for a website to trigger a scan, which reduces the frequency of scans some,
            but it would still be better for more platforms to expose the <a data-link-type="dfn" href="#privacy-feature">Privacy Feature</a>. </p>
     </section>
    </section>
   </section>
   <section>
    <h2 class="heading settled" data-level="3" id="device-discovery"><span class="secno">3. </span><span class="content">Device Discovery</span><a class="self-link" href="#device-discovery"></a></h2>
<pre class="idl">dictionary <dfn class="idl-code" data-dfn-type="dictionary" data-export="" id="dictdef-bluetoothscanfilter">BluetoothScanFilter<a class="self-link" href="#dictdef-bluetoothscanfilter"></a></dfn> {
  sequence&lt;<a data-link-type="idl-name" href="#typedefdef-bluetoothserviceuuid">BluetoothServiceUUID</a>> <a class="idl-code" data-link-type="dict-member" data-type="sequence<BluetoothServiceUUID> " href="#dom-bluetoothscanfilter-services">services</a>;
};

dictionary <dfn class="idl-code" data-dfn-type="dictionary" data-export="" id="dictdef-requestdeviceoptions">RequestDeviceOptions<a class="self-link" href="#dictdef-requestdeviceoptions"></a></dfn> {
  required sequence&lt;<a data-link-type="idl-name" href="#dictdef-bluetoothscanfilter">BluetoothScanFilter</a>> <a class="idl-code" data-link-type="dict-member" data-type="sequence<BluetoothScanFilter> " href="#dom-requestdeviceoptions-filters">filters</a>;
  sequence&lt;<a data-link-type="idl-name" href="#typedefdef-bluetoothserviceuuid">BluetoothServiceUUID</a>> <a class="idl-code" data-default="None" data-link-type="dict-member" data-type="sequence<BluetoothServiceUUID> " href="#dom-requestdeviceoptions-optionalservices">optionalServices</a> = [];
};

interface <dfn class="idl-code" data-dfn-type="interface" data-export="" id="bluetooth">Bluetooth<a class="self-link" href="#bluetooth"></a></dfn> {
  Promise&lt;<a data-link-type="idl-name" href="#bluetoothdevice0">BluetoothDevice</a>> <a class="idl-code" data-link-type="method" href="#dom-bluetooth-requestdevice">requestDevice</a>(<a data-link-type="idl-name" href="#dictdef-requestdeviceoptions">RequestDeviceOptions</a> <dfn class="idl-code" data-dfn-for="Bluetooth/requestDevice(options)" data-dfn-type="argument" data-export="" id="dom-bluetooth-requestdevice-options-options">options<a class="self-link" href="#dom-bluetooth-requestdevice-options-options"></a></dfn>);
};
<a data-link-type="idl-name" href="#bluetooth">Bluetooth</a> implements <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#eventtarget">EventTarget</a>;
<a data-link-type="idl-name" href="#bluetooth">Bluetooth</a> implements <a data-link-type="idl-name" href="#characteristiceventhandlers">CharacteristicEventHandlers</a>;
<a data-link-type="idl-name" href="#bluetooth">Bluetooth</a> implements <a data-link-type="idl-name" href="#serviceeventhandlers">ServiceEventHandlers</a>;
</pre>
    <div class="note no-marker" role="note">
     <div class="marker">NOTE: Bluetooth members</div>
     <p> <code class="idl"><a data-link-type="idl" href="#dom-bluetooth-requestdevice">requestDevice(options)</a></code> asks the user
          to grant this origin access to a device
          that <a data-link-type="dfn" href="#matches-a-filter">matches a filter</a> in <code>options.<dfn class="idl-code" data-dfn-for="RequestDeviceOptions" data-dfn-type="dict-member" data-export="" id="dom-requestdeviceoptions-filters">filters<a class="self-link" href="#dom-requestdeviceoptions-filters"></a></dfn></code>.
          The user will be shown devices that support <em>all</em> the GATT service UUIDs in the <dfn class="idl-code" data-dfn-for="BluetoothScanFilter" data-dfn-type="dict-member" data-export="" id="dom-bluetoothscanfilter-services">services<a class="self-link" href="#dom-bluetoothscanfilter-services"></a></dfn> list
          of <em>any</em> <code class="idl"><a data-link-type="idl" href="#dictdef-bluetoothscanfilter">BluetoothScanFilter</a></code> in <code>filters</code>. </p>
     <p> After the user selects a device to pair with this origin,
          the origin is allowed to access to any service whose UUID was listed
          in the <code class="idl"><a data-link-type="idl" href="#dom-bluetoothscanfilter-services">services</a></code> list
          in any element of <code>options.filters</code> or in <code>options.<dfn class="idl-code" data-dfn-for="RequestDeviceOptions" data-dfn-type="dict-member" data-export="" id="dom-requestdeviceoptions-optionalservices">optionalServices<a class="self-link" href="#dom-requestdeviceoptions-optionalservices"></a></dfn></code>. </p>
    </div>
    <div class="example" id="example-6fcdbc9c">
     <a class="self-link" href="#example-6fcdbc9c"></a> 
     <p> Say the UA is close to the following devices: </p>
     <table>
      <tbody>
       <tr>
        <th>Device
        <th>Advertised Services
       <tr>
        <td>D1
        <td>A, B, C, D
       <tr>
        <td>D2
        <td>A, B, E
       <tr>
        <td>D3
        <td>C, D
       <tr>
        <td>D4
        <td>E
     </table>
     <p> If the website calls </p>
<pre class="highlight"><span class="nx">navigator</span><span class="p">.</span><span class="nx">bluetooth</span><span class="p">.</span><span class="nx">requestDevice</span><span class="p">({</span>
  <span class="nx">filters</span><span class="o">:</span> <span class="p">[</span> <span class="p">{</span><span class="nx">services</span><span class="o">:</span> <span class="p">[</span><span class="nx">A</span><span class="p">,</span> <span class="nx">B</span><span class="p">]}</span> <span class="p">]</span>
<span class="p">});</span></pre>
     <p> the user will be shown a dialog containing devices D1 and D2.
          If the user selects D1, the website will not be able to access services C or D.
          If the user selects D2, the website will not be able to access service E. </p>
     <p> On the other hand, if the website calls </p>
<pre class="highlight"><span class="nx">navigator</span><span class="p">.</span><span class="nx">bluetooth</span><span class="p">.</span><span class="nx">requestDevice</span><span class="p">({</span>
  <span class="nx">filters</span><span class="o">:</span> <span class="p">[</span>
    <span class="p">{</span><span class="nx">services</span><span class="o">:</span> <span class="p">[</span><span class="nx">A</span><span class="p">,</span> <span class="nx">B</span><span class="p">]},</span>
    <span class="p">{</span><span class="nx">services</span><span class="o">:</span> <span class="p">[</span><span class="nx">C</span><span class="p">,</span> <span class="nx">D</span><span class="p">]}</span>
  <span class="p">]</span>
<span class="p">});</span></pre>
     <p> the dialog will contain devices D1, D2, and D3,
          and if the user selects D1,
          the website will be able to access services A, B, C, and D. </p>
     <p> The <code>optionalServices</code> list doesn’t add any devices
          to the dialog the user sees,
          but it does affect which services the website can use from the device the user picks. </p>
<pre class="highlight"><span class="nx">navigator</span><span class="p">.</span><span class="nx">bluetooth</span><span class="p">.</span><span class="nx">requestDevice</span><span class="p">({</span>
  <span class="nx">filters</span><span class="o">:</span> <span class="p">[</span> <span class="p">{</span><span class="nx">services</span><span class="o">:</span> <span class="p">[</span><span class="nx">A</span><span class="p">,</span> <span class="nx">B</span><span class="p">]}</span> <span class="p">],</span>
  <span class="nx">optionalServices</span><span class="o">:</span> <span class="p">[</span><span class="nx">E</span><span class="p">]</span>
<span class="p">});</span></pre>
     <p> Shows a dialog containing D1 and D2,
          but not D4, since D4 doesn’t contain the required services.
          If the user selects D2, unlike in the first example,
          the website will be able to access services A, B, and E. </p>
     <p> The allowed services also apply if the device changes after the user grants access.
          For example, if the user selects D1 in the previous <code>requestDevice()</code> call,
          and D1 later adds a new E service,
          that will fire the <code class="idl"><a data-link-type="idl" href="#dom-bluetoothgattservice-serviceadded">serviceadded</a></code> event,
          and the web page will be able to access service E. </p>
    </div>
    <p> A device <dfn data-dfn-type="dfn" data-local-lt="match a filter" data-noexport="" id="matches-a-filter">matches a filter<a class="self-link" href="#matches-a-filter"></a></dfn> <var>filter</var> if
        the UA has received advertising data, an <a data-link-type="dfn" href="#extended-inquiry-response">extended inquiry response</a>,
        or a service discovery response indicating that
        the device supports each of the <a data-link-type="dfn" href="#service">Service</a> UUIDs
        included in <code><var>filter</var>.services</code> as a primary (vs included) service. </p>
    <p class="note" role="note"> The list of Service UUIDs that a device advertises
        might not include all the UUIDs the device supports.
        The advertising data does specify whether this list is complete.
        If a website filters for a UUID that a nearby device supports but doesn’t advertise,
        that device might not be included in the list of devices presented to the user.
        The UA would need to connect to the device to discover the full list of supported services,
        which can impair radio performance and cause delays, so this spec doesn’t require it. </p>
    <p> The <code><dfn class="idl-code" data-dfn-for="Bluetooth" data-dfn-type="method" data-export="" id="dom-bluetooth-requestdevice">requestDevice(<var>options</var>)<a class="self-link" href="#dom-bluetooth-requestdevice"></a></dfn></code> method,
        when invoked, MUST return <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#a-new-promise">a new promise</a> <var>promise</var> and run the following steps <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">in parallel</a>: </p>
    <ol>
     <li id="requestDevice-secure-context"><a class="self-link" href="#requestDevice-secure-context"></a> If the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#incumbent-settings-object">incumbent settings object</a> is not a <a data-link-type="dfn" href="https://w3c.github.io/webappsec/specs/powerfulfeatures/#secure-context">secure context</a>, <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#reject-promise">reject</a> <var>promise</var> with a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#securityerror">SecurityError</a></code> and abort these steps. 
     <li id="requestDevice-user-gesture"><a class="self-link" href="#requestDevice-user-gesture"></a> If the algorithm is not <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#allowed-to-show-a-popup">allowed to show a popup</a>, <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#reject-promise">reject</a> <var>promise</var> with a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#securityerror">SecurityError</a></code> and abort these steps. 
     <li>
       In order to convert the arguments from service names and aliases to just <a data-link-type="dfn" href="#uuid">UUID</a>s,
          do the following substeps: 
      <ol>
       <li> Let <var>uuidFilters</var> be a new <code class="idl"><a data-link-type="idl" href="http://ecma-international.org/ecma-262/6.0/#sec-array-objects">Array</a></code> and <var>requiredServiceUUIDs</var> be a new <code class="idl"><a data-link-type="idl" href="http://ecma-international.org/ecma-262/6.0/#sec-set-objects">Set</a></code>. 
       <li>
         For each <var>filter</var> in <code><var>options</var>.filters</code>,
              do the following steps: 
        <ol>
         <li> If <code><var>filter</var>.services.length === 0</code>, <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#reject-promise">reject</a> <var>promise</var> with a <code class="idl"><a data-link-type="idl" href="http://ecma-international.org/ecma-262/6.0/#sec-native-error-types-used-in-this-standard-typeerror">TypeError</a></code> and abort these steps. 
         <li> Let <var>services</var> be <code><code class="idl"><a data-link-type="idl" href="http://ecma-international.org/ecma-262/6.0/#sec-array.prototype.map">Array.prototype.map</a></code>.call(<var>filter</var>.services, <code class="idl"><a data-link-type="idl" href="#dom-bluetoothuuid-getservice">BluetoothUUID.getService</a></code>)</code>. 
         <li> If any of the <code class="idl"><a data-link-type="idl" href="#dom-bluetoothuuid-getservice">BluetoothUUID.getService()</a></code> calls threw an exception, <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#reject-promise">reject</a> <var>promise</var> with that exception and abort these steps. 
         <li> If any <var>service</var> in <var>services</var> is <a data-link-type="dfn" href="#blacklisted">blacklisted</a>, <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#reject-promise">reject</a> <var>promise</var> with a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#securityerror">SecurityError</a></code> and abort these steps. 
         <li>Append <code>{services: <var>services</var>}</code> to <var>uuidFilters</var>.
         <li>Add the elements of <var>services</var> to <var>requiredServiceUUIDs</var>.
        </ol>
       <li> Let <var>optionalServiceUUIDs</var> be <code><code class="idl"><a data-link-type="idl" href="http://ecma-international.org/ecma-262/6.0/#sec-array.prototype.map">Array.prototype.map</a></code>.call(<var>options</var>.optionalServices, <code class="idl"><a data-link-type="idl" href="#dom-bluetoothuuid-getservice">BluetoothUUID.getService</a></code>)</code>. 
       <li> If any of the <code class="idl"><a data-link-type="idl" href="#dom-bluetoothuuid-getservice">BluetoothUUID.getService()</a></code> calls threw an exception, <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#reject-promise">reject</a> <var>promise</var> with that exception and abort these steps. 
       <li> Remove from <var>optionalServiceUUIDs</var> any UUIDs that are <a data-link-type="dfn" href="#blacklisted">blacklisted</a>. 
      </ol>
     <li> <a data-link-type="dfn" href="#scan-for-devices">Scan for devices</a> with <var>requiredServiceUUIDs</var> as the <var>set of <a data-link-type="dfn" href="#service">Service</a> UUIDs</var>,
          and let <var>scanResult</var> be the result. 
     <li> Remove devices from <var>scanResult</var> if
          they do not <a data-link-type="dfn" href="#matches-a-filter">match a filter</a> in <var>uuidFilters</var>. 
     <li>
       Even if <var>scanResult</var> is empty,
          display a prompt to the user requesting that the user select a device from it.
          The UA SHOULD show the user the human-readable name of each device.
          If this name is not available because the UA’s Bluetooth system doesn’t support privacy-enabled scans,
          the UA SHOULD allow the user to indicate interest and then perform a privacy-disabled scan to retrieve the name. 
      <p> The UA MAY allow the user to select a nearby device
            that does not match <var>uuidFilters</var>. </p>
     <li> Wait for the user to have selected a <var>device</var> or cancelled the prompt. 
     <li> If the user cancels the prompt, <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#reject-promise">reject</a> <var>promise</var> with a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#notfounderror">NotFoundError</a></code> and abort these steps. 
     <li> <a data-link-type="dfn" href="#add-an-allowed-bluetooth-device">Add <var>device</var> to the origin’s allowed devices map.</a> with the union of <var>requiredServiceUUIDs</var> and <var>optionalServiceUUIDs</var> as <var>allowed services</var>. 
     <li> <a data-link-type="dfn" href="#get-the-bluetoothdevice-representing">Get the <code>BluetoothDevice</code> representing</a> <var>device</var> and <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#resolve-promise">resolve</a> <var>promise</var> with the result. 
    </ol>
    <p> To <dfn data-dfn-type="dfn" data-noexport="" id="scan-for-devices">scan for devices<a class="self-link" href="#scan-for-devices"></a></dfn> with
        an optional <var>set of <a data-link-type="dfn" href="#service">Service</a> UUIDs</var>, defaulting to the set of all UUIDs,
        the UA MUST perform the following steps: </p>
    <ol>
     <li> If the UA has scanned for devices recently <span class="issue" id="issue-2f91a41d"><a class="self-link" href="#issue-2f91a41d"></a>TODO: Nail down the amount of time.</span> with a set of UUIDs that was a superset of the UUIDs for the current scan,
          then the UA MAY return the result of that scan and abort these steps. 
     <li>Let <var>nearbyDevices</var> be a set of <a data-link-type="dfn" href="#bluetooth-device">Bluetooth device</a>s, initially empty.
     <li>
       If the UA supports the LE transport, perform the <a data-link-type="dfn" href="#general-discovery-procedure">General Discovery Procedure</a> and add the discovered <a data-link-type="dfn" href="#bluetooth-device">Bluetooth device</a>s to <var>nearbyDevices</var>.
          The UA SHOULD enable the <a data-link-type="dfn" href="#privacy-feature">Privacy Feature</a>. 
      <p class="issue" id="issue-fcedc6f5"><a class="self-link" href="#issue-fcedc6f5"></a> Both <a data-link-type="dfn" href="#passive-scanning">passive scanning</a> and
            the <a data-link-type="dfn" href="#privacy-feature">Privacy Feature</a> avoid leaking the unique, immutable device ID.
            We ought to require UAs to use either one,
            but none of the OS APIs appear to expose either.
            Bluetooth also makes it hard to use <a data-link-type="dfn" href="#passive-scanning">passive scanning</a> since
            it doesn’t require <a data-link-type="dfn" href="#central">Central</a> devices to support the <a data-link-type="dfn" href="#observation-procedure">Observation Procedure</a>. </p>
     <li>
       If the UA supports the BR/EDR transport, perform the <a data-link-type="dfn" href="#device-discovery-procedure">Device Discovery Procedure</a> and add the discovered <a data-link-type="dfn" href="#bluetooth-device">Bluetooth device</a>s to <var>nearbyDevices</var>. 
      <p class="issue" id="issue-549b652c"><a class="self-link" href="#issue-549b652c"></a> All forms of BR/EDR inquiry/discovery
            appear to leak the unique, immutable device address. </p>
     <li>Let <var>result</var> be a set of <a data-link-type="dfn" href="#bluetooth-device">Bluetooth device</a>s, initially empty.
     <li>
       For each <a data-link-type="dfn" href="#bluetooth-device">Bluetooth device</a> <var>device</var> in <var>nearbyDevices</var>,
          do the following substeps: 
      <ol>
       <li> If <var>device</var>’s <a data-link-type="dfn" href="#supported-physical-transports">supported physical transports</a> include LE and
              its <a data-link-type="dfn" href="#bluetooth-device-name">Bluetooth Device Name</a> is partial or absent,
              the UA SHOULD perform the <a data-link-type="dfn" href="#name-discovery-procedure">Name Discovery Procedure</a> to acquire a complete name. 
       <li>
         If <var>device</var>’s advertised <a data-link-type="dfn" href="#service-uuid-data-type">Service UUIDs</a> have a non-empty intersection with the <var>set of <a data-link-type="dfn" href="#service">Service</a> UUIDs</var>,
              add <var>device</var> to <var>result</var> and abort these substeps. 
        <p class="note" role="note"> For BR/EDR devices, there is no way to distinguish GATT from non-GATT services
                in the <a data-link-type="dfn" href="#extended-inquiry-response">Extended Inquiry Response</a>.
                If a site filters to the UUID of a non-GATT service,
                the user may be able to select a device
                for the result of <code>requestDevice</code> that this API provides no way to interact with. </p>
       <li>
         The UA MAY connect to <var>device</var> and <a data-link-type="dfn" href="#populate-the-bluetooth-cache">populate the Bluetooth cache</a> with all Services whose UUIDs are in the <var>set of <a data-link-type="dfn" href="#service">Service</a> UUIDs</var>.
              If <var>device</var>’s <a data-link-type="dfn" href="#supported-physical-transports">supported physical transports</a> include BR/EDR,
              then in addition to the standard GATT procedures,
              the UA MAY use the Service Discovery Protocol (<a data-link-type="dfn" href="#searching-for-services">Searching for Services</a>)
              when populating the cache. 
        <div class="note" id="note-extra-discovery" role="note">
         <a class="self-link" href="#note-extra-discovery"></a> 
         <p> Connecting to every nearby device to discover services costs power and
                  can slow down other use of the Bluetooth radio.
                  UAs should only discover extra services on a device if
                  they have some reason to expect that device to be interesting. </p>
         <p> UAs should also help developers avoid relying on this extra discovery behavior.
                  For example, say a developer has previously connected to a device,
                  so the UA knows the device’s full set of supported services.
                  If this developer then filters using a non-advertised UUID,
                  the dialog they see may include this device,
                  even if the filter would likely exclude the device on users' machines.
                  The UA could provide a developer option to warn when this happens or
                  to include only advertised services in matching filters. </p>
        </div>
       <li> If the <a data-link-type="dfn" href="#bluetooth-cache0">Bluetooth cache</a> contains
              known-present Services inside <var>device</var> with UUIDs in the <var>set of <a data-link-type="dfn" href="#service">Service</a> UUIDs</var>,
              the UA MAY add <var>device</var> to <var>result</var>. 
      </ol>
     <li>Return <var>result</var> from the scan.
    </ol>
    <p class="issue" id="issue-3bfaaba4"><a class="self-link" href="#issue-3bfaaba4"></a> We need a way for a site to register to receive an event
        when an interesting device comes within range. </p>
   </section>
   <section>
    <h2 class="heading settled" data-level="4" id="device-representation"><span class="secno">4. </span><span class="content">Device Representation</span><a class="self-link" href="#device-representation"></a></h2>
    <p> The UA needs to track Bluetooth device properties at several levels:
        globally, per origin, and per <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#script-execution-environment">script execution environment</a>. </p>
    <section>
     <h3 class="heading settled" data-level="4.1" id="global-device-properties"><span class="secno">4.1. </span><span class="content">Global Bluetooth device properties</span><a class="self-link" href="#global-device-properties"></a></h3>
     <p> The physical Bluetooth device may be guaranteed to have
          some properties that the UA may not have received.
          Those properties are described as optional here. </p>
     <p> A <dfn data-dfn-type="dfn" data-noexport="" id="bluetooth-device">Bluetooth device<a class="self-link" href="#bluetooth-device"></a></dfn> has the following properties.
          Optional properties are not present, and sequence and map properties are empty,
          unless/until described otherwise.
          Other properties have a default specified or are specified when a device is introduced. </p>
     <ul>
      <li> A set of <dfn data-dfn-type="dfn" data-noexport="" id="supported-physical-transports">supported physical transports<a class="self-link" href="#supported-physical-transports"></a></dfn>,
            including one or both of BR/EDR and LE.
            This set will generally be filled based on
            the transports over which the device was discovered
            and the <a data-link-type="dfn" href="#flags-data-type">Flags Data Type</a> in the <a data-link-type="dfn" href="#advertising-data">Advertising Data</a> or <a data-link-type="dfn" href="#extended-inquiry-response">Extended Inquiry Response</a>. 
      <li> One or more of several kinds of 48-bit address:
            a <a data-link-type="dfn" href="#public-bluetooth-address">Public Bluetooth Address</a>, a (random) <a data-link-type="dfn" href="#static-address">Static Address</a>,
            and a resolvable or non-resolvable <a data-link-type="dfn" href="#private-address">Private Address</a>. 
      <li>An optional 128-bit <a data-link-type="dfn" href="#identity-resolving-key">Identity Resolving Key</a>.
      <li> An optional partial or complete <a data-link-type="dfn" href="#bluetooth-device-name">Bluetooth Device Name</a>.
            A device has a partial name when the <a data-link-type="dfn" href="https://www.bluetooth.org/en-us/specification/assigned-numbers/generic-access-profile#">Shortened Local Name</a> AD data was received,
            but the full name hasn’t been read yet. 
      <li> An <a data-link-type="dfn" href="#att-bearer">ATT Bearer</a>, over which all GATT communication happens.
            The <a data-link-type="dfn" href="#att-bearer">ATT Bearer</a> is created by procedures described in
            "Connection Establishment" under <a data-link-type="dfn" href="#gap-interoperability-requirements">GAP Interoperability Requirements</a>.
            It is disconnected in ways <a data-link-type="biblio" href="#biblio-bluetooth42">[BLUETOOTH42]</a> isn’t entirely clear about. 
      <li>
        A <dfn data-dfn-type="dfn" data-noexport="" id="bonded-flag">bonded flag<a class="self-link" href="#bonded-flag"></a></dfn>, indicating whether the Bluetooth device is bonded to the UA.
            Devices bond using the <a data-link-type="dfn" href="#bonding-procedure">Bonding Procedure</a>. 
       <p class="note" role="note"> The Bluetooth standard uses "pairing" to refer to
              creating and exchanging a shared secret,
              and "bonding" to refer to storing that secret for use in subsequent connections.
              Platform APIs don’t give independent control of the two processes,
              and they present the combined process to users under the label "pairing",
              so this specification uses "pairing" and "bonding" interchangeably
              to refer to Bluetooth bonding. </p>
      <li>
        The following optional elements
            from <a data-link-type="dfn" href="#advertising-data">Advertising Data</a> or the <a data-link-type="dfn" href="#extended-inquiry-response">Extended Inquiry Response</a>: 
       <ul>
        <li>A list of advertised <a data-link-type="dfn" href="#service-uuid-data-type">Service UUIDs</a>.
        <li> <a data-link-type="dfn" href="#manufacturer-specific-data">Manufacturer Specific Data</a>,
                consisting of a map from 16-bit Company Identifier Codes to byte arrays.
                This is treated as an empty map if it’s not present. 
        <li>A <a data-link-type="dfn" href="#tx-power-level">TX Power Level</a>, from -127dBm to 127dBm.
        <li> <a data-link-type="dfn" href="#service-data">Service Data</a>, consisting of a map from UUIDs to byte arrays.
                This is treated as an empty map if it’s not present. 
        <li> An <a data-link-type="dfn" href="#appearance">Appearance</a>, one of the values defined by
                the <code class="idl"><a data-link-type="idl" href="https://developer.bluetooth.org/gatt/characteristics/Pages/CharacteristicViewer.aspx?u=org.bluetooth.characteristic.gap.appearance.xml#">org.bluetooth.characteristic.gap.appearance</a></code> characteristic. 
        <li> A <a data-link-type="dfn" href="#rssi">Received Signal Strength Indication</a> (RSSI), from -127dBm to 20dBm.
                This is received from the local Bluetooth adapter
                rather than being sent by the remote device. 
       </ul>
      <li> An optional <a data-link-type="dfn" href="#class-of-device">Class of Device</a>,
            one of the values defined in <a data-link-type="biblio" href="#biblio-bluetooth-assigned-baseband">[BLUETOOTH-ASSIGNED-BASEBAND]</a>.
            The Class of Device is only used over the BR/EDR physical transport, not LE. 
      <li> A hierarchy of GATT attributes, described in <a href="#information-model">§5.1 GATT Information Model</a>. 
     </ul>
     <p> The UA SHOULD determine that
          two <a data-link-type="dfn" href="#bluetooth-device">Bluetooth device</a>s are the <dfn data-dfn-type="dfn" data-noexport="" id="same-device">same device<a class="self-link" href="#same-device"></a></dfn> if and only if
          they have the same <a data-link-type="dfn" href="#public-bluetooth-address">Public Bluetooth Address</a>, <a data-link-type="dfn" href="#static-address">Static Address</a>, <a data-link-type="dfn" href="#private-address">Private Address</a>, or <a data-link-type="dfn" href="#identity-resolving-key">Identity Resolving Key</a>,
          or if the <a data-link-type="dfn" href="#resolvable-private-address-resolution-procedure">Resolvable Private Address Resolution Procedure</a> succeeds using
          one device’s IRK and the other’s Resolvable <a data-link-type="dfn" href="#private-address">Private Address</a>.
          However, because platform APIs don’t document how they determine device identity,
          the UA MAY use another procedure. </p>
    </section>
    <section>
     <h3 class="heading settled" data-level="4.2" id="per-origin-device-properties"><span class="secno">4.2. </span><span class="content">Per-origin Bluetooth device properties</span><a class="self-link" href="#per-origin-device-properties"></a></h3>
     <p> For each origin, the UA MUST maintain an <dfn data-dfn-type="dfn" data-noexport="" id="allowed-devices-map">allowed devices map<a class="self-link" href="#allowed-devices-map"></a></dfn>,
          whose keys are the <a data-link-type="dfn" href="#bluetooth-device">Bluetooth device</a>s the origin is allowed to access,
          and whose values are pairs of a <code>DOMString</code> <dfn data-dfn-type="dfn" data-noexport="" id="device-id">device id<a class="self-link" href="#device-id"></a></dfn> and
          an <dfn data-dfn-type="dfn" data-noexport="" id="allowed-services-list">allowed services list<a class="self-link" href="#allowed-services-list"></a></dfn> consisting of UUIDs
          for GATT Primary <a data-link-type="dfn" href="#service">Service</a>s the origin is allowed to access on the device. </p>
     <p> The UA MAY remove devices from the <a data-link-type="dfn" href="#allowed-devices-map">allowed devices map</a> at any time
          based on signals from the user. <span class="issue" id="issue-32ef5736"><a class="self-link" href="#issue-32ef5736"></a> This needs a definition involving
            removing <code class="idl"><a data-link-type="idl" href="#bluetoothdevice0">BluetoothDevice</a></code> instances from <a data-link-type="dfn" href="#device-instance-map">device instance map</a>s
            and clearing out their [[representedDevice]] fields. </span> For example, if the user chooses not to remember access,
          the UA might remove a device when the tab that was granted access to it is closed.
          Or the UA might provide a revocation UI that allows the user
          to explicitly remove a device even while a tab is actively using that device.
          If a device is removed from this list while
          a <code class="idl"><a data-link-type="idl" href="http://ecma-international.org/ecma-262/6.0/#sec-promise-objects">Promise</a></code> is pending to do something with the device,
          it MUST be treated the same as if the device moved out of Bluetooth range. </p>
     <p> To <dfn data-dfn-type="dfn" data-noexport="" id="add-an-allowed-bluetooth-device">add an allowed <a data-link-type="dfn" href="#bluetooth-device">Bluetooth device</a><a class="self-link" href="#add-an-allowed-bluetooth-device"></a></dfn> <var>device</var> to an origin’s <a data-link-type="dfn" href="#allowed-devices-map">allowed devices map</a> with an optional <var>allowed services</var> list of <a data-link-type="dfn" href="#uuid">UUID</a>s,
          the UA MUST run the following steps. </p>
     <ol>
      <li> If <var>device</var> is the <a data-link-type="dfn" href="#same-device">same device</a> as
            an existing key in the <a data-link-type="dfn" href="#allowed-devices-map">allowed devices map</a>,
            abort these steps. 
      <li> Let <var>id</var> be a new <code>DOMString</code> that
            isn’t equal to any of the <a data-link-type="dfn" href="#device-id">device id</a>s in the origin’s <a data-link-type="dfn" href="#allowed-devices-map">allowed devices map</a> and isn’t equal to or derived from any of <var>device</var>’s <a data-link-type="dfn" href="#public-bluetooth-address">Public Bluetooth Address</a>, <a data-link-type="dfn" href="#static-address">Static Address</a>,
            or <a data-link-type="dfn" href="#identity-resolving-key">Identity Resolving Key</a>. <var>id</var> MUST, with very high probability,
            be unequal to the <a data-link-type="dfn" href="#device-id">device id</a>s used for keys
            in any other origin’s <a data-link-type="dfn" href="#allowed-devices-map">allowed devices map</a> or previously in this origin’s <a data-link-type="dfn" href="#allowed-devices-map">allowed devices map</a> that are the <a data-link-type="dfn" href="#same-device">same device</a> as <var>device</var>. 
      <li> If <var>allowed services</var> wasn’t provided, set it to an empty list. 
      <li> Add a mapping from <var>device</var> to a pair of <var>id</var> and <var>allowed services</var> in the <a data-link-type="dfn" href="#allowed-devices-map">allowed devices map</a>. 
     </ol>
    </section>
    <section>
     <h3 class="heading settled" data-level="4.3" id="bluetoothdevice"><span class="secno">4.3. </span><span class="content"><dfn class="idl-code" data-dfn-type="interface" data-export="" id="bluetoothdevice0">BluetoothDevice<a class="self-link" href="#bluetoothdevice0"></a></dfn></span><a class="self-link" href="#bluetoothdevice"></a></h3>
     <p> A <code class="idl"><a data-link-type="idl" href="#bluetoothdevice0">BluetoothDevice</a></code> instance represents a <a data-link-type="dfn" href="#bluetooth-device">Bluetooth device</a> inside a particular <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#script-execution-environment">script execution environment</a>. </p>
<pre class="idl">// Allocation authorities for Vendor IDs:
enum <dfn class="idl-code" data-dfn-type="enum" data-export="" id="enumdef-vendoridsource">VendorIDSource<a class="self-link" href="#enumdef-vendoridsource"></a></dfn> {
  "bluetooth",
  "usb"
};

interface <a class="idl-code" data-link-type="interface" href="#bluetoothdevice0">BluetoothDevice</a> {
  readonly attribute DOMString <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="DOMString " href="#dom-bluetoothdevice-id">id</a>;
  readonly attribute DOMString? <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="DOMString? " href="#dom-bluetoothdevice-name">name</a>;
  readonly attribute <a data-link-type="idl-name" href="#bluetoothadvertisingdata0">BluetoothAdvertisingData</a> <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="BluetoothAdvertisingData " href="#dom-bluetoothdevice-addata">adData</a>;
  readonly attribute unsigned long? <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="unsigned long? " href="#dom-bluetoothdevice-deviceclass">deviceClass</a>;
  readonly attribute <a data-link-type="idl-name" href="#enumdef-vendoridsource">VendorIDSource</a>? <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="VendorIDSource? " href="#dom-bluetoothdevice-vendoridsource">vendorIDSource</a>;
  readonly attribute unsigned long? <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="unsigned long? " href="#dom-bluetoothdevice-vendorid">vendorID</a>;
  readonly attribute unsigned long? <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="unsigned long? " href="#dom-bluetoothdevice-productid">productID</a>;
  readonly attribute unsigned long? <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="unsigned long? " href="#dom-bluetoothdevice-productversion">productVersion</a>;
  readonly attribute boolean <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="boolean " href="#dom-bluetoothdevice-paired">paired</a>;
  readonly attribute <a data-link-type="idl-name" href="#bluetoothgattremoteserver0">BluetoothGATTRemoteServer</a>? <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="BluetoothGATTRemoteServer? " href="#dom-bluetoothdevice-gattserver">gattServer</a>;
  readonly attribute <a data-link-type="idl-name" href="#typedefdef-uuid">UUID</a>[] <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="UUID[] " href="#dom-bluetoothdevice-uuids">uuids</a>;
  Promise&lt;<a data-link-type="idl-name" href="#bluetoothgattremoteserver0">BluetoothGATTRemoteServer</a>> <a class="idl-code" data-link-type="method" href="#dom-bluetoothdevice-connectgatt">connectGATT</a>();
};
<a data-link-type="idl-name" href="#bluetoothdevice0">BluetoothDevice</a> implements <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#eventtarget">EventTarget</a>;
<a data-link-type="idl-name" href="#bluetoothdevice0">BluetoothDevice</a> implements <a data-link-type="idl-name" href="#characteristiceventhandlers">CharacteristicEventHandlers</a>;
<a data-link-type="idl-name" href="#bluetoothdevice0">BluetoothDevice</a> implements <a data-link-type="idl-name" href="#serviceeventhandlers">ServiceEventHandlers</a>;
</pre>
     <div class="note no-marker" role="note">
      <div class="marker">NOTE: BluetoothDevice attributes</div>
      <p> <dfn class="idl-code" data-dfn-for="BluetoothDevice" data-dfn-type="attribute" data-export="" id="dom-bluetoothdevice-id">id<a class="self-link" href="#dom-bluetoothdevice-id"></a></dfn> uniquely identifies a device to the extent that
            the UA can determine that two Bluetooth connections are to the same device.
            It is computed as the <a data-link-type="dfn" href="#device-id">device id</a> in <a data-link-type="dfn" href="#add-an-allowed-bluetooth-device">add an allowed Bluetooth device</a>.
            This ID can’t be used to match a device across origins
            or after the user revokes and re-grants access to the device. </p>
      <p> <dfn class="idl-code" data-dfn-for="BluetoothDevice" data-dfn-type="attribute" data-export="" id="dom-bluetoothdevice-name">name<a class="self-link" href="#dom-bluetoothdevice-name"></a></dfn> is the human-readable name of the device. </p>
      <p> <dfn class="idl-code" data-dfn-for="BluetoothDevice" data-dfn-type="attribute" data-export="" id="dom-bluetoothdevice-addata">adData<a class="self-link" href="#dom-bluetoothdevice-addata"></a></dfn> contains the most recent advertising data received for this device. <span class="issue" id="issue-11ea2a6f"><a class="self-link" href="#issue-11ea2a6f"></a>TODO: Write the algorithm to update this
              when an advertising packet is received.</span> </p>
      <p> <dfn class="idl-code" data-dfn-for="BluetoothDevice" data-dfn-type="attribute" data-export="" id="dom-bluetoothdevice-deviceclass">deviceClass<a class="self-link" href="#dom-bluetoothdevice-deviceclass"></a></dfn> is the class of the device,
            a bit-field defined by <a data-link-type="biblio" href="#biblio-bluetooth-assigned-baseband">[BLUETOOTH-ASSIGNED-BASEBAND]</a>. </p>
      <p> <dfn class="idl-code" data-dfn-for="BluetoothDevice" data-dfn-type="attribute" data-export="" id="dom-bluetoothdevice-vendoridsource">vendorIDSource<a class="self-link" href="#dom-bluetoothdevice-vendoridsource"></a></dfn> is
            the Vendor ID Source field
            in the <code class="idl"><a data-link-type="idl" href="https://developer.bluetooth.org/gatt/characteristics/Pages/CharacteristicViewer.aspx?u=org.bluetooth.characteristic.pnp_id.xml#">pnp_id</a></code> characteristic
            in the <code class="idl"><a data-link-type="idl" href="https://developer.bluetooth.org/gatt/services/Pages/ServiceViewer.aspx?u=org.bluetooth.service.device_information.xml#">device_information</a></code> service. </p>
      <p> <dfn class="idl-code" data-dfn-for="BluetoothDevice" data-dfn-type="attribute" data-export="" id="dom-bluetoothdevice-vendorid">vendorID<a class="self-link" href="#dom-bluetoothdevice-vendorid"></a></dfn> is the 16-bit Vendor ID field
            in the <code class="idl"><a data-link-type="idl" href="https://developer.bluetooth.org/gatt/characteristics/Pages/CharacteristicViewer.aspx?u=org.bluetooth.characteristic.pnp_id.xml#">pnp_id</a></code> characteristic
            in the <code class="idl"><a data-link-type="idl" href="https://developer.bluetooth.org/gatt/services/Pages/ServiceViewer.aspx?u=org.bluetooth.service.device_information.xml#">device_information</a></code> service. </p>
      <p> <dfn class="idl-code" data-dfn-for="BluetoothDevice" data-dfn-type="attribute" data-export="" id="dom-bluetoothdevice-productid">productID<a class="self-link" href="#dom-bluetoothdevice-productid"></a></dfn> is the 16-bit Product ID field
            in the <code class="idl"><a data-link-type="idl" href="https://developer.bluetooth.org/gatt/characteristics/Pages/CharacteristicViewer.aspx?u=org.bluetooth.characteristic.pnp_id.xml#">pnp_id</a></code> characteristic
            in the <code class="idl"><a data-link-type="idl" href="https://developer.bluetooth.org/gatt/services/Pages/ServiceViewer.aspx?u=org.bluetooth.service.device_information.xml#">device_information</a></code> service. </p>
      <p> <dfn class="idl-code" data-dfn-for="BluetoothDevice" data-dfn-type="attribute" data-export="" id="dom-bluetoothdevice-productversion">productVersion<a class="self-link" href="#dom-bluetoothdevice-productversion"></a></dfn> is the 16-bit Product Version field in the <code class="idl"><a data-link-type="idl" href="https://developer.bluetooth.org/gatt/characteristics/Pages/CharacteristicViewer.aspx?u=org.bluetooth.characteristic.pnp_id.xml#">pnp_id</a></code> characteristic in the <code class="idl"><a data-link-type="idl" href="https://developer.bluetooth.org/gatt/services/Pages/ServiceViewer.aspx?u=org.bluetooth.service.device_information.xml#">device_information</a></code> service. </p>
      <p> <dfn class="idl-code" data-dfn-for="BluetoothDevice" data-dfn-type="attribute" data-export="" id="dom-bluetoothdevice-paired">paired<a class="self-link" href="#dom-bluetoothdevice-paired"></a></dfn> indicates whether or not the device is paired with the system. </p>
      <p> If the UA is currently connected to this device’s GATT server, <dfn class="idl-code" data-dfn-for="BluetoothDevice" data-dfn-type="attribute" data-export="" id="dom-bluetoothdevice-gattserver">gattServer<a class="self-link" href="#dom-bluetoothdevice-gattserver"></a></dfn> provides a way to interact with it.
            While this device is disconnected, <code class="idl"><a data-link-type="idl" href="#dom-bluetoothdevice-gattserver">gattServer</a></code> is <code>null</code>. </p>
      <p> <dfn class="idl-code" data-dfn-for="BluetoothDevice" data-dfn-type="attribute" data-export="" id="dom-bluetoothdevice-uuids">uuids<a class="self-link" href="#dom-bluetoothdevice-uuids"></a></dfn> lists
            the UUIDs of GATT services known to be on the device,
            that the current origin is allowed to access. </p>
     </div>
     <p> For each <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#script-execution-environment">script execution environment</a>,
          the UA must maintain a <dfn data-dfn-type="dfn" data-noexport="" id="device-instance-map">device instance map<a class="self-link" href="#device-instance-map"></a></dfn> mapping <a data-link-type="dfn" href="#bluetooth-device">Bluetooth device</a>s
          to <code>Promise&lt;<code class="idl"><a data-link-type="idl" href="#bluetoothdevice0">BluetoothDevice</a></code>></code> instances.
          To <dfn data-dfn-type="dfn" data-noexport="" id="get-the-bluetoothdevice-representing">get the <code>BluetoothDevice</code> representing<a class="self-link" href="#get-the-bluetoothdevice-representing"></a></dfn> a <a data-link-type="dfn" href="#bluetooth-device">Bluetooth device</a> <var>device</var>,
          the UA MUST run the following steps: </p>
     <ol>
      <li> If there is a key in
            the current <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#script-execution-environment">script execution environment</a>’s <a data-link-type="dfn" href="#device-instance-map">device instance map</a> that is the <a data-link-type="dfn" href="#same-device">same device</a> as <var>device</var>,
            return its value and abort these steps. 
      <li>Let <var>promise</var> be <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#a-new-promise">a new promise</a>.
      <li> Add a mapping from <var>device</var> to <var>promise</var> in the current <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#script-execution-environment">script execution environment</a>’s <a data-link-type="dfn" href="#device-instance-map">device instance map</a>. 
      <li>
       Return <var>promise</var>, and run the following steps <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">in parallel</a>. 
       <ol>
        <li>Let <var>result</var> be a new instance of <code class="idl"><a data-link-type="idl" href="#bluetoothdevice0">BluetoothDevice</a></code>.
        <li>Initialize all of <var>result</var>’s optional fields to <code>null</code>.
        <li> Initialize an internal <code><var>result</var>@[[representedDevice]]</code> field
                to <var>device</var>. 
        <li> Find the key in this origin’s <a data-link-type="dfn" href="#allowed-devices-map">allowed devices map</a> that is the <a data-link-type="dfn" href="#same-device">same device</a> as <var>device</var>.
                If there is no such key, <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#resolve-promise">resolve</a> <var>promise</var> with a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#securityerror">SecurityError</a></code> and abort these steps.
                Otherwise, initialize <code><var>result</var>.id</code> to the <a data-link-type="dfn" href="#device-id">device id</a> this key maps to,
                and initialize an internal <code><var>result</var>@[[allowedServices]]</code> field
                to the <a data-link-type="dfn" href="#allowed-services-list">allowed services list</a> this key maps to. 
        <li> If <var>device</var> has a partial or complete <a data-link-type="dfn" href="#bluetooth-device-name">Bluetooth Device Name</a>,
                set <code><var>result</var>.name</code> to that string. 
        <li> <a data-link-type="dfn" href="#create-a-bluetoothadvertisingdata">Create a <code>BluetoothAdvertisingData</code></a> from <var>device</var> and <code><var>result</var>@[[allowedServices]]</code>,
                and set <code><var>result</var>.adData</code> to the result. 
        <li> If <var>device</var> has a <a data-link-type="dfn" href="#class-of-device">Class of Device</a>,
                set <code><var>result</var>.deviceClass</code> to that value. 
        <li> <a data-link-type="dfn" href="#populate-the-bluetooth-cache">Populate the Bluetooth cache</a> with
                the <code class="idl"><a data-link-type="idl" href="https://developer.bluetooth.org/gatt/characteristics/Pages/CharacteristicViewer.aspx?u=org.bluetooth.characteristic.pnp_id.xml#">org.bluetooth.characteristic.pnp_id</a></code> characteristic inside
                the <code class="idl"><a data-link-type="idl" href="https://developer.bluetooth.org/gatt/services/Pages/ServiceViewer.aspx?u=org.bluetooth.service.device_information.xml#">org.bluetooth.service.device_information</a></code> service.
                Ignore any errors from this step. 
        <li>
          If the <a data-link-type="dfn" href="#bluetooth-cache0">Bluetooth cache</a> now has a known-present entry for this characteristic,
                run the following substeps. 
         <ol>
          <li> Use any combination of the sub-procedures in
                    the <a data-link-type="dfn" href="#characteristic-value-read">Characteristic Value Read</a> procedure to retrieve the value
                    of the <code class="idl"><a data-link-type="idl" href="https://developer.bluetooth.org/gatt/characteristics/Pages/CharacteristicViewer.aspx?u=org.bluetooth.characteristic.pnp_id.xml#">org.bluetooth.characteristic.pnp_id</a></code> characteristic
                    into <var>pnp</var>.
                    Handle errors as described in <a href="#error-handling">§5.7 Error handling</a>. 
          <li>If the previous step returned an error, abort these substeps.
          <li> Parse <var>pnp</var> as specified by
                    the <code class="idl"><a data-link-type="idl" href="https://developer.bluetooth.org/gatt/characteristics/Pages/CharacteristicViewer.aspx?u=org.bluetooth.characteristic.pnp_id.xml#">org.bluetooth.characteristic.pnp_id</a></code> characteristic definition.
                    If it’s not 7 bytes long or
                    if the Vendor ID Source is not <code>1</code> or <code>2</code>,
                    abort these substeps. 
          <li>
            Set <code><var>result</var>.vendorIDSource</code> according to the following table: 
           <table>
            <tbody>
             <tr>
              <th>Parsed Vendor Id Source
              <th><code>vendorIDSource</code>
             <tr>
              <td>1
              <td><code>"bluetooth"</code>
             <tr>
              <td>2
              <td><code>"usb"</code>
           </table>
          <li> Set <code><var>result</var>.vendorID</code> to the value parsed for Vendor ID. 
          <li> Set <code><var>result</var>.productID</code> to the value parsed for Product ID. 
          <li> Set <code><var>result</var>.productVersion</code> to
                    the value parsed for Product Version. 
         </ol>
        <li> Initialize <code><var>result</var>.paired</code> to
                the value of <var>device</var>’s <a data-link-type="dfn" href="#bonded-flag">bonded flag</a>. 
        <li> Let <var>uuids</var> be an empty set of UUIDs. 
        <li> Add <var>device</var>’s
                advertised <a data-link-type="dfn" href="#service-uuid-data-type">Service UUIDs</a> to <var>uuids</var>. 
        <li> The UA MAY <a data-link-type="dfn" href="#populate-the-bluetooth-cache">populate the Bluetooth cache</a> with
                all Services inside <var>device</var>.
                Ignore any errors from this step. 
        <li> If the <a data-link-type="dfn" href="#bluetooth-cache0">Bluetooth cache</a> contains
                known-present Services inside <var>device</var>,
                add the UUIDs of those Services to <var>uuids</var>. 
        <li> Initialize <code><var>result</var>.uuids</code> to
                a <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-read-only-array">read only Array</a> holding the elements of <var>uuids</var> that are also in <code><var>result</var>@[[allowedServices]]</code>. 
        <li>Resolve <var>promise</var> with <var>result</var>.
       </ol>
     </ol>
     <p> The <code><dfn class="idl-code" data-dfn-for="BluetoothDevice" data-dfn-type="method" data-export="" id="dom-bluetoothdevice-connectgatt">connectGATT()<a class="self-link" href="#dom-bluetoothdevice-connectgatt"></a></dfn></code> method, when invoked,
          MUST return <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#a-new-promise">a new promise</a> <var>promise</var> and
          run the following steps <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">in parallel</a>: </p>
     <ol>
      <li> If <code>this@[[representedDevice]]</code> has no <a data-link-type="dfn" href="#att-bearer">ATT Bearer</a>,
            attempt to create one using the procedures described
            in "Connection Establishment" under <a data-link-type="dfn" href="#gap-interoperability-requirements">GAP Interoperability Requirements</a>. 
      <li> If this attempt fails,
            reject <var>promise</var> with a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#networkerror">NetworkError</a></code> and abort these steps. 
      <li>
        <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">Queue a task</a> to do the following steps: 
       <ol>
        <li> If <code>this.gattServer</code> is <code>null</code>,
                set it to a new <code class="idl"><a data-link-type="idl" href="#bluetoothgattremoteserver0">BluetoothGATTRemoteServer</a></code> instance
                with its <code>device</code> attribute initialized to <code>this</code> and its <code>connected</code> attribute initialized to <code>true</code>. 
        <li> Resolve <var>promise</var> with <code>this.gattServer</code>. 
       </ol>
     </ol>
     <section>
      <h4 class="heading settled" data-level="4.3.1" id="bluetoothadvertisingdata"><span class="secno">4.3.1. </span><span class="content"><dfn class="idl-code" data-dfn-type="interface" data-export="" id="bluetoothadvertisingdata0">BluetoothAdvertisingData<a class="self-link" href="#bluetoothadvertisingdata0"></a></dfn></span><a class="self-link" href="#bluetoothadvertisingdata"></a></h4>
<pre class="idl">interface <a class="idl-code" data-link-type="interface" href="#bluetoothadvertisingdata0">BluetoothAdvertisingData</a> {
  readonly attribute unsigned short? <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="unsigned short? " href="#dom-bluetoothadvertisingdata-appearance">appearance</a>;
  readonly attribute byte? <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="byte? " href="#dom-bluetoothadvertisingdata-txpower">txPower</a>;
  readonly attribute byte? <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="byte? " href="#dom-bluetoothadvertisingdata-rssi">rssi</a>;
  readonly attribute <a data-link-type="idl-name" href="http://ecma-international.org/ecma-262/6.0/#sec-map-constructor">Map</a> <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="Map " href="#dom-bluetoothadvertisingdata-manufacturerdata">manufacturerData</a>;
  readonly attribute <a data-link-type="idl-name" href="http://ecma-international.org/ecma-262/6.0/#sec-map-constructor">Map</a> <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="Map " href="#dom-bluetoothadvertisingdata-servicedata">serviceData</a>;
};
</pre>
      <div class="note no-marker" role="note">
       <div class="marker">NOTE: BluetoothAdvertisingData attributes</div>
       <p> <dfn class="idl-code" data-dfn-for="BluetoothAdvertisingData" data-dfn-type="attribute" data-export="" id="dom-bluetoothadvertisingdata-appearance">appearance<a class="self-link" href="#dom-bluetoothadvertisingdata-appearance"></a></dfn> is an <a data-link-type="dfn" href="#appearance">Appearance</a>, one of the values defined by
              the <code class="idl"><a data-link-type="idl" href="https://developer.bluetooth.org/gatt/characteristics/Pages/CharacteristicViewer.aspx?u=org.bluetooth.characteristic.gap.appearance.xml#">org.bluetooth.characteristic.gap.appearance</a></code> characteristic. </p>
       <p> <dfn class="idl-code" data-dfn-for="BluetoothAdvertisingData" data-dfn-type="attribute" data-export="" id="dom-bluetoothadvertisingdata-txpower">txPower<a class="self-link" href="#dom-bluetoothadvertisingdata-txpower"></a></dfn> is
              the transmission power at which the device is broadcasting, measured in dBm.
              This is used to compute the path loss as <code>this.txPower - this.rssi</code>. </p>
       <p> <dfn class="idl-code" data-dfn-for="BluetoothAdvertisingData" data-dfn-type="attribute" data-export="" id="dom-bluetoothadvertisingdata-rssi">rssi<a class="self-link" href="#dom-bluetoothadvertisingdata-rssi"></a></dfn> is
              the power at which the device’s packets are being received, measured in dBm.
              This is used to compute the path loss as <code>this.txPower - this.rssi</code>. </p>
       <p> <dfn class="idl-code" data-dfn-for="BluetoothAdvertisingData" data-dfn-type="attribute" data-export="" id="dom-bluetoothadvertisingdata-manufacturerdata">manufacturerData<a class="self-link" href="#dom-bluetoothadvertisingdata-manufacturerdata"></a></dfn> maps <code>unsigned short</code> Company Identifier Codes
              to <code class="idl"><a data-link-type="idl" href="http://ecma-international.org/ecma-262/6.0/#sec-arraybuffer-constructor">ArrayBuffer</a></code>s. </p>
       <p> <dfn class="idl-code" data-dfn-for="BluetoothAdvertisingData" data-dfn-type="attribute" data-export="" id="dom-bluetoothadvertisingdata-servicedata">serviceData<a class="self-link" href="#dom-bluetoothadvertisingdata-servicedata"></a></dfn> maps <code class="idl"><a data-link-type="idl" href="#typedefdef-uuid">UUID</a></code>s to <code class="idl"><a data-link-type="idl" href="http://ecma-international.org/ecma-262/6.0/#sec-arraybuffer-constructor">ArrayBuffer</a></code>s. </p>
      </div>
      <div class="example" id="example-492a8e9a">
       <a class="self-link" href="#example-492a8e9a"></a> 
       <p> To retrieve a device and read the iBeacon data out of it,
              a developer could use the following code.
              Note that this API currently doesn’t provide a way
              to request devices with certain manufacturer data,
              so the iBeacon will need to rotate its advertisements to include a known service
              in order for users to select this device in the <code>requestDevice</code> dialog. </p>
<pre>var known_service = "A service in the iBeacon’s GATT server";
return navigator.bluetooth.requestDevice({
  filters: [{services: [known_service]}]
}).then(device => {
  var rssi = device.adData.rssi;
  var appleData = new DataView(device.adData.manufacturerData.get(<a href="https://www.bluetooth.org/en-us/specification/assigned-numbers/company-identifiers" title="Apple, Inc.&apos;s Company Identifier">0x004C</a>));
  if (appleData.byteLength != 23 ||
      appleData.getUint16(0, false) !== 0x0215) {
    return {isBeacon: false};
  }
  var uuidArray = new Uint8Array(appleData.buffer, 2, 16);
  var major = appleData.getUint16(18, false);
  var minor = appleData.getUint16(20, false);
  var txPowerAt1m = -appleData.getInt8(22);
  return {isBeacon: true,
          uuidArray,
          major,
          minor,
          pathLossVs1m: txPowerAt1m - rssi};
});
</pre>
       <p> The format of iBeacon advertisements was derived from <a href="http://www.warski.org/blog/2014/01/how-ibeacons-work/">How do iBeacons work?</a> by Adam Warski. </p>
      </div>
      <p> All fields in <code class="idl"><a data-link-type="idl" href="#bluetoothadvertisingdata0">BluetoothAdvertisingData</a></code> return
            the last value they were initialized or set to. </p>
      <p> To <dfn data-dfn-type="dfn" data-noexport="" id="create-a-bluetoothadvertisingdata">create a <code class="idl"><a data-link-type="idl" href="#bluetoothadvertisingdata0">BluetoothAdvertisingData</a></code><a class="self-link" href="#create-a-bluetoothadvertisingdata"></a></dfn> from a <a data-link-type="dfn" href="#bluetooth-device">Bluetooth device</a> <var>device</var> and an <var>allowed services list</var>,
            the UA must perform the following steps: </p>
      <ol>
       <li>Let <var>adData</var> be a new instance of <code class="idl"><a data-link-type="idl" href="#bluetoothadvertisingdata0">BluetoothAdvertisingData</a></code>.
       <li> If <var>device</var> has an <a data-link-type="dfn" href="#appearance">Appearance</a>,
              initialize <code><var>adData</var>.appearance</code> to its value.
              Otherwise, initialize it to <code>null</code>. 
       <li> If <var>device</var> has a <a data-link-type="dfn" href="#tx-power-level">TX Power Level</a>,
              initialize <code><var>adData</var>.txPower</code> to its value.
              Otherwise initialize it to <code>null</code>. 
       <li> If <var>device</var> has an <a data-link-type="dfn" href="#rssi">RSSI</a>,
              initialize <code><var>adData</var>.rssi</code> to its value.
              Otherwise initialize it to <code>null</code>. 
       <li>
         Initialize <code><var>adData</var>.manufacturerData</code> with
              the return value of these substeps: 
        <ol>
         <li>Let <var>mdata</var> be a new <code class="idl"><a data-link-type="idl" href="http://ecma-international.org/ecma-262/6.0/#sec-map-constructor">Map</a></code> instance.
         <li> For each mapping in <var>device</var>’s <a data-link-type="dfn" href="#manufacturer-specific-data">Manufacturer Specific Data</a>,
                  make a new <a data-link-type="dfn" href="#read-only-arraybuffer">read only ArrayBuffer</a> <var>bytes</var> containing the contents of its byte array,
                  and add a mapping from the 16-bit code to <var>bytes</var> in <var>mdata</var>. 
         <li> Return a <a data-link-type="dfn" href="#read-only-map">read only Map</a> whose value is <var>mdata</var>. 
        </ol>
       <li>
         Initialize <code><var>adData</var>.serviceData</code> with
              the return value of these substeps: 
        <ol>
         <li>Let <var>sdata</var> be a new <code class="idl"><a data-link-type="idl" href="http://ecma-international.org/ecma-262/6.0/#sec-map-constructor">Map</a></code> instance.
         <li> For each mapping in <var>device</var>’s <a data-link-type="dfn" href="#service-data">Service Data</a>,
                  if the UUID is in <var>allowed services list</var>,
                  make a new <a data-link-type="dfn" href="#read-only-arraybuffer">read only ArrayBuffer</a> <var>bytes</var> containing the contents of its byte array,
                  and add a mapping from the <a data-link-type="dfn" href="#uuid">UUID</a> to <var>bytes</var> in <var>sdata</var>. 
         <li> Return a <a data-link-type="dfn" href="#read-only-map">read only Map</a> whose value is <var>sdata</var>. 
        </ol>
       <li>Return <var>adData</var>.
      </ol>
     </section>
    </section>
   </section>
   <section>
    <h2 class="heading settled" data-level="5" id="gatt-interaction"><span class="secno">5. </span><span class="content">GATT Interaction</span><a class="self-link" href="#gatt-interaction"></a></h2>
    <section id="">
     <h3 class="heading settled" data-level="5.1" id="information-model"><span class="secno">5.1. </span><span class="content">GATT Information Model</span><a class="self-link" href="#information-model"></a></h3>
     <div class="note" role="note">
      <p> The <a data-link-type="dfn" href="#gatt-profile-hierarchy">GATT Profile Hierarchy</a> describes how a <a data-link-type="idl" href="#bluetoothgattremoteserver0">GATT Server</a> contains a hierarchy of Profiles, Primary <a data-link-type="dfn" href="#service">Service</a>s, <a data-link-type="dfn" href="#included-service">Included Service</a>s, <a data-link-type="dfn" href="#characteristic">Characteristic</a>s, and <a data-link-type="dfn" href="#descriptor">Descriptor</a>s. </p>
      <p> Profiles are purely logical:
            the specification of a Profile describes the expected interactions between
            the other GATT entities the Profile contains,
            but it’s impossible to query which Profiles a device supports. </p>
      <p> <a data-link-type="dfn" href="#gatt-client">GATT Client</a>s can discover and interact with
            the Services, Characteristics, and Descriptors on a device
            using a set of <a data-link-type="dfn" href="#gatt-procedure">GATT procedures</a>.
            This spec refers to Services, Characteristics, and Descriptors
            collectively as <dfn data-dfn-type="dfn" data-noexport="" id="attribute">Attribute<a class="self-link" href="#attribute"></a></dfn>s.
            All Attributes have a type that’s identified by a <a data-link-type="dfn" href="#uuid">UUID</a>.
            Each Attribute also has a 16-bit <a data-link-type="dfn" href="#attribute-handle">Attribute Handle</a> that distinguishes it from other Attributes
            of the same type on the same <a data-link-type="dfn" href="#gatt-server">GATT Server</a>.
            Attributes are notionally ordered within their <a data-link-type="dfn" href="#gatt-server">GATT Server</a> by their <a data-link-type="dfn" href="#attribute-handle">Attribute Handle</a>,
            but while platform interfaces provide these entities in some order,
            they do not guarantee that it’s consistent with the <a data-link-type="dfn" href="#attribute-handle">Attribute Handle</a> order. </p>
      <p data-link-for-hint="BluetoothGATTService"> A <a data-link-type="idl" href="#bluetoothgattservice0">Service</a> contains
            a collection of <a data-link-type="idl" href="#dom-bluetoothgattservice-getincludedservice">Included Service</a>s
            and <a data-link-type="idl" href="#dom-bluetoothgattservice-getcharacteristic">Characteristic</a>s.
            The Included Services are references to other Services,
            and a single Service can be included by more than one other Service.
            Services are known as <a data-link-type="idl" href="#dom-bluetoothgattservice-isprimary">Primary Services</a> if they appear directly under the <a data-link-type="idl" href="#bluetoothgattremoteserver0">GATT Server</a>,
            and Secondary Services if they’re only included by other Services,
            but Primary Services can also be included. </p>
      <p data-link-for-hint="BluetoothGATTCharacteristic"> A <a data-link-type="idl" href="#bluetoothgattcharacteristic0">Characteristic</a> contains a value, which is an array of bytes,
            and a collection of <a data-link-type="idl" href="#dom-bluetoothgattcharacteristic-getdescriptor">Descriptor</a>s.
            Depending on the <a data-link-type="idl" href="#bluetoothcharacteristicproperties">properties</a> of the Characteristic,
            a <a data-link-type="dfn" href="#gatt-client">GATT Client</a> can read or write its value,
            or register to be notified when the value changes. </p>
      <p> Finally, a <a data-link-type="idl" href="#bluetoothgattdescriptor0">Descriptor</a> contains a value (again an array of bytes)
            that describes or configures its <a data-link-type="dfn" href="#characteristic">Characteristic</a>. </p>
     </div>
     <section>
      <h4 class="heading settled" data-level="5.1.1" id="bluetooth-cache"><span class="secno">5.1.1. </span><span class="content">The Bluetooth cache</span><a class="self-link" href="#bluetooth-cache"></a></h4>
      <p> The UA MUST maintain a <dfn data-dfn-type="dfn" data-noexport="" id="bluetooth-cache0">Bluetooth cache<a class="self-link" href="#bluetooth-cache0"></a></dfn> of the hierarchy of Services, Characteristics, and Descriptors
            it has discovered on a device.
            The UA MAY share this cache between multiple origins accessing the same device.
            Each potential entity in the cache is either known-present, known-absent, or unknown.
            The cache MUST NOT contain two entities that are for the <a data-link-type="dfn" href="#same-attribute">same attribute</a>.
            Each known-present entity in the cache is associated with an optional <code>Promise&lt;<code class="idl"><a data-link-type="idl" href="#bluetoothgattservice0">BluetoothGATTService</a></code>></code>, <code>Promise&lt;<code class="idl"><a data-link-type="idl" href="#bluetoothgattcharacteristic0">BluetoothGATTCharacteristic</a></code>></code>,
            or <code>Promise&lt;<code class="idl"><a data-link-type="idl" href="#bluetoothgattdescriptor0">BluetoothGATTDescriptor</a></code>></code> instance
            for each <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#script-execution-environment">script execution environment</a>. </p>
      <p class="note" role="note"> For example, if a user calls the <code>serviceA.getCharacteristic(uuid1)</code> function
            with an initially empty <a data-link-type="dfn" href="#bluetooth-cache0">Bluetooth cache</a>,
            the UA uses the <a data-link-type="dfn" href="#discover-characteristics-by-uuid">Discover Characteristics by UUID</a> procedure
            to fill the needed cache entries,
            and the UA ends the procedure early because
            it only needs one Characteristic to fulfil the returned <code class="idl"><a data-link-type="idl" href="http://ecma-international.org/ecma-262/6.0/#sec-promise-objects">Promise</a></code>,
            then the first Characteristic with UUID <code>uuid1</code> inside <code>serviceA</code> is known-present,
            and any subsequent Characteristics with that UUID remain unknown.
            If the user later calls <code>serviceA.getCharacteristics(uuid1)</code>,
            the UA needs to resume or restart the <a data-link-type="dfn" href="#discover-characteristics-by-uuid">Discover Characteristics by UUID</a> procedure.
            If it turns out that <code>serviceA</code> only has one Characteristic with UUID <code>uuid1</code>,
            then the subsequent Characteristics become known-absent. </p>
      <p> The known-present entries in the <a data-link-type="dfn" href="#bluetooth-cache0">Bluetooth cache</a> are ordered:
            Primary Services appear in a particular order within a device,
            Included Services and Characteristics appear in a particular order within Services,
            and Descriptors appear in a particular order within Characteristics.
            The order SHOULD match the order of <a data-link-type="dfn" href="#attribute-handle">Attribute Handle</a>s on the device,
            but UAs MAY use another order if the device’s order isn’t available. </p>
      <p> To <dfn data-dfn-type="dfn" data-noexport="" id="populate-the-bluetooth-cache">populate the Bluetooth cache<a class="self-link" href="#populate-the-bluetooth-cache"></a></dfn> with entries matching some description,
            the UA MUST run the following steps. <span class="note" role="note">Note that these steps can block,
              so uses of this algorithm must be <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">in parallel</a>.</span> </p>
      <ol>
       <li> Attempt to make all matching entries in the cache either known-present or known-absent,
              using any sequence of <a data-link-type="dfn" href="#gatt-procedure">GATT procedures</a> that <a data-link-type="biblio" href="#biblio-bluetooth42">[BLUETOOTH42]</a> specifies
              will return enough information.
              Handle errors as described in <a href="#error-handling">§5.7 Error handling</a>. 
       <li> If the previous step returns an error, return that error from this algorithm. 
      </ol>
      <p> To <dfn data-dfn-type="dfn" data-noexport="" id="query-the-bluetooth-cache">query the Bluetooth cache<a class="self-link" href="#query-the-bluetooth-cache"></a></dfn> for entries matching some description,
            the UA MUST return <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#a-new-promise">a new promise</a> <var>promise</var> and run the following steps <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">in parallel</a>: </p>
      <ol>
       <li> <a data-link-type="dfn" href="#populate-the-bluetooth-cache">Populate the Bluetooth cache</a> with entries matching the description. 
       <li> If the previous step returns an error, <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#reject-promise">reject</a> <var>promise</var> with that error and abort these steps. 
       <li> Let <var>entries</var> be the sequence
              of known-present cache entries matching the description. 
       <li> Let <var>result</var> be a new sequence. 
       <li>
         For each <var>entry</var> in <var>entries</var>: 
        <ol>
         <li> If <var>entry</var> has no associated <code>BluetoothGATT*</code> instance
                  for the current <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#script-execution-environment">script execution environment</a>, <a data-link-type="dfn" href="#create-a-bluetoothgattservice-representing">create a <code>BluetoothGATTService</code> representing</a> <var>entry</var>, <a data-link-type="dfn" href="#create-a-bluetoothgattcharacteristic-representing">create a <code>BluetoothGATTCharacteristic</code> representing</a> <var>entry</var>,
                  or <a data-link-type="dfn" href="#create-a-bluetoothgattdescriptor-representing">create a <code>BluetoothGATTDescriptor</code> representing</a> <var>entry</var>,
                  depending on whether <var>entry</var> is a Service, Characteristic, or Descriptor,
                  and associate the resulting <code>Promise</code> with <var>entry</var>. 
         <li> Append to <var>result</var> the <code>Promise&lt;BluetoothGATT*></code> instance
                  associated with <var>entry</var> for the current <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#script-execution-environment">script execution environment</a>. 
        </ol>
       <li> <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#resolve-promise">Resolve</a> <var>promise</var> with the result of <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#waiting-for-all">waiting for all</a> elements of <var>result</var>. 
      </ol>
     </section>
     <section>
      <h4 class="heading settled" data-level="5.1.2" id="navigating-bluetooth-hierarchy"><span class="secno">5.1.2. </span><span class="content">Navigating the Bluetooth Hierarchy</span><a class="self-link" href="#navigating-bluetooth-hierarchy"></a></h4>
      <p> To <dfn data-dfn-type="dfn" data-noexport="" id="getgattchildren">GetGATTChildren<a class="self-link" href="#getgattchildren"></a></dfn>(<span class="argument-list"><var>attribute</var>: GATT Attribute,<br> <var>single</var>: boolean,<br> <var>uuidCanonicalizer</var>: function,<br> <var>uuid</var>: optional <code>(DOMString or unsigned int)</code>,<br> <var>child type</var>: GATT declaration type),</span><br> the UA MUST perform the following steps: </p>
      <ol>
       <li> If <var>uuid</var> is present,
              set it to <var>uuidCanonicalizer</var>(<var>uuid</var>).
              If <var>uuidCanonicalizer</var> threw an exception,
              return <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#a-promise-rejected-with">a promise rejected with</a> that exception and abort these steps. 
       <li> If <var>uuid</var> is present and is <a data-link-type="dfn" href="#blacklisted">blacklisted</a>,
              return <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#a-promise-rejected-with">a promise rejected with</a> a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#securityerror">SecurityError</a></code> and abort these steps. 
       <li>
         <a data-link-type="dfn" href="#query-the-bluetooth-cache">Query the Bluetooth cache</a> for entries that: 
        <ul>
         <li>are within <var>attribute</var>,
         <li>have a type described by <var>child type</var>,
         <li>if <var>uuid</var> is present, have a UUID of <var>uuid</var>, and
         <li>if the <var>single</var> flag is set, are the first of these.
        </ul>
         Let <var>promise</var> be the result. 
       <li>
         Return the result of <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#transforming-by">transforming</a> <var>promise</var> with a fulfillment handler that: 
        <ul>
         <li>If its argument is empty, throws a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#notfounderror">NotFoundError</a></code>,
         <li> Otherwise, if the <var>single</var> flag is set,
                  returns the first (only) element of its argument. 
         <li>Otherwise, returns its argument.
        </ul>
      </ol>
     </section>
     <section>
      <h4 class="heading settled" data-level="5.1.3" id="identifying-attributes"><span class="secno">5.1.3. </span><span class="content">Identifying Services, Characteristics, and Descriptors</span><a class="self-link" href="#identifying-attributes"></a></h4>
      <p> When checking whether two Services, Characteristics, or Descriptors <var>a</var> and <var>b</var> are the <dfn data-dfn-type="dfn" data-noexport="" id="same-attribute">same attribute<a class="self-link" href="#same-attribute"></a></dfn>,
            the UA SHOULD determine that they are the same if <var>a</var> and <var>b</var> are inside the <a data-link-type="dfn" href="#same-device">same device</a> and have the same <a data-link-type="dfn" href="#attribute-handle">Attribute Handle</a>,
            but MAY use any algorithm it wants with the constraint that <var>a</var> and <var>b</var> MUST NOT be considered the <a data-link-type="dfn" href="#same-attribute">same attribute</a> if
            they fit any of the following conditions: </p>
      <ul>
       <li>They are not both Services, both Characteristics, or both Descriptors.
       <li>They are both Services, but are not both primary or both secondary services.
       <li>They have different UUIDs.
       <li> Their parent Devices aren’t the <a data-link-type="dfn" href="#same-device">same device</a> or
              their parent Services or Characteristics aren’t the <a data-link-type="dfn" href="#same-attribute">same attribute</a>. 
      </ul>
      <p class="note" role="note"> This definition is loose because platform APIs expose their own notion of identity
            without documenting whether it’s based on <a data-link-type="dfn" href="#attribute-handle">Attribute Handle</a> equality. </p>
      <p class="note" role="note"> For two Javascript objects representing Services, Characteristics, or Descriptors, <code><var>x</var> === <var>y</var></code> returns
            whether the objects represent the <a data-link-type="dfn" href="#same-attribute">same attribute</a>,
            because of how the <a data-link-type="dfn" href="#query-the-bluetooth-cache">query the Bluetooth cache</a> algorithm
            creates and caches new objects. </p>
     </section>
    </section>
    <section>
     <h3 class="heading settled" data-level="5.2" id="bluetoothgattremoteserver"><span class="secno">5.2. </span><span class="content"><dfn class="idl-code" data-dfn-type="interface" data-export="" id="bluetoothgattremoteserver0">BluetoothGATTRemoteServer<a class="self-link" href="#bluetoothgattremoteserver0"></a></dfn></span><a class="self-link" href="#bluetoothgattremoteserver"></a></h3>
     <p> <code class="idl"><a data-link-type="idl" href="#bluetoothgattremoteserver0">BluetoothGATTRemoteServer</a></code> represents a <a data-link-type="dfn" href="#gatt-server">GATT Server</a> on a remote device. </p>
<pre class="idl">interface <a class="idl-code" data-link-type="interface" href="#bluetoothgattremoteserver0">BluetoothGATTRemoteServer</a> {
  readonly attribute <a data-link-type="idl-name" href="#bluetoothdevice0">BluetoothDevice</a> <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="BluetoothDevice " href="#dom-bluetoothgattremoteserver-device">device</a>;
  readonly attribute boolean <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="boolean " href="#dom-bluetoothgattremoteserver-connected">connected</a>;
  void <a class="idl-code" data-link-type="method" href="#dom-bluetoothgattremoteserver-disconnect">disconnect</a>();
  Promise&lt;<a data-link-type="idl-name" href="#bluetoothgattservice0">BluetoothGATTService</a>> <a class="idl-code" data-link-type="method" href="#dom-bluetoothgattremoteserver-getprimaryservice">getPrimaryService</a>(<a data-link-type="idl-name" href="#typedefdef-bluetoothserviceuuid">BluetoothServiceUUID</a> <dfn class="idl-code" data-dfn-for="BluetoothGATTRemoteServer/getPrimaryService(service)" data-dfn-type="argument" data-export="" id="dom-bluetoothgattremoteserver-getprimaryservice-service-service">service<a class="self-link" href="#dom-bluetoothgattremoteserver-getprimaryservice-service-service"></a></dfn>);
  Promise&lt;sequence&lt;<a data-link-type="idl-name" href="#bluetoothgattservice0">BluetoothGATTService</a>>>
    <a class="idl-code" data-link-type="method" href="#dom-bluetoothgattremoteserver-getprimaryservices">getPrimaryServices</a>(optional <a data-link-type="idl-name" href="#typedefdef-bluetoothserviceuuid">BluetoothServiceUUID</a> <dfn class="idl-code" data-dfn-for="BluetoothGATTRemoteServer/getPrimaryServices(service), BluetoothGATTRemoteServer/getPrimaryServices()" data-dfn-type="argument" data-export="" id="dom-bluetoothgattremoteserver-getprimaryservices-service-service">service<a class="self-link" href="#dom-bluetoothgattremoteserver-getprimaryservices-service-service"></a></dfn>);
};
<a data-link-type="idl-name" href="#bluetoothgattremoteserver0">BluetoothGATTRemoteServer</a> implements <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#eventtarget">EventTarget</a>;
<a data-link-type="idl-name" href="#bluetoothgattremoteserver0">BluetoothGATTRemoteServer</a> implements <a data-link-type="idl-name" href="#characteristiceventhandlers">CharacteristicEventHandlers</a>;
<a data-link-type="idl-name" href="#bluetoothgattremoteserver0">BluetoothGATTRemoteServer</a> implements <a data-link-type="idl-name" href="#serviceeventhandlers">ServiceEventHandlers</a>;
</pre>
     <div class="note no-marker" role="note">
      <div class="marker">NOTE: BluetoothGATTRemoteServer attributes</div>
      <p> <dfn class="idl-code" data-dfn-for="BluetoothGATTRemoteServer" data-dfn-type="attribute" data-export="" id="dom-bluetoothgattremoteserver-device">device<a class="self-link" href="#dom-bluetoothgattremoteserver-device"></a></dfn> is the device running this server. </p>
      <p> <dfn class="idl-code" data-dfn-for="BluetoothGATTRemoteServer" data-dfn-type="attribute" data-export="" id="dom-bluetoothgattremoteserver-connected">connected<a class="self-link" href="#dom-bluetoothgattremoteserver-connected"></a></dfn> is true while this <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#script-execution-environment">script execution environment</a> is connected to <code>this.device</code>.
            It can be false while the UA is physically connected. </p>
     </div>
     <p> The <code><dfn class="idl-code" data-dfn-for="BluetoothGATTRemoteServer" data-dfn-type="method" data-export="" id="dom-bluetoothgattremoteserver-disconnect">disconnect()<a class="self-link" href="#dom-bluetoothgattremoteserver-disconnect"></a></dfn></code> method, when invoked,
          MUST perform the following steps: </p>
     <ol>
      <li> Set <code>this.connected</code> to <code>false</code>. 
      <li> <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">In parallel</a>:
            if, for all <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#script-execution-environment">script execution environment</a>s,
            all <code class="idl"><a data-link-type="idl" href="#bluetoothdevice0">BluetoothDevice</a></code>s <code><var>device</var></code> with <code><var>device</var>@[[representedDevice]]</code> the <a data-link-type="dfn" href="#same-device">same device</a> as <code>this.device@[[representedDevice]]</code>, <code><var>device</var>.gattServer === null</code> or <code>!<var>device</var>.gattServer.connected</code>,
            the UA MAY destroy <code><var>device</var>@[[representedDevice]]</code>’s <a data-link-type="dfn" href="#att-bearer">ATT Bearer</a>. 
     </ol>
     <p> The <code><dfn class="idl-code" data-dfn-for="BluetoothGATTRemoteServer" data-dfn-type="method" data-export="" id="dom-bluetoothgattremoteserver-getprimaryservice">getPrimaryService(<var>service</var>)<a class="self-link" href="#dom-bluetoothgattremoteserver-getprimaryservice"></a></dfn></code> method, when invoked,
          MUST return </p>
     <blockquote> <a data-link-type="dfn" href="#getgattchildren">GetGATTChildren</a>(<span class="argument-list"><var>attribute</var>=<code>this@[[representedDevice]]</code>,<br> <var>single</var>=true,<br> <var>uuidCanonicalizer</var>=<code class="idl"><a data-link-type="idl" href="#dom-bluetoothuuid-getservice">BluetoothUUID.getService</a></code>,<br> <var>uuid</var>=<code><var>service</var></code>,<br> <var>child type</var>="GATT Primary Service")</span> </blockquote>
     <p> The <code><dfn class="idl-code" data-dfn-for="BluetoothGATTRemoteServer" data-dfn-type="method" data-export="" id="dom-bluetoothgattremoteserver-getprimaryservices">getPrimaryServices(<var>service</var>)<a class="self-link" href="#dom-bluetoothgattremoteserver-getprimaryservices"></a></dfn></code> method, when invoked,
          MUST return </p>
     <blockquote> <a data-link-type="dfn" href="#getgattchildren">GetGATTChildren</a>(<span class="argument-list"><var>attribute</var>=<code>this@[[representedDevice]]</code>,<br> <var>single</var>=false,<br> <var>uuidCanonicalizer</var>=<code class="idl"><a data-link-type="idl" href="#dom-bluetoothuuid-getservice">BluetoothUUID.getService</a></code>,<br> <var>uuid</var>=<code><var>service</var></code>,<br> <var>child type</var>="GATT Primary Service")</span> </blockquote>
    </section>
    <section>
     <h3 class="heading settled" data-level="5.3" id="bluetoothgattservice"><span class="secno">5.3. </span><span class="content"><dfn class="idl-code" data-dfn-type="interface" data-export="" id="bluetoothgattservice0">BluetoothGATTService<a class="self-link" href="#bluetoothgattservice0"></a></dfn></span><a class="self-link" href="#bluetoothgattservice"></a></h3>
     <p> <code class="idl"><a data-link-type="idl" href="#bluetoothgattservice0">BluetoothGATTService</a></code> represents a GATT <a data-link-type="dfn" href="#service">Service</a>,
          a collection of characteristics and relationships to other services
          that encapsulate the behavior of part of a device. </p>
<pre class="idl">interface <a class="idl-code" data-link-type="interface" href="#bluetoothgattservice0">BluetoothGATTService</a> {
  readonly attribute <a data-link-type="idl-name" href="#bluetoothdevice0">BluetoothDevice</a> <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="BluetoothDevice " href="#dom-bluetoothgattservice-device">device</a>;
  readonly attribute <a data-link-type="idl-name" href="#typedefdef-uuid">UUID</a> <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="UUID " href="#dom-bluetoothgattservice-uuid">uuid</a>;
  readonly attribute boolean <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="boolean " href="#dom-bluetoothgattservice-isprimary">isPrimary</a>;
  Promise&lt;<a data-link-type="idl-name" href="#bluetoothgattcharacteristic0">BluetoothGATTCharacteristic</a>>
    <a class="idl-code" data-link-type="method" href="#dom-bluetoothgattservice-getcharacteristic">getCharacteristic</a>(<a data-link-type="idl-name" href="#typedefdef-bluetoothcharacteristicuuid">BluetoothCharacteristicUUID</a> <dfn class="idl-code" data-dfn-for="BluetoothGATTService/getCharacteristic(characteristic)" data-dfn-type="argument" data-export="" id="dom-bluetoothgattservice-getcharacteristic-characteristic-characteristic">characteristic<a class="self-link" href="#dom-bluetoothgattservice-getcharacteristic-characteristic-characteristic"></a></dfn>);
  Promise&lt;sequence&lt;<a data-link-type="idl-name" href="#bluetoothgattcharacteristic0">BluetoothGATTCharacteristic</a>>>
    <a class="idl-code" data-link-type="method" href="#dom-bluetoothgattservice-getcharacteristics">getCharacteristics</a>(optional <a data-link-type="idl-name" href="#typedefdef-bluetoothcharacteristicuuid">BluetoothCharacteristicUUID</a> <dfn class="idl-code" data-dfn-for="BluetoothGATTService/getCharacteristics(characteristic), BluetoothGATTService/getCharacteristics()" data-dfn-type="argument" data-export="" id="dom-bluetoothgattservice-getcharacteristics-characteristic-characteristic">characteristic<a class="self-link" href="#dom-bluetoothgattservice-getcharacteristics-characteristic-characteristic"></a></dfn>);
  Promise&lt;<a data-link-type="idl-name" href="#bluetoothgattservice0">BluetoothGATTService</a>>
    <a class="idl-code" data-link-type="method" href="#dom-bluetoothgattservice-getincludedservice">getIncludedService</a>(<a data-link-type="idl-name" href="#typedefdef-bluetoothserviceuuid">BluetoothServiceUUID</a> <dfn class="idl-code" data-dfn-for="BluetoothGATTService/getIncludedService(service)" data-dfn-type="argument" data-export="" id="dom-bluetoothgattservice-getincludedservice-service-service">service<a class="self-link" href="#dom-bluetoothgattservice-getincludedservice-service-service"></a></dfn>);
  Promise&lt;sequence&lt;<a data-link-type="idl-name" href="#bluetoothgattservice0">BluetoothGATTService</a>>>
    <a class="idl-code" data-link-type="method" href="#dom-bluetoothgattservice-getincludedservices">getIncludedServices</a>(optional <a data-link-type="idl-name" href="#typedefdef-bluetoothserviceuuid">BluetoothServiceUUID</a> <dfn class="idl-code" data-dfn-for="BluetoothGATTService/getIncludedServices(service), BluetoothGATTService/getIncludedServices()" data-dfn-type="argument" data-export="" id="dom-bluetoothgattservice-getincludedservices-service-service">service<a class="self-link" href="#dom-bluetoothgattservice-getincludedservices-service-service"></a></dfn>);
};
<a data-link-type="idl-name" href="#bluetoothgattservice0">BluetoothGATTService</a> implements <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#eventtarget">EventTarget</a>;
<a data-link-type="idl-name" href="#bluetoothgattservice0">BluetoothGATTService</a> implements <a data-link-type="idl-name" href="#characteristiceventhandlers">CharacteristicEventHandlers</a>;
<a data-link-type="idl-name" href="#bluetoothgattservice0">BluetoothGATTService</a> implements <a data-link-type="idl-name" href="#serviceeventhandlers">ServiceEventHandlers</a>;
</pre>
     <div class="note no-marker" role="note">
      <div class="marker">NOTE: BluetoothGATTService attributes</div>
      <p> <dfn class="idl-code" data-dfn-for="BluetoothGATTService" data-dfn-type="attribute" data-export="" id="dom-bluetoothgattservice-device">device<a class="self-link" href="#dom-bluetoothgattservice-device"></a></dfn> is the <code class="idl"><a data-link-type="idl" href="#bluetoothdevice0">BluetoothDevice</a></code> representing
            the remote peripheral that the GATT service belongs to. </p>
      <p> <dfn class="idl-code" data-dfn-for="BluetoothGATTService" data-dfn-type="attribute" data-export="" id="dom-bluetoothgattservice-uuid">uuid<a class="self-link" href="#dom-bluetoothgattservice-uuid"></a></dfn> is the UUID of the service,
            e.g. <code>'0000180d-0000-1000-8000-00805f9b34fb'</code> for the <a data-link-type="idl" href="https://developer.bluetooth.org/gatt/services/Pages/ServiceViewer.aspx?u=org.bluetooth.service.heart_rate.xml#">Heart Rate</a> service. </p>
      <p> <dfn class="idl-code" data-dfn-for="BluetoothGATTService" data-dfn-type="attribute" data-export="" id="dom-bluetoothgattservice-isprimary">isPrimary<a class="self-link" href="#dom-bluetoothgattservice-isprimary"></a></dfn> indicates whether the type of this service is primary or secondary. </p>
     </div>
     <p> To <dfn data-dfn-type="dfn" data-noexport="" id="create-a-bluetoothgattservice-representing">create a <code>BluetoothGATTService</code> representing<a class="self-link" href="#create-a-bluetoothgattservice-representing"></a></dfn> a Service <var>service</var>,
          the UA must return <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#a-new-promise">a new promise</a> <var>promise</var> and run the following steps <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">in parallel</a>. </p>
     <ol>
      <li>Let <var>result</var> be a new instance of <code class="idl"><a data-link-type="idl" href="#bluetoothgattservice0">BluetoothGATTService</a></code>.
      <li> <a data-link-type="dfn" href="#get-the-bluetoothdevice-representing">Get the <code>BluetoothDevice</code> representing</a> the device in which <var>service</var> appears,
            and let <var>devicePromise</var> be the result. 
      <li>Wait for <var>devicePromise</var> to settle.
      <li> If <var>devicePromise</var> rejected, <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#resolve-promise">resolve</a> <var>promise</var> with <var>devicePromise</var> and abort these steps. 
      <li> Initialize <code><var>result</var>.device</code> from
            the value of <var>devicePromise</var>. 
      <li> Initialize <code><var>result</var>.uuid</code> from the UUID of <var>service</var>. 
      <li> If <var>service</var> is a Primary Service,
            initialize <code><var>result</var>.isPrimary</code> to true.
            Otherwise initialize <code><var>result</var>.isPrimary</code> to false. 
      <li><a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#resolve-promise">Resolve</a> <var>promise</var> with <var>result</var>.
     </ol>
     <p> The <code><dfn class="idl-code" data-dfn-for="BluetoothGATTService" data-dfn-type="method" data-export="" id="dom-bluetoothgattservice-getcharacteristic">getCharacteristic(<var>characteristic</var>)<a class="self-link" href="#dom-bluetoothgattservice-getcharacteristic"></a></dfn></code> method
          retrieves a <a data-link-type="dfn" href="#characteristic">Characteristic</a> inside this Service.
          When invoked, it MUST return </p>
     <blockquote> <a data-link-type="dfn" href="#getgattchildren">GetGATTChildren</a>(<span class="argument-list"><var>attribute</var>=<code>this</code>,<br> <var>single</var>=true,<br> <var>uuidCanonicalizer</var>=<code class="idl"><a data-link-type="idl" href="#dom-bluetoothuuid-getcharacteristic">BluetoothUUID.getCharacteristic</a></code>,<br> <var>uuid</var>=<code><var>characteristic</var></code>,<br> <var>child type</var>="GATT Characteristic")</span> </blockquote>
     <p> The <code><dfn class="idl-code" data-dfn-for="BluetoothGATTService" data-dfn-type="method" data-export="" id="dom-bluetoothgattservice-getcharacteristics">getCharacteristics(<var>characteristic</var>)<a class="self-link" href="#dom-bluetoothgattservice-getcharacteristics"></a></dfn></code> method
          retrieves a list of <a data-link-type="dfn" href="#characteristic">Characteristic</a>s inside this Service.
          When invoked, it MUST return </p>
     <blockquote> <a data-link-type="dfn" href="#getgattchildren">GetGATTChildren</a>(<span class="argument-list"><var>attribute</var>=<code>this</code>,<br> <var>single</var>=false,<br> <var>uuidCanonicalizer</var>=<code class="idl"><a data-link-type="idl" href="#dom-bluetoothuuid-getcharacteristic">BluetoothUUID.getCharacteristic</a></code>,<br> <var>uuid</var>=<code><var>characteristic</var></code>,<br> <var>child type</var>="GATT Characteristic")</span> </blockquote>
     <p> The <code><dfn class="idl-code" data-dfn-for="BluetoothGATTService" data-dfn-type="method" data-export="" id="dom-bluetoothgattservice-getincludedservice">getIncludedService(<var>service</var>)<a class="self-link" href="#dom-bluetoothgattservice-getincludedservice"></a></dfn></code> method
          retrieves an <a data-link-type="dfn" href="#included-service">Included Service</a> inside this Service.
          When invoked, it MUST return </p>
     <blockquote> <a data-link-type="dfn" href="#getgattchildren">GetGATTChildren</a>(<span class="argument-list"><var>attribute</var>=<code>this</code>,<br> <var>single</var>=true,<br> <var>uuidCanonicalizer</var>=<code class="idl"><a data-link-type="idl" href="#dom-bluetoothuuid-getservice">BluetoothUUID.getService</a></code>,<br> <var>uuid</var>=<code><var>service</var></code>,<br> <var>child type</var>="GATT Included Service")</span> </blockquote>
     <p> The <code><dfn class="idl-code" data-dfn-for="BluetoothGATTService" data-dfn-type="method" data-export="" id="dom-bluetoothgattservice-getincludedservices">getIncludedServices(<var>service</var>)<a class="self-link" href="#dom-bluetoothgattservice-getincludedservices"></a></dfn></code> method
          retrieves a list of <a data-link-type="dfn" href="#included-service">Included Service</a>s inside this Service.
          When invoked, it MUST return </p>
     <blockquote> <a data-link-type="dfn" href="#getgattchildren">GetGATTChildren</a>(<span class="argument-list"><var>attribute</var>=<code>this</code>,<br> <var>single</var>=false,<br> <var>uuidCanonicalizer</var>=<code class="idl"><a data-link-type="idl" href="#dom-bluetoothuuid-getservice">BluetoothUUID.getService</a></code>,<br> <var>uuid</var>=<code><var>service</var></code>,<br> <var>child type</var>="GATT Included Service")</span> </blockquote>
    </section>
    <section>
     <h3 class="heading settled" data-level="5.4" id="bluetoothgattcharacteristic"><span class="secno">5.4. </span><span class="content"><dfn class="idl-code" data-dfn-type="interface" data-export="" id="bluetoothgattcharacteristic0">BluetoothGATTCharacteristic<a class="self-link" href="#bluetoothgattcharacteristic0"></a></dfn></span><a class="self-link" href="#bluetoothgattcharacteristic"></a></h3>
     <p><code class="idl"><a data-link-type="idl" href="#bluetoothgattcharacteristic0">BluetoothGATTCharacteristic</a></code> represents a GATT <a data-link-type="dfn" href="#characteristic">Characteristic</a>, which is a basic data element that provides further information about a peripheral’s service.</p>
<pre class="idl">interface <a class="idl-code" data-link-type="interface" href="#bluetoothgattcharacteristic0">BluetoothGATTCharacteristic</a> {
  readonly attribute <a data-link-type="idl-name" href="#bluetoothgattservice0">BluetoothGATTService</a> <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="BluetoothGATTService " href="#dom-bluetoothgattcharacteristic-service">service</a>;
  readonly attribute <a data-link-type="idl-name" href="#typedefdef-uuid">UUID</a> <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="UUID " href="#dom-bluetoothgattcharacteristic-uuid">uuid</a>;
  readonly attribute <a data-link-type="idl-name" href="#bluetoothcharacteristicproperties">BluetoothCharacteristicProperties</a> <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="BluetoothCharacteristicProperties " href="#dom-bluetoothgattcharacteristic-properties">properties</a>;
  readonly attribute ArrayBuffer? <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="ArrayBuffer? " href="#dom-bluetoothgattcharacteristic-value">value</a>;
  Promise&lt;<a data-link-type="idl-name" href="#bluetoothgattdescriptor0">BluetoothGATTDescriptor</a>> <a class="idl-code" data-link-type="method" href="#dom-bluetoothgattcharacteristic-getdescriptor">getDescriptor</a>(<a data-link-type="idl-name" href="#typedefdef-bluetoothdescriptoruuid">BluetoothDescriptorUUID</a> <dfn class="idl-code" data-dfn-for="BluetoothGATTCharacteristic/getDescriptor(descriptor)" data-dfn-type="argument" data-export="" id="dom-bluetoothgattcharacteristic-getdescriptor-descriptor-descriptor">descriptor<a class="self-link" href="#dom-bluetoothgattcharacteristic-getdescriptor-descriptor-descriptor"></a></dfn>);
  Promise&lt;sequence&lt;<a data-link-type="idl-name" href="#bluetoothgattdescriptor0">BluetoothGATTDescriptor</a>>>
    <a class="idl-code" data-link-type="method" href="#dom-bluetoothgattcharacteristic-getdescriptors">getDescriptors</a>(optional <a data-link-type="idl-name" href="#typedefdef-bluetoothdescriptoruuid">BluetoothDescriptorUUID</a> <dfn class="idl-code" data-dfn-for="BluetoothGATTCharacteristic/getDescriptors(descriptor), BluetoothGATTCharacteristic/getDescriptors()" data-dfn-type="argument" data-export="" id="dom-bluetoothgattcharacteristic-getdescriptors-descriptor-descriptor">descriptor<a class="self-link" href="#dom-bluetoothgattcharacteristic-getdescriptors-descriptor-descriptor"></a></dfn>);
  Promise&lt;ArrayBuffer> <a class="idl-code" data-link-type="method" href="#dom-bluetoothgattcharacteristic-readvalue">readValue</a>();
  Promise&lt;void> <a class="idl-code" data-link-type="method" href="#dom-bluetoothgattcharacteristic-writevalue">writeValue</a>(<a data-link-type="idl-name" href="https://heycam.github.io/webidl/#common-BufferSource">BufferSource</a> <dfn class="idl-code" data-dfn-for="BluetoothGATTCharacteristic/writeValue(value)" data-dfn-type="argument" data-export="" id="dom-bluetoothgattcharacteristic-writevalue-value-value">value<a class="self-link" href="#dom-bluetoothgattcharacteristic-writevalue-value-value"></a></dfn>);
  Promise&lt;void> <a class="idl-code" data-link-type="method" href="#dom-bluetoothgattcharacteristic-startnotifications">startNotifications</a>();
  Promise&lt;void> <a class="idl-code" data-link-type="method" href="#dom-bluetoothgattcharacteristic-stopnotifications">stopNotifications</a>();
};
<a data-link-type="idl-name" href="#bluetoothgattcharacteristic0">BluetoothGATTCharacteristic</a> implements <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#eventtarget">EventTarget</a>;
<a data-link-type="idl-name" href="#bluetoothgattcharacteristic0">BluetoothGATTCharacteristic</a> implements <a data-link-type="idl-name" href="#characteristiceventhandlers">CharacteristicEventHandlers</a>;
</pre>
     <div class="note no-marker" role="note">
      <div class="marker">NOTE: BluetoothGATTCharacteristic attributes</div>
      <p> <dfn class="idl-code" data-dfn-for="BluetoothGATTCharacteristic" data-dfn-type="attribute" data-export="" id="dom-bluetoothgattcharacteristic-service">service<a class="self-link" href="#dom-bluetoothgattcharacteristic-service"></a></dfn> is the GATT service this characteristic belongs to. </p>
      <p> <dfn class="idl-code" data-dfn-for="BluetoothGATTCharacteristic" data-dfn-type="attribute" data-export="" id="dom-bluetoothgattcharacteristic-uuid">uuid<a class="self-link" href="#dom-bluetoothgattcharacteristic-uuid"></a></dfn> is the UUID of the characteristic,
            e.g. <code>'00002a37-0000-1000-8000-00805f9b34fb'</code> for the <a data-link-type="idl" href="https://developer.bluetooth.org/gatt/characteristics/Pages/CharacteristicViewer.aspx?u=org.bluetooth.characteristic.heart_rate_measurement.xml#">Heart Rate Measurement</a> characteristic. </p>
      <p> <dfn class="idl-code" data-dfn-for="BluetoothGATTCharacteristic" data-dfn-type="attribute" data-export="" id="dom-bluetoothgattcharacteristic-properties">properties<a class="self-link" href="#dom-bluetoothgattcharacteristic-properties"></a></dfn> holds the properties of this characteristic. </p>
      <p> <dfn class="idl-code" data-dfn-for="BluetoothGATTCharacteristic" data-dfn-type="attribute" data-export="" id="dom-bluetoothgattcharacteristic-value">value<a class="self-link" href="#dom-bluetoothgattcharacteristic-value"></a></dfn> is the currently cached characteristic value.
            This value gets updated when the value of the characteristic is read or updated via a notification or indication. </p>
     </div>
     <p> To <dfn data-dfn-type="dfn" data-noexport="" id="create-a-bluetoothgattcharacteristic-representing">create a <code>BluetoothGATTCharacteristic</code> representing<a class="self-link" href="#create-a-bluetoothgattcharacteristic-representing"></a></dfn> a Characteristic <var>characteristic</var>,
          the UA must return <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#a-new-promise">a new promise</a> <var>promise</var> and run the following steps <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">in parallel</a>. </p>
     <ol>
      <li>Let <var>result</var> be a new instance of <code class="idl"><a data-link-type="idl" href="#bluetoothgattcharacteristic0">BluetoothGATTCharacteristic</a></code>.
      <li> Initialize <code><var>result</var>.service</code> from
            the <code class="idl"><a data-link-type="idl" href="#bluetoothgattservice0">BluetoothGATTService</a></code> instance representing
            the Service in which <var>characteristic</var> appears. 
      <li> Initialize <code><var>result</var>.uuid</code> from
            the UUID of <var>characteristic</var>. 
      <li> <a data-link-type="dfn" href="#create-a-bluetoothcharacteristicproperties-instance-from-the-characteristic">Create a <code>BluetoothCharacteristicProperties</code> instance
            from the Characteristic</a> <var>characteristic</var>,
            and let <var>propertiesPromise</var> be the result. 
      <li>Wait for <var>propertiesPromise</var> to settle.
      <li> If <var>propertiesPromise</var> was rejected, <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#resolve-promise">resolve</a> <var>promise</var> with <var>propertiesPromise</var> and
            abort these steps. 
      <li> Initialize <code><var>result</var>.properties</code> from
            the value <var>propertiesPromise</var> was fulfilled with. 
      <li> Initialize <code><var>result</var>.value</code> to <code>null</code>.
            The UA MAY initialize <code><var>result</var>.value</code> to
            a new <code>ArrayBuffer</code> containing
            the most recently read value from <var>characteristic</var> if this value is available. 
      <li><a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#resolve-promise">Resolve</a> <var>promise</var> with <var>result</var>.
     </ol>
     <p> The <code><dfn class="idl-code" data-dfn-for="BluetoothGATTCharacteristic" data-dfn-type="method" data-export="" id="dom-bluetoothgattcharacteristic-getdescriptor">getDescriptor(<var>descriptor</var>)<a class="self-link" href="#dom-bluetoothgattcharacteristic-getdescriptor"></a></dfn></code> method
          retrieves a <a data-link-type="dfn" href="#descriptor">Descriptor</a> inside this Characteristic.
          When invoked, it MUST return </p>
     <blockquote> <a data-link-type="dfn" href="#getgattchildren">GetGATTChildren</a>(<span class="argument-list"><var>attribute</var>=<code>this</code>,<br> <var>single</var>=true,<br> <var>uuidCanonicalizer</var>=<code class="idl"><a data-link-type="idl" href="#dom-bluetoothuuid-getdescriptor">BluetoothUUID.getDescriptor</a></code>,<br> <var>uuid</var>=<code><var>descriptor</var></code>,<br> <var>child type</var>="GATT Descriptor")</span> </blockquote>
     <p> The <code><dfn class="idl-code" data-dfn-for="BluetoothGATTCharacteristic" data-dfn-type="method" data-export="" id="dom-bluetoothgattcharacteristic-getdescriptors">getDescriptors(<var>descriptor</var>)<a class="self-link" href="#dom-bluetoothgattcharacteristic-getdescriptors"></a></dfn></code> method
          retrieves a list of <a data-link-type="dfn" href="#descriptor">Descriptor</a>s inside this Characteristic.
          When invoked, it MUST return </p>
     <blockquote> <a data-link-type="dfn" href="#getgattchildren">GetGATTChildren</a>(<span class="argument-list"><var>attribute</var>=<code>this</code>,<br> <var>single</var>=false,<br> <var>uuidCanonicalizer</var>=<code class="idl"><a data-link-type="idl" href="#dom-bluetoothuuid-getdescriptor">BluetoothUUID.getDescriptor</a></code>,<br> <var>uuid</var>=<code><var>descriptor</var></code>,<br> <var>child type</var>="GATT Descriptor")</span> </blockquote>
     <p> The <code><dfn class="idl-code" data-dfn-for="BluetoothGATTCharacteristic" data-dfn-type="method" data-export="" id="dom-bluetoothgattcharacteristic-readvalue">readValue()<a class="self-link" href="#dom-bluetoothgattcharacteristic-readvalue"></a></dfn></code> method, when invoked,
          MUST return <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#a-new-promise">a new promise</a> <var>promise</var> and run the following steps <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">in parallel</a>: </p>
     <ol>
      <li> If <code>this.uuid</code> is <a data-link-type="dfn" href="#blacklisted-for-reads">blacklisted for reads</a>,
            return <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#a-promise-rejected-with">a promise rejected with</a> a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#securityerror">SecurityError</a></code> and abort these steps. 
      <li> Let <var>characteristic</var> be the <a data-link-type="dfn" href="#characteristic">Characteristic</a> that <code>this</code> represents. 
      <li> If the <code>Read</code> bit is not set
            in <var>characteristic</var>’s <a data-link-type="dfn" href="#characteristic-properties">properties</a>, <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#reject-promise">reject</a> <var>promise</var> with a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#notsupportederror">NotSupportedError</a></code> and abort these steps. 
      <li> Use any combination of the sub-procedures in
            the <a data-link-type="dfn" href="#characteristic-value-read">Characteristic Value Read</a> procedure
            to retrieve the value of <var>characteristic</var>.
            Handle errors as described in <a href="#error-handling">§5.7 Error handling</a>. 
      <li> If the previous step returned an error, <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#reject-promise">reject</a> <var>promise</var> with that error and abort these steps. 
      <li>
        <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">Queue a task</a> to perform the following steps: 
       <ol>
        <li> Create an <code>ArrayBuffer</code> holding the retrieved value,
                and assign it to <code>this.value</code>. 
        <li> <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#resolve-promise">Resolve</a> <var>promise</var> with <code>this.value</code>. 
        <li> <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-fire">Fire an event</a> named <code class="idl"><a data-link-type="idl" href="#dom-bluetoothgattcharacteristic-characteristicvaluechanged">characteristicvaluechanged</a></code> with its <code>bubbles</code> attribute initialized to <code>true</code> at <code>this</code>. 
       </ol>
     </ol>
     <p> The <code><dfn class="idl-code" data-dfn-for="BluetoothGATTCharacteristic" data-dfn-type="method" data-export="" id="dom-bluetoothgattcharacteristic-writevalue">writeValue(<var>value</var>)<a class="self-link" href="#dom-bluetoothgattcharacteristic-writevalue"></a></dfn></code> method, when invoked,
          MUST run the following steps: </p>
     <ol>
      <li> If <code>this.uuid</code> is <a data-link-type="dfn" href="#blacklisted-for-writes">blacklisted for writes</a>,
            return <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#a-promise-rejected-with">a promise rejected with</a> a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#securityerror">SecurityError</a></code> and abort these steps. 
      <li> Let <var>characteristic</var> be the <a data-link-type="dfn" href="#characteristic">Characteristic</a> that <code>this</code> represents. 
      <li> Let <var>bytes</var> be <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-get-buffer-source-copy">a copy of the bytes held</a> by <code><var>value</var></code>. 
      <li> If <var>bytes</var> is more than 512 bytes long
            (the maximum length of an attribute value, per <a data-link-type="dfn" href="#long-attribute-values">Long Attribute Values</a>)
            return <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#a-promise-rejected-with">a promise rejected with</a> an <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#invalidmodificationerror">InvalidModificationError</a></code> and abort these steps. 
      <li>
       Return <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#a-new-promise">a new promise</a> <var>promise</var> and run the following steps in parallel. 
       <ol>
        <li> Use any combination of the sub-procedures in
                the <a data-link-type="dfn" href="#characteristic-value-write">Characteristic Value Write</a> procedure
                to write <var>bytes</var> to <var>characteristic</var>.
                Handle errors as described in <a href="#error-handling">§5.7 Error handling</a>. 
        <li> If the previous step returned an error, <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#reject-promise">reject</a> <var>promise</var> with that error and abort these steps. 
        <li>
          <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">Queue a task</a> to perform the following steps: 
         <ol>
          <li> Set <code>this.value</code> to
                    a new <code class="idl"><a data-link-type="idl" href="http://ecma-international.org/ecma-262/6.0/#sec-arraybuffer-constructor">ArrayBuffer</a></code> containing <var>bytes</var>. 
          <li> <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#resolve-promise">Resolve</a> <var>promise</var> with <code>undefined</code>. 
         </ol>
       </ol>
     </ol>
     <p> The UA MUST maintain a map from each known GATT <a data-link-type="dfn" href="#characteristic">Characteristic</a> to
          a set of <code class="idl"><a data-link-type="idl" href="#bluetooth">Bluetooth</a></code> objects known as
          the characteristic’s <dfn data-dfn-type="dfn" data-noexport="" id="active-notification-context-set">active notification context set<a class="self-link" href="#active-notification-context-set"></a></dfn>. <span class="note" role="note"> The set for a given characteristic holds
            the <code class="idl"><a data-link-type="idl" href="#dom-navigator-bluetooth">navigator.bluetooth</a></code> objects for
            each <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#script-execution-environment">script execution environment</a> that has registered for notifications. </span> </p>
     <p> The <code><dfn class="idl-code" data-dfn-for="BluetoothGATTCharacteristic" data-dfn-type="method" data-export="" id="dom-bluetoothgattcharacteristic-startnotifications">startNotifications()<a class="self-link" href="#dom-bluetoothgattcharacteristic-startnotifications"></a></dfn></code> method, when invoked,
          MUST return <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#a-new-promise">a new promise</a> <var>promise</var> and run the following steps <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">in parallel</a>.
          See <a href="#notification-events">§5.6.3 Responding to Notifications and Indications</a> for details of receiving notifications. </p>
     <ol>
      <li> If <code>this.uuid</code> is <a data-link-type="dfn" href="#blacklisted-for-reads">blacklisted for reads</a>, <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#reject-promise">reject</a> <var>promise</var> with a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#securityerror">SecurityError</a></code> and abort these steps. 
      <li> Let <var>characteristic</var> be
            the GATT <a data-link-type="dfn" href="#characteristic">Characteristic</a> that <code>this</code> represents. 
      <li> If neither of the <code>Notify</code> or <code>Indicate</code> bits are set
            in <var>characteristic</var>’s <a data-link-type="dfn" href="#characteristic-properties">properties</a>, <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#reject-promise">reject</a> <var>promise</var> with a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#notsupportederror">NotSupportedError</a></code> and abort these steps. 
      <li> If <var>characteristic</var>’s <a data-link-type="dfn" href="#active-notification-context-set">active notification context set</a> contains <code class="idl"><a data-link-type="idl" href="#dom-navigator-bluetooth">navigator.bluetooth</a></code>, <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#resolve-promise">resolve</a> <var>promise</var> with <code>undefined</code> and abort these steps. 
      <li> Use any of the <a data-link-type="dfn" href="#characteristic-descriptors">Characteristic Descriptors</a> procedures
            to ensure that one of the <code>Notification</code> or <code>Indication</code> bits in <var>characteristic</var>’s <a data-link-type="dfn" href="#client-characteristic-configuration">Client Characteristic Configuration</a> descriptor
            is set, matching the constraints
            in <var>characteristic</var>’s <a data-link-type="dfn" href="#characteristic-properties">properties</a>.
            The UA SHOULD avoid setting both bits,
            and MUST deduplicate <a href="#notification-events">value-change events</a> if both bits are set.
            Handle errors as described in <a href="#error-handling">§5.7 Error handling</a>. 
      <li> If the previous step returned an error, <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#reject-promise">reject</a> <var>promise</var> with that error and abort these steps. 
      <li> Add <code class="idl"><a data-link-type="idl" href="#dom-navigator-bluetooth">navigator.bluetooth</a></code> to <var>characteristic</var>’s <a data-link-type="dfn" href="#active-notification-context-set">active notification context set</a>. 
      <li> <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#resolve-promise">Resolve</a> <var>promise</var> with <code>undefined</code>. 
     </ol>
     <p class="note" role="note"> After notifications are enabled,
          the resulting <a href="#notification-events">value-change events</a> won’t be delivered
          until after the current <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#perform-a-microtask-checkpoint">microtask checkpoint</a>.
          This allows a developer to set up handlers
          in the <code>.then</code> handler of the result promise. </p>
     <p> The <code><dfn class="idl-code" data-dfn-for="BluetoothGATTCharacteristic" data-dfn-type="method" data-export="" id="dom-bluetoothgattcharacteristic-stopnotifications">stopNotifications()<a class="self-link" href="#dom-bluetoothgattcharacteristic-stopnotifications"></a></dfn></code> method, when invoked,
          MUST return <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#a-new-promise">a new promise</a> <var>promise</var> and run the following steps <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">in parallel</a>: </p>
     <ol>
      <li> Let <var>characteristic</var> be
            the GATT <a data-link-type="dfn" href="#characteristic">Characteristic</a> that <code>this</code> represents. 
      <li> If <var>characteristic</var>’s <a data-link-type="dfn" href="#active-notification-context-set">active notification context set</a> contains <code class="idl"><a data-link-type="idl" href="#dom-navigator-bluetooth">navigator.bluetooth</a></code>,
            remove it. 
      <li> If <var>characteristic</var>’s <a data-link-type="dfn" href="#active-notification-context-set">active notification context set</a> became empty,
            the UA SHOULD use any of the <a data-link-type="dfn" href="#characteristic-descriptors">Characteristic Descriptors</a> procedures
            to clear the <code>Notification</code> and <code>Indication</code> bits in <var>characteristic</var>’s <a data-link-type="dfn" href="#client-characteristic-configuration">Client Characteristic Configuration</a> descriptor. 
      <li> <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">Queue a task</a> to <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#resolve-promise">resolve</a> <var>promise</var> with <code>undefined</code>. 
     </ol>
     <p class="note" role="note"> Queuing a task to resolve the promise ensures that
          no <a href="#notification-events">value change events</a> due to notifications
          arrive after the promise resolves. </p>
     <section>
      <h4 class="heading settled" data-level="5.4.1" id="characteristicproperties"><span class="secno">5.4.1. </span><span class="content"><dfn class="idl-code" data-dfn-type="interface" data-export="" id="bluetoothcharacteristicproperties">BluetoothCharacteristicProperties<a class="self-link" href="#bluetoothcharacteristicproperties"></a></dfn></span><a class="self-link" href="#characteristicproperties"></a></h4>
      <p> Each <code class="idl"><a data-link-type="idl" href="#bluetoothgattcharacteristic0">BluetoothGATTCharacteristic</a></code> exposes its <a data-link-type="dfn" href="#characteristic-properties">characteristic properties</a> through a <code class="idl"><a data-link-type="idl" href="#bluetoothcharacteristicproperties">BluetoothCharacteristicProperties</a></code> object.
            These properties express what operations are valid on the characteristic. </p>
<pre class="idl">interface <a class="idl-code" data-link-type="interface" href="#bluetoothcharacteristicproperties">BluetoothCharacteristicProperties</a> {
  readonly attribute boolean <dfn class="idl-code" data-dfn-for="BluetoothCharacteristicProperties" data-dfn-type="attribute" data-export="" data-readonly="" data-type="boolean " id="dom-bluetoothcharacteristicproperties-broadcast">broadcast<a class="self-link" href="#dom-bluetoothcharacteristicproperties-broadcast"></a></dfn>;
  readonly attribute boolean <dfn class="idl-code" data-dfn-for="BluetoothCharacteristicProperties" data-dfn-type="attribute" data-export="" data-readonly="" data-type="boolean " id="dom-bluetoothcharacteristicproperties-read">read<a class="self-link" href="#dom-bluetoothcharacteristicproperties-read"></a></dfn>;
  readonly attribute boolean <dfn class="idl-code" data-dfn-for="BluetoothCharacteristicProperties" data-dfn-type="attribute" data-export="" data-readonly="" data-type="boolean " id="dom-bluetoothcharacteristicproperties-writewithoutresponse">writeWithoutResponse<a class="self-link" href="#dom-bluetoothcharacteristicproperties-writewithoutresponse"></a></dfn>;
  readonly attribute boolean <dfn class="idl-code" data-dfn-for="BluetoothCharacteristicProperties" data-dfn-type="attribute" data-export="" data-readonly="" data-type="boolean " id="dom-bluetoothcharacteristicproperties-write">write<a class="self-link" href="#dom-bluetoothcharacteristicproperties-write"></a></dfn>;
  readonly attribute boolean <dfn class="idl-code" data-dfn-for="BluetoothCharacteristicProperties" data-dfn-type="attribute" data-export="" data-readonly="" data-type="boolean " id="dom-bluetoothcharacteristicproperties-notify">notify<a class="self-link" href="#dom-bluetoothcharacteristicproperties-notify"></a></dfn>;
  readonly attribute boolean <dfn class="idl-code" data-dfn-for="BluetoothCharacteristicProperties" data-dfn-type="attribute" data-export="" data-readonly="" data-type="boolean " id="dom-bluetoothcharacteristicproperties-indicate">indicate<a class="self-link" href="#dom-bluetoothcharacteristicproperties-indicate"></a></dfn>;
  readonly attribute boolean <dfn class="idl-code" data-dfn-for="BluetoothCharacteristicProperties" data-dfn-type="attribute" data-export="" data-readonly="" data-type="boolean " id="dom-bluetoothcharacteristicproperties-authenticatedsignedwrites">authenticatedSignedWrites<a class="self-link" href="#dom-bluetoothcharacteristicproperties-authenticatedsignedwrites"></a></dfn>;
  readonly attribute boolean <dfn class="idl-code" data-dfn-for="BluetoothCharacteristicProperties" data-dfn-type="attribute" data-export="" data-readonly="" data-type="boolean " id="dom-bluetoothcharacteristicproperties-reliablewrite">reliableWrite<a class="self-link" href="#dom-bluetoothcharacteristicproperties-reliablewrite"></a></dfn>;
  readonly attribute boolean <dfn class="idl-code" data-dfn-for="BluetoothCharacteristicProperties" data-dfn-type="attribute" data-export="" data-readonly="" data-type="boolean " id="dom-bluetoothcharacteristicproperties-writableauxiliaries">writableAuxiliaries<a class="self-link" href="#dom-bluetoothcharacteristicproperties-writableauxiliaries"></a></dfn>;
};
</pre>
      <p> To <dfn data-dfn-type="dfn" data-noexport="" id="create-a-bluetoothcharacteristicproperties-instance-from-the-characteristic">create a <code>BluetoothCharacteristicProperties</code> instance
            from the Characteristic<a class="self-link" href="#create-a-bluetoothcharacteristicproperties-instance-from-the-characteristic"></a></dfn> <var>characteristic</var>,
            the UA MUST return <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#a-new-promise">a new promise</a> <var>promise</var> and run the following steps <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">in parallel</a>: </p>
      <ol>
       <li> Let <var>propertiesObj</var> be a new instance of <code class="idl"><a data-link-type="idl" href="#bluetoothcharacteristicproperties">BluetoothCharacteristicProperties</a></code>. 
       <li> Let <var>properties</var> be
              the <a data-link-type="dfn" href="#characteristic-properties">characteristic properties</a> of <var>characteristic</var>. 
       <li>
         Initialize the attributes of <var>propertiesObj</var> from
              the corresponding bits in <var>properties</var>: 
        <table>
         <tbody>
          <tr>
           <th>Attribute
           <th>Bit
          <tr>
           <td><code>broadcast</code>
           <td>Broadcast
          <tr>
           <td><code>read</code>
           <td>Read
          <tr>
           <td><code>writeWithoutResponse</code>
           <td>Write Without Response
          <tr>
           <td><code>write</code>
           <td>Write
          <tr>
           <td><code>notify</code>
           <td>Notify
          <tr>
           <td><code>indicate</code>
           <td>Indicate
          <tr>
           <td><code>authenticatedSignedWrites</code>
           <td>Authenticated Signed Writes
        </table>
       <li>
         If the Extended Properties bit of the <a data-link-type="dfn" href="#characteristic-properties">characteristic properties</a> is not set,
              initialize <code><var>propertiesObj</var>.reliableWrite</code> and <code><var>propertiesObj</var>.writableAuxiliaries</code> to <code>false</code>.
              Otherwise, run the following steps: 
        <ol>
         <li>
           <a data-link-type="dfn" href="#characteristic-descriptor-discovery">Discover</a> the <a data-link-type="dfn" href="#characteristic-extended-properties">Characteristic Extended Properties</a> descriptor for <var>characteristic</var> and <a data-link-type="dfn" href="#read-characteristic-descriptors">read its value</a> into <var>extendedProperties</var>.
                  Handle errors as described in <a href="#error-handling">§5.7 Error handling</a>. 
          <p class="issue" id="issue-25c55f53"><a class="self-link" href="#issue-25c55f53"></a> <a data-link-type="dfn" href="#characteristic-extended-properties">Characteristic Extended Properties</a> isn’t clear whether
                    the extended properties are immutable for a given Characteristic.
                    If they are, the UA should be allowed to cache them. </p>
         <li> If the previous step returned an error, <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#reject-promise">reject</a> <var>promise</var> with that error and abort these steps. 
         <li> Initialize <code><var>propertiesObj</var>.reliableWrite</code> from
                  the Reliable Write bit of <var>extendedProperties</var>. 
         <li> Initialize <code><var>propertiesObj</var>.writableAuxiliaries</code> from
                  the Writable Auxiliaries bit of <var>extendedProperties</var>. 
        </ol>
       <li> <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#resolve-promise">Resolve</a> <var>promise</var> with <var>propertiesObj</var>. 
      </ol>
     </section>
    </section>
    <section>
     <h3 class="heading settled" data-level="5.5" id="bluetoothgattdescriptor"><span class="secno">5.5. </span><span class="content"><dfn class="idl-code" data-dfn-type="interface" data-export="" id="bluetoothgattdescriptor0">BluetoothGATTDescriptor<a class="self-link" href="#bluetoothgattdescriptor0"></a></dfn></span><a class="self-link" href="#bluetoothgattdescriptor"></a></h3>
     <p><code class="idl"><a data-link-type="idl" href="#bluetoothgattdescriptor0">BluetoothGATTDescriptor</a></code> represents a GATT <a data-link-type="dfn" href="#descriptor">Descriptor</a>, which provides further information about a <a data-link-type="dfn" href="#characteristic">Characteristic</a>’s value.</p>
<pre class="idl">interface <a class="idl-code" data-link-type="interface" href="#bluetoothgattdescriptor0">BluetoothGATTDescriptor</a> {
  readonly attribute <a data-link-type="idl-name" href="#bluetoothgattcharacteristic0">BluetoothGATTCharacteristic</a> <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="BluetoothGATTCharacteristic " href="#dom-bluetoothgattdescriptor-characteristic">characteristic</a>;
  readonly attribute <a data-link-type="idl-name" href="#typedefdef-uuid">UUID</a> <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="UUID " href="#dom-bluetoothgattdescriptor-uuid">uuid</a>;
  readonly attribute ArrayBuffer? <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="ArrayBuffer? " href="#dom-bluetoothgattdescriptor-value">value</a>;
  Promise&lt;ArrayBuffer> <a class="idl-code" data-link-type="method" href="#dom-bluetoothgattdescriptor-readvalue">readValue</a>();
  Promise&lt;void> <a class="idl-code" data-link-type="method" href="#dom-bluetoothgattdescriptor-writevalue">writeValue</a>(<a data-link-type="idl-name" href="https://heycam.github.io/webidl/#common-BufferSource">BufferSource</a> <dfn class="idl-code" data-dfn-for="BluetoothGATTDescriptor/writeValue(value)" data-dfn-type="argument" data-export="" id="dom-bluetoothgattdescriptor-writevalue-value-value">value<a class="self-link" href="#dom-bluetoothgattdescriptor-writevalue-value-value"></a></dfn>);
};
</pre>
     <div class="note no-marker" role="note">
      <div class="marker">NOTE: BluetoothGATTDescriptor attributes</div>
      <p> <dfn class="idl-code" data-dfn-for="BluetoothGATTDescriptor" data-dfn-type="attribute" data-export="" id="dom-bluetoothgattdescriptor-characteristic">characteristic<a class="self-link" href="#dom-bluetoothgattdescriptor-characteristic"></a></dfn> is the GATT characteristic this descriptor belongs to. </p>
      <p> <dfn class="idl-code" data-dfn-for="BluetoothGATTDescriptor" data-dfn-type="attribute" data-export="" id="dom-bluetoothgattdescriptor-uuid">uuid<a class="self-link" href="#dom-bluetoothgattdescriptor-uuid"></a></dfn> is the UUID of the characteristic descriptor,
            e.g. <code>'00002902-0000-1000-8000-00805f9b34fb'</code> for the <a data-link-type="idl" href="https://developer.bluetooth.org/gatt/descriptors/Pages/DescriptorViewer.aspx?u=org.bluetooth.descriptor.gatt.client_characteristic_configuration.xml#">Client Characteristic Configuration</a> descriptor. </p>
      <p> <dfn class="idl-code" data-dfn-for="BluetoothGATTDescriptor" data-dfn-type="attribute" data-export="" id="dom-bluetoothgattdescriptor-value">value<a class="self-link" href="#dom-bluetoothgattdescriptor-value"></a></dfn> is the currently cached descriptor value.
            This value gets updated when the value of the descriptor is read. </p>
     </div>
     <p> To <dfn data-dfn-type="dfn" data-noexport="" id="create-a-bluetoothgattdescriptor-representing">create a <code>BluetoothGATTDescriptor</code> representing<a class="self-link" href="#create-a-bluetoothgattdescriptor-representing"></a></dfn> a Descriptor <var>descriptor</var>,
          the UA must return <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#a-new-promise">a new promise</a> <var>promise</var> and run the following steps <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">in parallel</a>. </p>
     <ol>
      <li>Let <var>result</var> be a new instance of <code class="idl"><a data-link-type="idl" href="#bluetoothgattdescriptor0">BluetoothGATTDescriptor</a></code>.
      <li> Initialize <code><var>result</var>.characteristic</code> from
            the <code class="idl"><a data-link-type="idl" href="#bluetoothgattcharacteristic0">BluetoothGATTCharacteristic</a></code> instance representing
            the Characteristic in which <var>descriptor</var> appears. 
      <li> Initialize <code><var>result</var>.uuid</code> from the UUID of <var>descriptor</var>. 
      <li> Initialize <code><var>result</var>.value</code> to <code>null</code>.
            The UA MAY initialize <code><var>result</var>.value</code> to
            a new <code>ArrayBuffer</code> containing
            the most recently read value from <var>descriptor</var> if this value is available. 
      <li><a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#resolve-promise">Resolve</a> <var>promise</var> with <var>result</var>.
     </ol>
     <p> The <code><dfn class="idl-code" data-dfn-for="BluetoothGATTDescriptor" data-dfn-type="method" data-export="" id="dom-bluetoothgattdescriptor-readvalue">readValue()<a class="self-link" href="#dom-bluetoothgattdescriptor-readvalue"></a></dfn></code> method, when invoked,
          MUST return <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#a-new-promise">a new promise</a> <var>promise</var> and run the following steps <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">in parallel</a>: </p>
     <ol>
      <li> If <code>this.uuid</code> is <a data-link-type="dfn" href="#blacklisted-for-reads">blacklisted for reads</a>,
            return <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#a-promise-rejected-with">a promise rejected with</a> a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#securityerror">SecurityError</a></code> and abort these steps. 
      <li> Let <var>descriptor</var> be the <a data-link-type="dfn" href="#descriptor">Descriptor</a> that <code>this</code> represents. 
      <li> Use either the <a data-link-type="dfn" href="#read-characteristic-descriptors">Read Characteristic Descriptors</a> or
            the <a data-link-type="dfn" href="#read-long-characteristic-descriptors">Read Long Characteristic Descriptors</a> sub-procedure
            to retrieve the value of <var>descriptor</var>.
            Handle errors as described in <a href="#error-handling">§5.7 Error handling</a>. 
      <li> If the previous step returned an error, <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#reject-promise">reject</a> <var>promise</var> with that error and abort these steps. 
      <li>
        <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">Queue a task</a> to perform the following steps: 
       <ol>
        <li> Create an <code>ArrayBuffer</code> holding the retrieved value,
                and assign it to <code>this.value</code>. 
        <li> <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#resolve-promise">Resolve</a> <var>promise</var> with <code>this.value</code>. 
       </ol>
     </ol>
     <p> The <code><dfn class="idl-code" data-dfn-for="BluetoothGATTDescriptor" data-dfn-type="method" data-export="" id="dom-bluetoothgattdescriptor-writevalue">writeValue(<var>value</var>)<a class="self-link" href="#dom-bluetoothgattdescriptor-writevalue"></a></dfn></code> method, when invoked,
          MUST  run the following steps: </p>
     <ol>
      <li> If <code>this.uuid</code> is <a data-link-type="dfn" href="#blacklisted-for-writes">blacklisted for writes</a>,
            return <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#a-promise-rejected-with">a promise rejected with</a> a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#securityerror">SecurityError</a></code> and abort these steps. 
      <li> Let <var>descriptor</var> be the <a data-link-type="dfn" href="#descriptor">Descriptor</a> that <code>this</code> represents. 
      <li> Let <var>bytes</var> be <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-get-buffer-source-copy">a copy of the bytes held</a> by <code><var>value</var></code>. 
      <li> If <var>bytes</var> is more than 512 bytes long
            (the maximum length of an attribute value, per <a data-link-type="dfn" href="#long-attribute-values">Long Attribute Values</a>)
            return <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#a-promise-rejected-with">a promise rejected with</a> an <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#invalidmodificationerror">InvalidModificationError</a></code> and abort these steps. 
      <li>
       Return <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#a-new-promise">a new promise</a> <var>promise</var> and run the following steps in parallel. 
       <ol>
        <li> Use either the <a data-link-type="dfn" href="#write-characteristic-descriptors">Write Characteristic Descriptors</a> or
                the <a data-link-type="dfn" href="#write-long-characteristic-descriptors">Write Long Characteristic Descriptors</a> sub-procedure
                to write <var>bytes</var> to <var>descriptor</var>.
                Handle errors as described in <a href="#error-handling">§5.7 Error handling</a>. 
        <li> If the previous step returned an error, <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#reject-promise">reject</a> <var>promise</var> with that error and abort these steps. 
        <li>
          <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">Queue a task</a> to perform the following steps: 
         <ol>
          <li> Set <code>this.value</code> to
                    a new <code class="idl"><a data-link-type="idl" href="http://ecma-international.org/ecma-262/6.0/#sec-arraybuffer-constructor">ArrayBuffer</a></code> containing <var>bytes</var>. 
          <li> <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#resolve-promise">Resolve</a> <var>promise</var> with <code>undefined</code>. 
         </ol>
       </ol>
     </ol>
    </section>
    <section>
     <h3 class="heading settled" data-level="5.6" id="events"><span class="secno">5.6. </span><span class="content">Events</span><a class="self-link" href="#events"></a></h3>
     <section>
      <h4 class="heading settled" data-level="5.6.1" id="bluetooth-tree"><span class="secno">5.6.1. </span><span class="content">Bluetooth Tree</span><a class="self-link" href="#bluetooth-tree"></a></h4>
      <p> <code class="idl"><a data-link-type="idl" href="#dom-navigator-bluetooth">navigator.bluetooth</a></code> and
            objects implementing the <code class="idl"><a data-link-type="idl" href="#bluetoothdevice0">BluetoothDevice</a></code>, <code class="idl"><a data-link-type="idl" href="#bluetoothgattservice0">BluetoothGATTService</a></code>, <code class="idl"><a data-link-type="idl" href="#bluetoothgattcharacteristic0">BluetoothGATTCharacteristic</a></code>, or <code class="idl"><a data-link-type="idl" href="#bluetoothgattdescriptor0">BluetoothGATTDescriptor</a></code> interface <a data-link-type="dfn" href="http://dom.spec.whatwg.org/#concept-tree-participate">participate in a tree</a>,
            simply named the <dfn data-dfn-type="dfn" data-noexport="" id="bluetooth-tree0">Bluetooth tree<a class="self-link" href="#bluetooth-tree0"></a></dfn>. </p>
      <ul>
       <li> The <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-tree-child">children</a> of <code class="idl"><a data-link-type="idl" href="#dom-navigator-bluetooth">navigator.bluetooth</a></code> are the <code class="idl"><a data-link-type="idl" href="#bluetoothdevice0">BluetoothDevice</a></code> objects representing
              devices on the origin’s <a data-link-type="dfn" href="#allowed-devices-map">allowed devices map</a>,
              in an unspecified order. 
       <li> The <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-tree-child">children</a> of a <code class="idl"><a data-link-type="idl" href="#bluetoothdevice0">BluetoothDevice</a></code> are the <code class="idl"><a data-link-type="idl" href="#bluetoothgattservice0">BluetoothGATTService</a></code> objects representing
              Primary and Secondary <a data-link-type="dfn" href="#service">Service</a>s on its <a data-link-type="dfn" href="#gatt-server">GATT Server</a> whose UUIDs are on the origin and device’s <a data-link-type="dfn" href="#allowed-services-list">allowed services list</a>.
              The order of the primary services MUST be consistent with the order returned by
              the <a data-link-type="dfn" href="#discover-primary-service-by-service-uuid">Discover Primary Service by Service UUID</a> procedure,
              but secondary services and primary services with different UUIDs may be in any order. 
       <li> The <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-tree-child">children</a> of a <code class="idl"><a data-link-type="idl" href="#bluetoothgattservice0">BluetoothGATTService</a></code> are
              the <code class="idl"><a data-link-type="idl" href="#bluetoothgattcharacteristic0">BluetoothGATTCharacteristic</a></code> objects representing its Characteristics.
              The order of the characteristics MUST be consistent with the order returned by
              the <a data-link-type="dfn" href="#discover-characteristics-by-uuid">Discover Characteristics by UUID</a> procedure,
              but characteristics with different UUIDs may be in any order. 
       <li> The <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-tree-child">children</a> of a <code class="idl"><a data-link-type="idl" href="#bluetoothgattcharacteristic0">BluetoothGATTCharacteristic</a></code> are
              the <code class="idl"><a data-link-type="idl" href="#bluetoothgattdescriptor0">BluetoothGATTDescriptor</a></code> objects representing its Descriptors
              in the order returned by the <a data-link-type="dfn" href="#discover-all-characteristic-descriptors">Discover All Characteristic Descriptors</a> procedure. 
      </ul>
     </section>
     <section>
      <h4 class="heading settled" data-level="5.6.2" id="event-types"><span class="secno">5.6.2. </span><span class="content">Event types</span><a class="self-link" href="#event-types"></a></h4>
      <dl>
       <dt><dfn class="idl-code" data-dfn-for="BluetoothGATTCharacteristic" data-dfn-type="event" data-export="" id="dom-bluetoothgattcharacteristic-characteristicvaluechanged"><code>characteristicvaluechanged</code><a class="self-link" href="#dom-bluetoothgattcharacteristic-characteristicvaluechanged"></a></dfn>
       <dd> Fired on a <code class="idl"><a data-link-type="idl" href="#bluetoothgattcharacteristic0">BluetoothGATTCharacteristic</a></code> when its value changes,
              either as a result of
              a <a data-link-type="idl" href="#dom-bluetoothgattcharacteristic-readvalue">read request</a>,
              or a <a href="#notification-events">value change notification/indication</a>. 
       <dt><dfn class="idl-code" data-dfn-for="BluetoothGATTService" data-dfn-type="event" data-export="" id="dom-bluetoothgattservice-serviceadded"><code>serviceadded</code><a class="self-link" href="#dom-bluetoothgattservice-serviceadded"></a></dfn>
       <dd> Fired on a new <code class="idl"><a data-link-type="idl" href="#bluetoothgattservice0">BluetoothGATTService</a></code> <a href="#service-change-events">when it has been discovered on a remote device</a>,
              just after it is added to the <a data-link-type="dfn" href="#bluetooth-tree0">Bluetooth tree</a>. 
       <dt><dfn class="idl-code" data-dfn-for="BluetoothGATTService" data-dfn-type="event" data-export="" id="dom-bluetoothgattservice-servicechanged"><code>servicechanged</code><a class="self-link" href="#dom-bluetoothgattservice-servicechanged"></a></dfn>
       <dd> Fired on a <code class="idl"><a data-link-type="idl" href="#bluetoothgattservice0">BluetoothGATTService</a></code> <a href="#service-change-events">when its state changes</a>.
              This involves any characteristics and/or descriptors
              that get added or removed from the service,
              as well as <a data-link-type="dfn" href="#service-changed">Service Changed</a> indications from the remote device. 
       <dt><dfn class="idl-code" data-dfn-for="BluetoothGATTService" data-dfn-type="event" data-export="" id="dom-bluetoothgattservice-serviceremoved"><code>serviceremoved</code><a class="self-link" href="#dom-bluetoothgattservice-serviceremoved"></a></dfn>
       <dd> Fired on a <code class="idl"><a data-link-type="idl" href="#bluetoothgattservice0">BluetoothGATTService</a></code> <a href="#service-change-events">when it has been removed from its device</a>,
              just before it is removed from the <a data-link-type="dfn" href="#bluetooth-tree0">Bluetooth tree</a>. 
      </dl>
     </section>
     <section>
      <h4 class="heading settled" data-level="5.6.3" id="notification-events"><span class="secno">5.6.3. </span><span class="content">Responding to Notifications and Indications</span><a class="self-link" href="#notification-events"></a></h4>
      <p> When the UA receives a Bluetooth <a data-link-type="dfn" href="#characteristic-value-notification">Characteristic Value Notification</a> or <a data-link-type="dfn" href="#characteristic-value-indications">Indication</a>,
            it must perform the following steps: </p>
      <ol>
       <li>
         For each <var>bluetoothGlobal</var> in
              the Characteristic’s <a data-link-type="dfn" href="#active-notification-context-set">active notification context set</a>, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">queue a task</a> on the event loop of the script settings object of <var>bluetoothGlobal</var> to do the following steps: 
        <ol>
         <li> Let <var>characteristicObject</var> be the <code class="idl"><a data-link-type="idl" href="#bluetoothgattcharacteristic0">BluetoothGATTCharacteristic</a></code> in
                  the <a data-link-type="dfn" href="#bluetooth-tree0">Bluetooth tree</a> rooted at <var>bluetoothGlobal</var> that represents the <a data-link-type="dfn" href="#characteristic">Characteristic</a>. 
         <li> Set <code><var>characteristicObject</var>.value</code> to
                  a new <code class="idl"><a data-link-type="idl" href="http://ecma-international.org/ecma-262/6.0/#sec-arraybuffer-constructor">ArrayBuffer</a></code> holding the new value of the <a data-link-type="dfn" href="#characteristic">Characteristic</a>. 
         <li> <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-fire">Fire an event</a> named <code class="idl"><a data-link-type="idl" href="#dom-bluetoothgattcharacteristic-characteristicvaluechanged">characteristicvaluechanged</a></code> with its <code>bubbles</code> attribute initialized to <code>true</code> at <var>characteristicObject</var>. 
        </ol>
      </ol>
     </section>
     <section>
      <h4 class="heading settled" data-level="5.6.4" id="service-change-events"><span class="secno">5.6.4. </span><span class="content">Responding to Service Changes</span><a class="self-link" href="#service-change-events"></a></h4>
      <p> The Bluetooth <a data-link-type="dfn" href="#attribute-caching">Attribute Caching</a> system allows clients
            to track changes to <a data-link-type="dfn" href="#service">Service</a>s, <a data-link-type="dfn" href="#characteristic">Characteristic</a>s, and <a data-link-type="dfn" href="#descriptor">Descriptor</a>s.
            Before discovering any of these entities for the purpose of exposing them to a web page
            the UA MUST subscribe to Indications from the <a data-link-type="dfn" href="#service-changed">Service Changed</a> characteristic, if it exists.
            When the UA receives an Indication on the Service Changed characteristic,
            it MUST perform the following steps. </p>
      <ol>
       <li> Let <var>removedEntities</var> be the list of entities in
              the range indicated by the Service Changed characteristic
              that the UA had discovered before the Indication. 
       <li> Use the <a data-link-type="dfn" href="#primary-service-discovery">Primary Service Discovery</a>, <a data-link-type="dfn" href="#relationship-discovery">Relationship Discovery</a>, <a data-link-type="dfn" href="#characteristic-discovery">Characteristic Discovery</a>,
              and <a data-link-type="dfn" href="#characteristic-descriptor-discovery">Characteristic Descriptor Discovery</a> procedures
              to re-discover entities in the range indicated by the Service Changed characteristic.
              The UA MAY skip discovering all or part of the indicated range
              if it can prove that the results of that discovery
              could not affect the events fired below. 
       <li> Let <var>addedEntities</var> be the list of entities discovered in the previous step. 
       <li> If an entity with the same definition, ignoring Characteristic and Descriptor values,
              appears in both <var>removedEntities</var> and <var>addedEntities</var>,
              remove it from both. 
       <li> Let <var>changedServices</var> be a set of <a data-link-type="dfn" href="#service">Service</a>s, initially empty. 
       <li> If the <a data-link-type="dfn" href="#same-attribute">same</a> <a data-link-type="dfn" href="#service">Service</a> appears in
              both <var>removedEntities</var> and <var>addedEntities</var>,
              remove it from both, and add it to <var>changedServices</var>. 
       <li> For each <a data-link-type="dfn" href="#characteristic">Characteristic</a> and <a data-link-type="dfn" href="#descriptor">Descriptor</a> in <var>removedEntities</var> and <var>addedEntities</var>,
              remove it from its original list,
              and add its parent <a data-link-type="dfn" href="#service">Service</a> to <var>changedServices</var>. <span class="note" role="note">After this point, <var>removedEntities</var> and <var>addedEntities</var> contain only <a data-link-type="dfn" href="#service">Service</a>s.</span> 
       <li> If a <a data-link-type="dfn" href="#service">Service</a> in <var>addedEntities</var> would not have been returned to any <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#script-execution-environment">script execution environment</a> if it had existed at the time of any previous call to <code>getPrimaryService</code>, <code>getPrimaryServices</code>, <code>getIncludedService</code>, or <code>getIncludedServices</code>,
              the UA MAY remove the <a data-link-type="dfn" href="#service">Service</a> from <var>addedEntities</var>. 
       <li> Let <var>changedDevices</var> be the set of <a data-link-type="dfn" href="#bluetooth-device">Bluetooth device</a>s that
              contain any <a data-link-type="dfn" href="#service">Service</a> in <var>removedEntities</var>, <var>addedEntities</var>, and <var>changedServices</var>. 
       <li>
         For each <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#script-execution-environment">script execution environment</a> that is connected to a device in <var>changedDevices</var>, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">queue a task</a> on its event loop to do the following steps: 
        <ol>
         <li> For each <a data-link-type="dfn" href="#service">Service</a> in <var>removedEntities</var>, <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-fire">fire an event</a> named <code class="idl"><a data-link-type="idl" href="#dom-bluetoothgattservice-serviceremoved">serviceremoved</a></code> with its <code>bubbles</code> attribute initialized to <code>true</code> at the <code class="idl"><a data-link-type="idl" href="#bluetoothgattservice0">BluetoothGATTService</a></code> representing the <a data-link-type="dfn" href="#service">Service</a>.
                  Then remove this <code class="idl"><a data-link-type="idl" href="#bluetoothgattservice0">BluetoothGATTService</a></code> from the <a data-link-type="dfn" href="#bluetooth-tree0">Bluetooth tree</a>. 
         <li> For each <a data-link-type="dfn" href="#service">Service</a> in <var>addedEntities</var>,
                  add the <code class="idl"><a data-link-type="idl" href="#bluetoothgattservice0">BluetoothGATTService</a></code> representing this <a data-link-type="dfn" href="#service">Service</a> to the <a data-link-type="dfn" href="#bluetooth-tree0">Bluetooth tree</a>.
                  Then <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-fire">fire an event</a> named <code class="idl"><a data-link-type="idl" href="#dom-bluetoothgattservice-serviceadded">serviceadded</a></code> with its <code>bubbles</code> attribute initialized to <code>true</code> at the <code class="idl"><a data-link-type="idl" href="#bluetoothgattservice0">BluetoothGATTService</a></code>. 
         <li> For each <a data-link-type="dfn" href="#service">Service</a> in <var>changedServices</var>, <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-fire">fire an event</a> named <code class="idl"><a data-link-type="idl" href="#dom-bluetoothgattservice-servicechanged">servicechanged</a></code> with its <code>bubbles</code> attribute initialized to <code>true</code> at the <code class="idl"><a data-link-type="idl" href="#bluetoothgattservice0">BluetoothGATTService</a></code> representing the <a data-link-type="dfn" href="#service">Service</a>. 
        </ol>
      </ol>
     </section>
     <section>
      <h4 class="heading settled" data-level="5.6.5" id="idl-event-handlers"><span class="secno">5.6.5. </span><span class="content">IDL event handlers</span><a class="self-link" href="#idl-event-handlers"></a></h4>
<pre class="idl">[NoInterfaceObject]
interface <dfn class="idl-code" data-dfn-type="interface" data-export="" id="characteristiceventhandlers">CharacteristicEventHandlers<a class="self-link" href="#characteristiceventhandlers"></a></dfn> {
  attribute <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler " href="#dom-characteristiceventhandlers-oncharacteristicvaluechanged">oncharacteristicvaluechanged</a>;
};
</pre>
      <p> <dfn class="idl-code" data-dfn-for="CharacteristicEventHandlers" data-dfn-type="attribute" data-export="" id="dom-characteristiceventhandlers-oncharacteristicvaluechanged">oncharacteristicvaluechanged<a class="self-link" href="#dom-characteristiceventhandlers-oncharacteristicvaluechanged"></a></dfn> is an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-idl-attributes">Event handler IDL attribute</a> for the <code class="idl"><a data-link-type="idl" href="#dom-bluetoothgattcharacteristic-characteristicvaluechanged">characteristicvaluechanged</a></code> event type. </p>
<pre class="idl">[NoInterfaceObject]
interface <dfn class="idl-code" data-dfn-type="interface" data-export="" id="serviceeventhandlers">ServiceEventHandlers<a class="self-link" href="#serviceeventhandlers"></a></dfn> {
  attribute <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler " href="#dom-serviceeventhandlers-onserviceadded">onserviceadded</a>;
  attribute <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler " href="#dom-serviceeventhandlers-onservicechanged">onservicechanged</a>;
  attribute <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler " href="#dom-serviceeventhandlers-onserviceremoved">onserviceremoved</a>;
};
</pre>
      <p> <dfn class="idl-code" data-dfn-for="ServiceEventHandlers" data-dfn-type="attribute" data-export="" id="dom-serviceeventhandlers-onserviceadded">onserviceadded<a class="self-link" href="#dom-serviceeventhandlers-onserviceadded"></a></dfn> is an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-idl-attributes">Event handler IDL attribute</a> for the <code class="idl"><a data-link-type="idl" href="#dom-bluetoothgattservice-serviceadded">serviceadded</a></code> event type. </p>
      <p> <dfn class="idl-code" data-dfn-for="ServiceEventHandlers" data-dfn-type="attribute" data-export="" id="dom-serviceeventhandlers-onservicechanged">onservicechanged<a class="self-link" href="#dom-serviceeventhandlers-onservicechanged"></a></dfn> is an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-idl-attributes">Event handler IDL attribute</a> for the <code class="idl"><a data-link-type="idl" href="#dom-bluetoothgattservice-servicechanged">servicechanged</a></code> event type. </p>
      <p> <dfn class="idl-code" data-dfn-for="ServiceEventHandlers" data-dfn-type="attribute" data-export="" id="dom-serviceeventhandlers-onserviceremoved">onserviceremoved<a class="self-link" href="#dom-serviceeventhandlers-onserviceremoved"></a></dfn> is an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-idl-attributes">Event handler IDL attribute</a> for the <code class="idl"><a data-link-type="idl" href="#dom-bluetoothgattservice-serviceremoved">serviceremoved</a></code> event type. </p>
     </section>
    </section>
    <section>
     <h3 class="heading settled" data-level="5.7" id="error-handling"><span class="secno">5.7. </span><span class="content">Error handling</span><a class="self-link" href="#error-handling"></a></h3>
     <p class="note" role="note"> This section primarily defines the mapping from system errors to Javascript error names
          and allows UAs to retry certain operations.
          The retry logic and possible error distinctions
          are highly constrained by the operating system,
          so places these requirements don’t reflect reality
          are likely <a href="https://github.com/WebBluetoothCG/web-bluetooth/issues">spec bugs</a> instead of browser bugs. </p>
     <p> When the UA is using a <a data-link-type="dfn" href="#gatt-procedure">GATT procedure</a> to execute a step in an algorithm or to handle a query to the <a data-link-type="dfn" href="#bluetooth-cache0">Bluetooth cache</a> (both referred to as a "step", here),
          and the GATT procedure returns an <code><a data-link-type="dfn" href="#error-response">Error Response</a></code>,
          the UA MUST perform the following steps: </p>
     <ol>
      <li> If the <a data-link-type="dfn" href="#procedure-timeouts">procedure times out</a> or
            the ATT Bearer (described in <a data-link-type="dfn" href="#profile-fundamentals">Profile Fundamentals</a>) is terminated for any reason,
            return a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#networkerror">NetworkError</a></code> from the step and abort these steps. 
      <li>
        Take the following actions depending on the <code>Error Code</code>: 
       <dl>
        <dt><code>Invalid Handle</code>
        <dt><code>Invalid PDU</code>
        <dt><code>Invalid Offset</code>
        <dt><code>Attribute Not Found</code>
        <dt><code>Unsupported Group Type</code>
        <dd> These error codes indicate that something unexpected happened at the protocol layer,
                likely either due to a UA or device bug.
                Return a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#notsupportederror">NotSupportedError</a></code> from the step. 
        <dt><code>Invalid Attribute Value Length</code>
        <dd> Return an <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#invalidmodificationerror">InvalidModificationError</a></code> from the step. 
        <dt><code>Attribute Not Long</code>
        <dd>
         <p> If this error code is received without having used a "Long" sub-procedure,
                  this may indicate a device bug.
                  Return a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#notsupportederror">NotSupportedError</a></code> from the step. </p>
         <p> Otherwise, retry the step without using a "Long" sub-procedure.
                  If this is impossible due to the length of the value being written,
                  return an <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#invalidmodificationerror">InvalidModificationError</a></code> from the step. </p>
        <dt><code>Insufficient Authentication</code>
        <dt><code>Insufficient Encryption</code>
        <dt><code>Insufficient Encryption Key Size</code>
        <dd> The UA SHOULD attempt to increase the security level of the connection.
                If this attempt fails or the UA doesn’t support any higher security,
                Return a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#securityerror">SecurityError</a></code> from the step.
                Otherwise, retry the step at the new higher security level. 
        <dt><code>Insufficient Authorization</code>
        <dd> Return a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#securityerror">SecurityError</a></code> from the step. 
        <dt><code>Application Error</code>
        <dd> If the GATT procedure was a Write,
                return an <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#invalidmodificationerror">InvalidModificationError</a></code> from the step.
                Otherwise, return a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#notsupportederror">NotSupportedError</a></code> from the step. 
        <dt><code>Read Not Permitted</code>
        <dt><code>Write Not Permitted</code>
        <dt><code>Request Not Supported</code>
        <dt><code>Prepare Queue Full</code>
        <dt><code>Insufficient Resources</code>
        <dt><code>Unlikely Error</code>
        <dt>Anything else
        <dd> Return a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#notsupportederror">NotSupportedError</a></code> from the step. 
       </dl>
     </ol>
    </section>
   </section>
   <section>
    <h2 class="heading settled" data-level="6" id="uuids"><span class="secno">6. </span><span class="content">UUIDs</span><a class="self-link" href="#uuids"></a></h2>
<pre class="idl">typedef DOMString <dfn class="idl-code" data-dfn-type="typedef" data-export="" id="typedefdef-uuid">UUID<a class="self-link" href="#typedefdef-uuid"></a></dfn>;</pre>
    <p> A <a data-link-type="dfn" href="#uuid">UUID</a> string represents a 128-bit <a data-link-type="biblio" href="#biblio-rfc4122">[RFC4122]</a> UUID.
        A <dfn data-dfn-type="dfn" data-noexport="" id="valid-uuid">valid UUID<a class="self-link" href="#valid-uuid"></a></dfn> is a string that matches
        the <a data-link-type="biblio" href="#biblio-ecmascript">[ECMAScript]</a> regexp <code>/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/</code>.
        That is, a <a data-link-type="dfn" href="#valid-uuid">valid UUID</a> is lower-case and
        does not use the 16- or 32-bit abbreviations defined by the Bluetooth standard.
        All UUIDs returned from functions and attributes in this specification
        MUST be <a data-link-type="dfn" href="#valid-uuid">valid UUID</a>s.
        If a function in this specification takes a parameter whose type is <a data-link-type="dfn" href="#uuid">UUID</a> or a dictionary including a <a data-link-type="dfn" href="#uuid">UUID</a> attribute,
        and the argument passed in any <a data-link-type="dfn" href="#uuid">UUID</a> slot is not a <a data-link-type="dfn" href="#valid-uuid">valid UUID</a>,
        the function MUST return <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#a-promise-rejected-with">a promise rejected with</a> a <code>TypeError</code> and abort its other steps. </p>
    <p class="note" role="note"> This standard provides the <code>BluetoothUUID.<a data-link-type="functionish" href="#dom-bluetoothuuid-canonicaluuid">canonicalUUID(<var>alias</var>)</a></code> function
        to map a 16- or 32-bit Bluetooth <a data-link-type="dfn" href="#uuid-alias">UUID alias</a> to its 128-bit form. </p>
    <p class="note" role="note"> Bluetooth devices are required to convert 16- and 32-bit UUIDs to 128-bit UUIDs
        before comparing them (as described in <a data-link-type="dfn" href="#attribute-type">Attribute Type</a>), but not all devices do so.
        To interoperate with these devices,
        if the UA has received a UUID from the device in one form (16-, 32-, or 128-bit),
        it should send other aliases of that UUID back to the device in the same form. </p>
    <section>
     <h3 class="heading settled" data-level="6.1" id="standardized-uuids"><span class="secno">6.1. </span><span class="content">Standardized UUIDs</span><a class="self-link" href="#standardized-uuids"></a></h3>
     <p> The Bluetooth SIG maintains a registry at <a data-link-type="biblio" href="#biblio-bluetooth-assigned">[BLUETOOTH-ASSIGNED]</a> of
          UUIDs that identify services, characteristics, descriptors, and other entities.
          This section provides a way for script to look up those UUIDs by name
          so they don’t need to be replicated in each application. </p>
<pre class="idl">interface <dfn class="idl-code" data-dfn-type="interface" data-export="" id="bluetoothuuid">BluetoothUUID<a class="self-link" href="#bluetoothuuid"></a></dfn> {
  static <a data-link-type="idl-name" href="#typedefdef-uuid">UUID</a> <a class="idl-code" data-link-type="method" href="#dom-bluetoothuuid-getservice">getService</a>((DOMString or unsigned long) <dfn class="idl-code" data-dfn-for="BluetoothUUID/getService(name)" data-dfn-type="argument" data-export="" id="dom-bluetoothuuid-getservice-name-name">name<a class="self-link" href="#dom-bluetoothuuid-getservice-name-name"></a></dfn>);
  static <a data-link-type="idl-name" href="#typedefdef-uuid">UUID</a> <a class="idl-code" data-link-type="method" href="#dom-bluetoothuuid-getcharacteristic">getCharacteristic</a>((DOMString or unsigned long) <dfn class="idl-code" data-dfn-for="BluetoothUUID/getCharacteristic(name)" data-dfn-type="argument" data-export="" id="dom-bluetoothuuid-getcharacteristic-name-name">name<a class="self-link" href="#dom-bluetoothuuid-getcharacteristic-name-name"></a></dfn>);
  static <a data-link-type="idl-name" href="#typedefdef-uuid">UUID</a> <a class="idl-code" data-link-type="method" href="#dom-bluetoothuuid-getdescriptor">getDescriptor</a>((DOMString or unsigned long) <dfn class="idl-code" data-dfn-for="BluetoothUUID/getDescriptor(name)" data-dfn-type="argument" data-export="" id="dom-bluetoothuuid-getdescriptor-name-name">name<a class="self-link" href="#dom-bluetoothuuid-getdescriptor-name-name"></a></dfn>);

  static <a data-link-type="idl-name" href="#typedefdef-uuid">UUID</a> <a class="idl-code" data-link-type="method" href="#dom-bluetoothuuid-canonicaluuid">canonicalUUID</a>([EnforceRange] unsigned long <dfn class="idl-code" data-dfn-for="BluetoothUUID/canonicalUUID(alias)" data-dfn-type="argument" data-export="" id="dom-bluetoothuuid-canonicaluuid-alias-alias">alias<a class="self-link" href="#dom-bluetoothuuid-canonicaluuid-alias-alias"></a></dfn>);
};

typedef (DOMString or unsigned long) <a class="idl-code" data-link-type="typedef" href="#typedefdef-bluetoothserviceuuid">BluetoothServiceUUID</a>;
typedef (DOMString or unsigned long) <a class="idl-code" data-link-type="typedef" href="#typedefdef-bluetoothcharacteristicuuid">BluetoothCharacteristicUUID</a>;
typedef (DOMString or unsigned long) <a class="idl-code" data-link-type="typedef" href="#typedefdef-bluetoothdescriptoruuid">BluetoothDescriptorUUID</a>;
</pre>
     <p> The static <code>BluetoothUUID.<dfn class="idl-code" data-dfn-for="BluetoothUUID" data-dfn-type="method" data-export="" id="dom-bluetoothuuid-canonicaluuid">canonicalUUID(<var>alias</var>)<a class="self-link" href="#dom-bluetoothuuid-canonicaluuid"></a></dfn></code> method, when invoked,
          MUST return <a data-link-type="dfn" href="#the-128-bit-uuid-represented">the 128-bit UUID represented</a> by the 16- or 32-bit UUID alias <var>alias</var>. </p>
     <p class="note" role="note"> This algorithm consists of
          replacing the top 32 bits of "<code>00000000-0000-1000-8000-00805f9b34fb</code>"
          with the bits of the alias.
          For example, <code>canonicalUUID(0xDEADBEEF)</code> returns <code>"deadbeef-0000-1000-8000-00805f9b34fb"</code>. </p>
     <div class="note" role="note">
      <p> <dfn class="idl-code" data-dfn-type="typedef" data-export="" id="typedefdef-bluetoothserviceuuid">BluetoothServiceUUID<a class="self-link" href="#typedefdef-bluetoothserviceuuid"></a></dfn> represents
            16- and 32-bit UUID aliases, <a data-link-type="dfn" href="#valid-uuid">valid UUID</a>s,
            and names defined in <a data-link-type="biblio" href="#biblio-bluetooth-assigned-services">[BLUETOOTH-ASSIGNED-SERVICES]</a>,
            or, equivalently, the values for which <code class="idl"><a data-link-type="idl" href="#dom-bluetoothuuid-getservice">BluetoothUUID.getService()</a></code> does not throw an exception. </p>
      <p> <dfn class="idl-code" data-dfn-type="typedef" data-export="" id="typedefdef-bluetoothcharacteristicuuid">BluetoothCharacteristicUUID<a class="self-link" href="#typedefdef-bluetoothcharacteristicuuid"></a></dfn> represents
            16- and 32-bit UUID aliases, <a data-link-type="dfn" href="#valid-uuid">valid UUID</a>s,
            and names defined in <a data-link-type="biblio" href="#biblio-bluetooth-assigned-characteristics">[BLUETOOTH-ASSIGNED-CHARACTERISTICS]</a>,
            or, equivalently, the values for which <code class="idl"><a data-link-type="idl" href="#dom-bluetoothuuid-getcharacteristic">BluetoothUUID.getCharacteristic()</a></code> does not throw an exception. </p>
      <p> <dfn class="idl-code" data-dfn-type="typedef" data-export="" id="typedefdef-bluetoothdescriptoruuid">BluetoothDescriptorUUID<a class="self-link" href="#typedefdef-bluetoothdescriptoruuid"></a></dfn> represents
            16- and 32-bit UUID aliases, <a data-link-type="dfn" href="#valid-uuid">valid UUID</a>s,
            and names defined in <a data-link-type="biblio" href="#biblio-bluetooth-assigned-descriptors">[BLUETOOTH-ASSIGNED-DESCRIPTORS]</a>,
            or, equivalently, the values for which <code class="idl"><a data-link-type="idl" href="#dom-bluetoothuuid-getdescriptor">BluetoothUUID.getDescriptor()</a></code> does not throw an exception. </p>
     </div>
     <p> To <dfn data-dfn-type="dfn" data-noexport="" id="resolveuuidname">ResolveUUIDName<a class="self-link" href="#resolveuuidname"></a></dfn>(<var>name</var>, <var>assigned numbers table</var>, <var>prefix</var>),
          the UA MUST perform the following steps: </p>
     <ol>
      <li> If <var>name</var> is an <code>unsigned long</code>,
            return <code class="idl"><a data-link-type="idl" href="#dom-bluetoothuuid-canonicaluuid">BluetoothUUID.canonicalUUID</a></code>(name) and abort these steps. 
      <li> If <var>name</var> is a <a data-link-type="dfn" href="#valid-uuid">valid UUID</a>,
            return <var>name</var> and abort these steps. 
      <li> If the string <code><var>prefix</var> + "." + <var>name</var></code> appears in <var>assigned numbers table</var>,
            let <var>alias</var> be its assigned number,
            and return <code class="idl"><a data-link-type="idl" href="#dom-bluetoothuuid-canonicaluuid">BluetoothUUID.canonicalUUID</a></code>(<var>alias</var>). 
      <li> Otherwise, throw a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#syntaxerror">SyntaxError</a></code>. 
     </ol>
     <p> The static <code>BluetoothUUID.<dfn class="idl-code" data-dfn-for="BluetoothUUID" data-dfn-type="method" data-export="" id="dom-bluetoothuuid-getservice">getService(<var>name</var>)<a class="self-link" href="#dom-bluetoothuuid-getservice"></a></dfn></code> method, when invoked,
          MUST return <a data-link-type="dfn" href="#resolveuuidname">ResolveUUIDName</a>(<code><var>name</var></code>, <a data-link-type="biblio" href="#biblio-bluetooth-assigned-services">[BLUETOOTH-ASSIGNED-SERVICES]</a>, "org.bluetooth.service"). </p>
     <p> The static <code>BluetoothUUID.<dfn class="idl-code" data-dfn-for="BluetoothUUID" data-dfn-type="method" data-export="" id="dom-bluetoothuuid-getcharacteristic">getCharacteristic(<var>name</var>)<a class="self-link" href="#dom-bluetoothuuid-getcharacteristic"></a></dfn></code> method, when invoked,
          MUST return <a data-link-type="dfn" href="#resolveuuidname">ResolveUUIDName</a>(<code><var>name</var></code>, <a data-link-type="biblio" href="#biblio-bluetooth-assigned-characteristics">[BLUETOOTH-ASSIGNED-CHARACTERISTICS]</a>, "org.bluetooth.characteristic"). </p>
     <p> The static <code>BluetoothUUID.<dfn class="idl-code" data-dfn-for="BluetoothUUID" data-dfn-type="method" data-export="" id="dom-bluetoothuuid-getdescriptor">getDescriptor(<var>name</var>)<a class="self-link" href="#dom-bluetoothuuid-getdescriptor"></a></dfn></code> method, when invoked,
          MUST return <a data-link-type="dfn" href="#resolveuuidname">ResolveUUIDName</a>(<code><var>name</var></code>, <a data-link-type="biblio" href="#biblio-bluetooth-assigned-descriptors">[BLUETOOTH-ASSIGNED-DESCRIPTORS]</a>, "org.bluetooth.descriptor"). </p>
     <div class="example" id="example-aa5b2ace">
      <a class="self-link" href="#example-aa5b2ace"></a> 
      <p> <code><code class="idl"><a data-link-type="idl" href="#dom-bluetoothuuid-getservice">BluetoothUUID.getService</a></code>("<a data-link-type="idl" href="https://developer.bluetooth.org/gatt/services/Pages/ServiceViewer.aspx?u=org.bluetooth.service.cycling_power.xml#">cycling_power</a>")</code> returns <code>"00001818-0000-1000-8000-00805f9b34fb"</code>. </p>
      <p> <code><code class="idl"><a data-link-type="idl" href="#dom-bluetoothuuid-getservice">BluetoothUUID.getService</a></code>("00001801-0000-1000-8000-00805f9b34fb")</code> returns <code>"00001801-0000-1000-8000-00805f9b34fb"</code>. </p>
      <p> <code><code class="idl"><a data-link-type="idl" href="#dom-bluetoothuuid-getservice">BluetoothUUID.getService</a></code>("unknown-service")</code> throws a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#syntaxerror">SyntaxError</a></code>. </p>
      <p> <code><code class="idl"><a data-link-type="idl" href="#dom-bluetoothuuid-getcharacteristic">BluetoothUUID.getCharacteristic</a></code>("<code class="idl"><a data-link-type="idl" href="https://developer.bluetooth.org/gatt/characteristics/Pages/CharacteristicViewer.aspx?u=org.bluetooth.characteristic.ieee_11073-20601_regulatory_certification_data_list.xml#">ieee_11073-20601_regulatory_certification_data_list</a></code>")</code> returns <code>"00002a2a-0000-1000-8000-00805f9b34fb"</code>. </p>
      <p> <code><code class="idl"><a data-link-type="idl" href="#dom-bluetoothuuid-getdescriptor">BluetoothUUID.getDescriptor</a></code>("<code class="idl"><a data-link-type="idl" href="https://developer.bluetooth.org/gatt/descriptors/Pages/DescriptorViewer.aspx?u=org.bluetooth.descriptor.gatt.characteristic_presentation_format.xml#">gatt.characteristic_presentation_format</a></code>")</code> returns <code>"00002904-0000-1000-8000-00805f9b34fb"</code>. </p>
     </div>
    </section>
   </section>
   <section>
    <h2 class="heading settled" data-level="7" id="gatt-blacklist"><span class="secno">7. </span><span class="content">The GATT Blacklist</span><a class="self-link" href="#gatt-blacklist"></a></h2>
    <p> This specification relies on a blacklist file in the <a href="https://github.com/WebBluetoothCG/registries">https://github.com/WebBluetoothCG/registries</a> repository
        to restrict the set of GATT attributes a website can access. </p>
    <p> The result of <dfn data-dfn-type="dfn" data-noexport="" id="parsing-the-blacklist">parsing the blacklist<a class="self-link" href="#parsing-the-blacklist"></a></dfn> at a URL <var>url</var> is a map from <a data-link-type="dfn" href="#valid-uuid">valid UUID</a>s to tokens, or an error,
        produced by the following algorithm: </p>
    <ol>
     <li>Fetch <var>url</var>, and let <var>contents</var> be its body, decoded as UTF-8.
     <li>Let <var>lines</var> be <var>contents</var> split on <code>'\n'</code>.
     <li> Let <var>result</var> be an empty map. 
     <li>
       For each <var>line</var> in <var>lines</var>, do the following sub-steps: 
      <ol>
       <li> If <var>line</var> is empty or its first character is <code>'#'</code>,
              continue to the next line. 
       <li> If <var>line</var> consists of just a <a data-link-type="dfn" href="#valid-uuid">valid UUID</a>,
              let <var>uuid</var> be that UUID and
              let <var>token</var> be "<code>exclude</code>". 
       <li> If <var>line</var> consists of a <a data-link-type="dfn" href="#valid-uuid">valid UUID</a>, a space (U+0020),
              and one of the tokens "<code>exclude-reads</code>" or "<code>exclude-writes</code>",
              let <var>uuid</var> be that UUID and
              let <var>token</var> be that token. 
       <li> Otherwise, return an error and abort these steps. 
       <li> If <var>uuid</var> is already in <var>result</var>,
              return an error and abort these steps. 
       <li> Add a mapping in <var>result</var> from <var>uuid</var> to <var>token</var>. 
      </ol>
     <li>Return <var>result</var>.
    </ol>
    <p> The <dfn data-dfn-type="dfn" data-noexport="" id="gatt-blacklist0">GATT blacklist<a class="self-link" href="#gatt-blacklist0"></a></dfn> is the result of <a data-link-type="dfn" href="#parsing-the-blacklist">parsing the blacklist</a> at <a href="https://github.com/WebBluetoothCG/registries/blob/master/gatt_blacklist.txt">https://github.com/WebBluetoothCG/registries/blob/master/gatt_blacklist.txt</a>.
        The UA should re-fetch the blacklist periodically, but it’s unspecified how often. </p>
    <p> A <a data-link-type="dfn" href="#uuid">UUID</a> is <dfn data-dfn-type="dfn" data-noexport="" id="blacklisted">blacklisted<a class="self-link" href="#blacklisted"></a></dfn> if either
        the <a data-link-type="dfn" href="#gatt-blacklist0">GATT blacklist</a>’s value is an error,
        or the UUID maps to "<code>exclude</code>" in the <a data-link-type="dfn" href="#gatt-blacklist0">GATT blacklist</a>. </p>
    <p> A <a data-link-type="dfn" href="#uuid">UUID</a> is <dfn data-dfn-type="dfn" data-noexport="" id="blacklisted-for-reads">blacklisted for reads<a class="self-link" href="#blacklisted-for-reads"></a></dfn> if either
        the <a data-link-type="dfn" href="#gatt-blacklist0">GATT blacklist</a>’s value is an error,
        or the UUID maps to either "<code>exclude</code>" or "<code>exclude-reads</code>"
        in the <a data-link-type="dfn" href="#gatt-blacklist0">GATT blacklist</a>. </p>
    <p> A <a data-link-type="dfn" href="#uuid">UUID</a> is <dfn data-dfn-type="dfn" data-noexport="" id="blacklisted-for-writes">blacklisted for writes<a class="self-link" href="#blacklisted-for-writes"></a></dfn> if either
        the <a data-link-type="dfn" href="#gatt-blacklist0">GATT blacklist</a>’s value is an error,
        or the UUID maps to either "<code>exclude</code>" or "<code>exclude-writes</code>"
        in the <a data-link-type="dfn" href="#gatt-blacklist0">GATT blacklist</a>. </p>
   </section>
   <section>
    <h2 class="heading settled" data-level="8" id="navigator-extensions"><span class="secno">8. </span><span class="content">Extensions to the Navigator Interface</span><a class="self-link" href="#navigator-extensions"></a></h2>
<pre class="idl">partial interface <a class="idl-code" data-link-type="interface" href="https://html.spec.whatwg.org/multipage/webappapis.html#navigator">Navigator</a> {
  readonly attribute <a data-link-type="idl-name" href="#bluetooth">Bluetooth</a> <dfn class="idl-code" data-dfn-for="Navigator" data-dfn-type="attribute" data-export="" data-readonly="" data-type="Bluetooth " id="dom-navigator-bluetooth">bluetooth<a class="self-link" href="#dom-navigator-bluetooth"></a></dfn>;
};
</pre>
   </section>
   <section>
    <h2 class="heading settled" data-level="9" id="terminology"><span class="secno">9. </span><span class="content">Terminology and Conventions</span><a class="self-link" href="#terminology"></a></h2>
    <p> This specification uses a few conventions and several terms from other specifications.
        This section lists those and links to their primary definitions. </p>
    <p> Inspired by
        the <a href="https://streams.spec.whatwg.org/#conventions">Streams specification</a>,
        we use the notation x@[[y]] to refer to <a href="http://ecma-international.org/ecma-262/6.0/#sec-object-internal-methods-and-internal-slots">internal slots</a> of an object, instead of saying "the [[y]] internal slot of x." </p>
    <p> When an algorithm in this specification uses a name defined in this or another specification,
        the name MUST resolve to its initial value,
        ignoring any changes that have been made to the name in the current execution environment.
        For example, when the <code class="idl"><a data-link-type="idl" href="#dom-bluetooth-requestdevice">requestDevice()</a></code> algorithm says to call <code><code class="idl"><a data-link-type="idl" href="http://ecma-international.org/ecma-262/6.0/#sec-array.prototype.map">Array.prototype.map</a></code>.call(<var>filter</var>.services, <code class="idl"><a data-link-type="idl" href="#dom-bluetoothuuid-getservice">BluetoothUUID.getService</a></code>)</code>,
        this MUST apply the <code class="idl"><a data-link-type="idl" href="http://ecma-international.org/ecma-262/6.0/#sec-array.prototype.map">Array.prototype.map</a></code> algorithm defined in <a data-link-type="biblio" href="#biblio-ecmascript">[ECMAScript]</a> with <code><var>filter</var>.services</code> as its <code>this</code> parameter and
        the algorithm defined in <a href="#standardized-uuids">§6.1 Standardized UUIDs</a> for <code class="idl"><a data-link-type="idl" href="#dom-bluetoothuuid-getservice">BluetoothUUID.getService</a></code> as its <code>callbackfn</code> parameter,
        regardless of any modifications that have been made to <code>window</code>, <code>Array</code>, <code>Array.prototype</code>, <code>Array.prototype.map</code>, <code>Function</code>, <code>Function.prototype</code>, <code>BluetoothUUID</code>, <code>BluetoothUUID.getService</code>, or other objects. </p>
    <p> This specification uses a few read-only types
        that are similar to WebIDL’s <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-read-only-array">read only Array</a>. </p>
    <ul>
     <li> A <dfn data-dfn-type="dfn" data-noexport="" id="read-only-map">read only Map<a class="self-link" href="#read-only-map"></a></dfn> has <code class="idl"><a data-link-type="idl" href="http://ecma-international.org/ecma-262/6.0/#sec-map-constructor">Map</a></code>'s values and interface,
          except the <code>clear</code>, <code>delete</code>, and <code>set</code> methods
          are omitted. 
     <li> A <dfn data-dfn-type="dfn" data-noexport="" id="read-only-arraybuffer">read only ArrayBuffer<a class="self-link" href="#read-only-arraybuffer"></a></dfn> has <code class="idl"><a data-link-type="idl" href="http://ecma-international.org/ecma-262/6.0/#sec-arraybuffer-constructor">ArrayBuffer</a></code>'s values and interface,
          except that attempting to write to its contents or transfer it
          has the same effect as trying to write to a <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-read-only-array">read only Array</a>’s contents.
          This applies to <code class="idl"><a data-link-type="idl" href="http://ecma-international.org/ecma-262/6.0/#sec-typedarray-constructors">TypedArray</a></code>s and <code class="idl"><a data-link-type="idl" href="http://ecma-international.org/ecma-262/6.0/#sec-dataview-constructor">DataView</a></code>s
          wrapped around the <code class="idl"><a data-link-type="idl" href="http://ecma-international.org/ecma-262/6.0/#sec-arraybuffer-constructor">ArrayBuffer</a></code> too. 
    </ul>
    <dl>
     <dt><a data-link-type="biblio" href="#biblio-bluetooth42">[BLUETOOTH42]</a>
     <dd>
      <ol>
       <li value="1">
        Architecture &amp; Terminology Overview 
        <ol type="A">
         <li value="1">
          Architecture 
          <ol>
           <li value="4">
            Communication Topology and Operation 
            <ol>
             <li value="2">
              Operational Procedures and Modes 
              <ol>
               <li value="1">
                BR/EDR Procedures 
                <ol>
                 <li value="1">
                  Inquiry (Discovering) Procedure 
                  <ol>
                   <li value="1"><dfn data-dfn-type="dfn" data-noexport="" id="extended-inquiry-response">Extended Inquiry Response<a class="self-link" href="#extended-inquiry-response"></a></dfn>
                  </ol>
                </ol>
              </ol>
            </ol>
          </ol>
        </ol>
       <li value="2">
        Core System Package [BR/EDR Controller volume] 
        <ol type="A">
         <li value="5">
          Host Controller Interface Functional Specification 
          <ol>
           <li value="7">
            HCI Commands and Events 
            <ol>
             <li value="4">
              Informational Parameters 
              <ol>
               <li value="6"><dfn data-dfn-type="dfn" data-noexport="" id="read-bd_addr-command">Read BD_ADDR Command<a class="self-link" href="#read-bd_addr-command"></a></dfn>
              </ol>
             <li value="5">
              Status Parameters 
              <ol>
               <li value="4"> Read <dfn data-dfn-type="dfn" data-lt="RSSI|Received Signal Strength Indication" data-noexport="" id="rssi"><abbr title="Received Signal Strength Indication">RSSI</abbr><a class="self-link" href="#rssi"></a></dfn> Command 
              </ol>
            </ol>
          </ol>
        </ol>
       <li value="3">
        Core System Package [Host volume] 
        <ol type="A">
         <li value="2">
          Service Discovery Protocol (SDP) Specification 
          <ol>
           <li value="2">
            Overview 
            <ol>
             <li value="5">
              <dfn data-dfn-type="dfn" data-noexport="" id="searching-for-services">Searching for Services<a class="self-link" href="#searching-for-services"></a></dfn> 
              <ol>
               <li value="1"><dfn data-dfn-type="dfn" data-noexport="" id="uuid">UUID<a class="self-link" href="#uuid"></a></dfn> (defines <dfn data-dfn-type="dfn" data-noexport="" id="uuid-alias">UUID alias<a class="self-link" href="#uuid-alias"></a></dfn>es and
                              the algorithm to compute <dfn data-dfn-type="dfn" data-noexport="" id="the-128-bit-uuid-represented">the 128-bit UUID represented<a class="self-link" href="#the-128-bit-uuid-represented"></a></dfn> by a UUID alias) 
              </ol>
            </ol>
          </ol>
         <li value="3">
          Generic Access Profile 
          <ol>
           <li value="2">
            Profile Overview 
            <ol>
             <li value="2">
              Profile Roles 
              <ol>
               <li value="2">
                Roles when Operating over an LE Physical Transport 
                <ol>
                 <li value="1"><dfn data-dfn-type="dfn" data-noexport="" id="broadcaster">Broadcaster<a class="self-link" href="#broadcaster"></a></dfn> Role
                 <li value="2"><dfn data-dfn-type="dfn" data-noexport="" id="observer">Observer<a class="self-link" href="#observer"></a></dfn> Role
                 <li value="3"><dfn data-dfn-type="dfn" data-noexport="" id="peripheral">Peripheral<a class="self-link" href="#peripheral"></a></dfn> Role
                 <li value="4"><dfn data-dfn-type="dfn" data-noexport="" id="central">Central<a class="self-link" href="#central"></a></dfn> Role
                </ol>
              </ol>
            </ol>
           <li value="3">
            User Interface Aspects 
            <ol>
             <li value="2">
              Representation of Bluetooth Parameters 
              <ol>
               <li value="2"><dfn data-dfn-type="dfn" data-noexport="" id="bluetooth-device-name">Bluetooth Device Name<a class="self-link" href="#bluetooth-device-name"></a></dfn> (the user-friendly name) 
               <li value="4"><dfn data-dfn-type="dfn" data-noexport="" id="class-of-device">Class of Device<a class="self-link" href="#class-of-device"></a></dfn>
              </ol>
            </ol>
           <li value="6">
            Idle Mode Procedures — BR/EDR Physical Transport 
            <ol>
             <li value="4"><dfn data-dfn-type="dfn" data-noexport="" id="device-discovery-procedure">Device Discovery Procedure<a class="self-link" href="#device-discovery-procedure"></a></dfn>
            </ol>
           <li value="9">
            Operational Modes and Procedures — LE Physical Transport 
            <ol>
             <li value="1">
              Broadcast Mode and Observation Procedure 
              <ol>
               <li value="2"><dfn data-dfn-type="dfn" data-noexport="" id="observation-procedure">Observation Procedure<a class="self-link" href="#observation-procedure"></a></dfn>
              </ol>
             <li value="2">
              Discovery Modes and Procedures 
              <ol>
               <li value="6"><dfn data-dfn-type="dfn" data-noexport="" id="general-discovery-procedure">General Discovery Procedure<a class="self-link" href="#general-discovery-procedure"></a></dfn>
               <li value="7"><dfn data-dfn-type="dfn" data-noexport="" id="name-discovery-procedure">Name Discovery Procedure<a class="self-link" href="#name-discovery-procedure"></a></dfn>
              </ol>
             <li value="3"><dfn data-dfn-type="dfn" data-noexport="" id="connection-modes-and-procedures">Connection Modes and Procedures<a class="self-link" href="#connection-modes-and-procedures"></a></dfn>
             <li value="4">
              Bonding Modes and Procedures 
              <ol>
               <li value="4"><dfn data-dfn-type="dfn" data-noexport="" id="bonding-procedure">Bonding Procedure<a class="self-link" href="#bonding-procedure"></a></dfn>
              </ol>
            </ol>
           <li value="10">
            Security Aspects — LE Physical Transport 
            <ol>
             <li value="7"><dfn data-dfn-type="dfn" data-noexport="" id="privacy-feature">Privacy Feature<a class="self-link" href="#privacy-feature"></a></dfn>
             <li value="8">
              Random Device Address 
              <ol>
               <li value="1"><dfn data-dfn-type="dfn" data-noexport="" id="static-address">Static Address<a class="self-link" href="#static-address"></a></dfn>
               <li value="2">
                <dfn data-dfn-type="dfn" data-noexport="" id="private-address">Private address<a class="self-link" href="#private-address"></a></dfn> 
                <ol>
                 <li value="3"> <dfn data-dfn-type="dfn" data-noexport="" id="resolvable-private-address-resolution-procedure">Resolvable Private Address Resolution Procedure<a class="self-link" href="#resolvable-private-address-resolution-procedure"></a></dfn> 
                </ol>
              </ol>
            </ol>
           <li value="11"><dfn data-dfn-type="dfn" data-noexport="" id="advertising-data">Advertising Data<a class="self-link" href="#advertising-data"></a></dfn> and Scan Response Data Format
           <li value="15">
            Bluetooth Device Requirements 
            <ol>
             <li value="1">
              Bluetooth Device Address (defines <dfn data-dfn-type="dfn" data-noexport="" id="bd_addr">BD_ADDR<a class="self-link" href="#bd_addr"></a></dfn>) 
              <ol>
               <li value="1">
                Bluetooth Device Address Types 
                <ol>
                 <li value="1"><dfn data-dfn-type="dfn" data-noexport="" id="public-bluetooth-address">Public Bluetooth Address<a class="self-link" href="#public-bluetooth-address"></a></dfn>
                </ol>
              </ol>
            </ol>
          </ol>
         <li value="6">
          Attribute Protocol (ATT) 
          <ol>
           <li value="3">
            Protocol Requirements 
            <ol>
             <li value="2">
              Basic Concepts 
              <ol>
               <li value="1"><dfn data-dfn-type="dfn" data-noexport="" id="attribute-type">Attribute Type<a class="self-link" href="#attribute-type"></a></dfn>
               <li value="2"><dfn data-dfn-type="dfn" data-noexport="" id="attribute-handle">Attribute Handle<a class="self-link" href="#attribute-handle"></a></dfn>
               <li value="9"><dfn data-dfn-type="dfn" data-noexport="" id="long-attribute-values">Long Attribute Values<a class="self-link" href="#long-attribute-values"></a></dfn>
              </ol>
             <li value="4">
              Attribute Protocol Pdus 
              <ol>
               <li value="1">
                Error Handling 
                <ol>
                 <li value="1"><dfn data-dfn-type="dfn" data-noexport="" id="error-response">Error Response<a class="self-link" href="#error-response"></a></dfn>
                </ol>
              </ol>
            </ol>
          </ol>
         <li value="7">
          <dfn data-dfn-type="dfn" data-lt="Generic Attribute Profile|GATT" data-noexport="" id="generic-attribute-profile">Generic Attribute Profile<a class="self-link" href="#generic-attribute-profile"></a></dfn> (GATT) 
          <ol>
           <li value="2">
            Profile Overview 
            <ol>
             <li value="2">Configurations and Roles
                          (defines <dfn data-dfn-type="dfn" data-noexport="" id="gatt-client">GATT Client<a class="self-link" href="#gatt-client"></a></dfn> and <dfn data-dfn-type="dfn" data-noexport="" id="gatt-server">GATT Server<a class="self-link" href="#gatt-server"></a></dfn>) 
             <li value="4"> <dfn data-dfn-type="dfn" data-noexport="" id="profile-fundamentals">Profile Fundamentals<a class="self-link" href="#profile-fundamentals"></a></dfn>,
                          defines the <dfn data-dfn-type="dfn" data-noexport="" id="att-bearer">ATT Bearer<a class="self-link" href="#att-bearer"></a></dfn> 
             <li value="5">
              Attribute Protocol 
              <ol>
               <li value="2"><dfn data-dfn-type="dfn" data-noexport="" id="attribute-caching">Attribute Caching<a class="self-link" href="#attribute-caching"></a></dfn>
              </ol>
             <li value="6">
              <dfn data-dfn-type="dfn" data-noexport="" id="gatt-profile-hierarchy">GATT Profile Hierarchy<a class="self-link" href="#gatt-profile-hierarchy"></a></dfn> 
              <ol>
               <li value="2"><dfn data-dfn-type="dfn" data-noexport="" id="service">Service<a class="self-link" href="#service"></a></dfn>
               <li value="3"><dfn data-dfn-type="dfn" data-noexport="" id="included-service">Included Service<a class="self-link" href="#included-service"></a></dfn>s
               <li value="4"><dfn data-dfn-type="dfn" data-noexport="" id="characteristic">Characteristic<a class="self-link" href="#characteristic"></a></dfn>
              </ol>
            </ol>
           <li value="3">
            Service Interoperability Requirements 
            <ol>
             <li value="3">
              Characteristic Definition 
              <ol>
               <li value="1">
                Characteristic Declaration 
                <ol>
                 <li value="1"><dfn data-dfn-type="dfn" data-noexport="" id="characteristic-properties">Characteristic Properties<a class="self-link" href="#characteristic-properties"></a></dfn>
                </ol>
               <li value="3">
                Characteristic <dfn data-dfn-type="dfn" data-noexport="" id="descriptor">Descriptor<a class="self-link" href="#descriptor"></a></dfn> Declarations 
                <ol>
                 <li value="1"><dfn data-dfn-type="dfn" data-noexport="" id="characteristic-extended-properties">Characteristic Extended Properties<a class="self-link" href="#characteristic-extended-properties"></a></dfn>
                 <li value="3"><dfn data-dfn-type="dfn" data-noexport="" id="client-characteristic-configuration">Client Characteristic Configuration<a class="self-link" href="#client-characteristic-configuration"></a></dfn>
                </ol>
              </ol>
            </ol>
           <li value="4">
            GATT Feature Requirements — defines the <dfn data-dfn-type="dfn" data-lt="GATT procedure|GATT procedures" data-noexport="" id="gatt-procedure">GATT procedures<a class="self-link" href="#gatt-procedure"></a></dfn>. 
            <ol>
             <li value="4">
              <dfn data-dfn-type="dfn" data-noexport="" id="primary-service-discovery">Primary Service Discovery<a class="self-link" href="#primary-service-discovery"></a></dfn> 
              <ol>
               <li value="1"><dfn data-dfn-type="dfn" data-noexport="" id="discover-all-primary-services">Discover All Primary Services<a class="self-link" href="#discover-all-primary-services"></a></dfn>
               <li value="2"><dfn data-dfn-type="dfn" data-noexport="" id="discover-primary-service-by-service-uuid">Discover Primary Service by Service UUID<a class="self-link" href="#discover-primary-service-by-service-uuid"></a></dfn>
              </ol>
             <li value="5">
              <dfn data-dfn-type="dfn" data-noexport="" id="relationship-discovery">Relationship Discovery<a class="self-link" href="#relationship-discovery"></a></dfn> 
              <ol>
               <li value="1"><dfn data-dfn-type="dfn" data-noexport="" id="find-included-services">Find Included Services<a class="self-link" href="#find-included-services"></a></dfn>
              </ol>
             <li value="6">
              <dfn data-dfn-type="dfn" data-noexport="" id="characteristic-discovery">Characteristic Discovery<a class="self-link" href="#characteristic-discovery"></a></dfn> 
              <ol>
               <li value="1"><dfn data-dfn-type="dfn" data-noexport="" id="discover-all-characteristics-of-a-service">Discover All Characteristics of a Service<a class="self-link" href="#discover-all-characteristics-of-a-service"></a></dfn>
               <li value="2"><dfn data-dfn-type="dfn" data-noexport="" id="discover-characteristics-by-uuid">Discover Characteristics by UUID<a class="self-link" href="#discover-characteristics-by-uuid"></a></dfn>
              </ol>
             <li value="7">
              <dfn data-dfn-type="dfn" data-noexport="" id="characteristic-descriptor-discovery">Characteristic Descriptor Discovery<a class="self-link" href="#characteristic-descriptor-discovery"></a></dfn> 
              <ol>
               <li value="1"><dfn data-dfn-type="dfn" data-noexport="" id="discover-all-characteristic-descriptors">Discover All Characteristic Descriptors<a class="self-link" href="#discover-all-characteristic-descriptors"></a></dfn>
              </ol>
             <li value="8"><dfn data-dfn-type="dfn" data-noexport="" id="characteristic-value-read">Characteristic Value Read<a class="self-link" href="#characteristic-value-read"></a></dfn>
             <li value="9"><dfn data-dfn-type="dfn" data-noexport="" id="characteristic-value-write">Characteristic Value Write<a class="self-link" href="#characteristic-value-write"></a></dfn>
             <li value="10"><dfn data-dfn-type="dfn" data-noexport="" id="characteristic-value-notification">Characteristic Value Notification<a class="self-link" href="#characteristic-value-notification"></a></dfn>
             <li value="11"><dfn data-dfn-type="dfn" data-noexport="" id="characteristic-value-indications">Characteristic Value Indications<a class="self-link" href="#characteristic-value-indications"></a></dfn>
             <li value="12">
              <dfn data-dfn-type="dfn" data-noexport="" id="characteristic-descriptors">Characteristic Descriptors<a class="self-link" href="#characteristic-descriptors"></a></dfn> 
              <ol value="1"><dfn data-dfn-type="dfn" data-noexport="" id="read-characteristic-descriptors">Read Characteristic Descriptors<a class="self-link" href="#read-characteristic-descriptors"></a></dfn></ol>
              <ol value="2"><dfn data-dfn-type="dfn" data-noexport="" id="read-long-characteristic-descriptors">Read Long Characteristic Descriptors<a class="self-link" href="#read-long-characteristic-descriptors"></a></dfn></ol>
              <ol value="3"><dfn data-dfn-type="dfn" data-noexport="" id="write-characteristic-descriptors">Write Characteristic Descriptors<a class="self-link" href="#write-characteristic-descriptors"></a></dfn></ol>
              <ol value="4"><dfn data-dfn-type="dfn" data-noexport="" id="write-long-characteristic-descriptors">Write Long Characteristic Descriptors<a class="self-link" href="#write-long-characteristic-descriptors"></a></dfn></ol>
             <li value="14"><dfn data-dfn-type="dfn" data-local-lt="procedure times out" data-noexport="" id="procedure-timeouts">Procedure Timeouts<a class="self-link" href="#procedure-timeouts"></a></dfn>
            </ol>
           <li value="6">
            <dfn data-dfn-type="dfn" data-noexport="" id="gap-interoperability-requirements">GAP Interoperability Requirements<a class="self-link" href="#gap-interoperability-requirements"></a></dfn> 
            <ol>
             <li value="1">
              BR/EDR GAP Interoperability Requirements 
              <ol>
               <li value="1">Connection Establishment
              </ol>
             <li value="2">
              LE GAP Interoperability Requirements 
              <ol>
               <li value="1">Connection Establishment
              </ol>
            </ol>
           <li value="7">
            Defined Generic Attribute Profile Service 
            <ol>
             <li value="1"><dfn data-dfn-type="dfn" data-noexport="" id="service-changed">Service Changed<a class="self-link" href="#service-changed"></a></dfn>
            </ol>
          </ol>
         <li value="8">
          Security Manager Specification 
          <ol>
           <li value="2">
            Security Manager 
            <ol>
             <li value="4">
              Security in Bluetooth Low Energy 
              <ol>
               <li value="1"><dfn data-dfn-type="dfn" data-noexport="" id="definition-of-keys-and-values">Definition of Keys and Values<a class="self-link" href="#definition-of-keys-and-values"></a></dfn>,
                              defines the <dfn data-dfn-type="dfn" data-lt="Identity Resolving Key|IRK" data-noexport="" id="identity-resolving-key">Identity Resolving Key<a class="self-link" href="#identity-resolving-key"></a></dfn> (<abbr title="Identity Resolving Key">IRK</abbr>) 
              </ol>
            </ol>
          </ol>
        </ol>
       <li value="6">
        Core System Package [Low Energy Controller volume] 
        <ol type="A">
         <li value="2">
          Link Layer Specification 
          <ol>
           <li value="1">
            General Description 
            <ol>
             <li value="3">
              Device Address 
              <ol>
               <li value="1"><dfn data-dfn-type="dfn" data-noexport="" id="public-device-address">Public Device Address<a class="self-link" href="#public-device-address"></a></dfn>
               <li value="2">
                Random Device Address 
                <ol>
                 <li value="1"><dfn data-dfn-type="dfn" data-noexport="" id="static-device-address">Static Device Address<a class="self-link" href="#static-device-address"></a></dfn>
                </ol>
              </ol>
            </ol>
           <li value="4">
            Air Interface Protocol 
            <ol>
             <li value="4">
              Non-Connected States 
              <ol>
               <li value="3">
                Scanning State 
                <ol>
                 <li value="1"><dfn data-dfn-type="dfn" data-noexport="" id="passive-scanning">Passive Scanning<a class="self-link" href="#passive-scanning"></a></dfn>
                </ol>
              </ol>
            </ol>
          </ol>
        </ol>
      </ol>
     <dt><a data-link-type="biblio" href="#biblio-bluetooth-supplement5">[BLUETOOTH-SUPPLEMENT5]</a>
     <dd>
      <ol type="A">
       <li value="1">
        Data Types Specification 
        <ol>
         <li value="1">
          Data Types Definitions and Formats 
          <ol>
           <li value="1"><dfn data-dfn-type="dfn" data-local-lt="Service UUIDs" data-noexport="" id="service-uuid-data-type">Service UUID Data Type<a class="self-link" href="#service-uuid-data-type"></a></dfn>
           <li value="2"><dfn data-dfn-type="dfn" data-noexport="" id="local-name-data-type">Local Name Data Type<a class="self-link" href="#local-name-data-type"></a></dfn>
           <li value="3"><dfn data-dfn-type="dfn" data-noexport="" id="flags-data-type">Flags Data Type<a class="self-link" href="#flags-data-type"></a></dfn>
           <li value="4"><dfn data-dfn-type="dfn" data-noexport="" id="manufacturer-specific-data">Manufacturer Specific Data<a class="self-link" href="#manufacturer-specific-data"></a></dfn>
           <li value="5"><dfn data-dfn-type="dfn" data-noexport="" id="tx-power-level">TX Power Level<a class="self-link" href="#tx-power-level"></a></dfn>
           <li value="11"><dfn data-dfn-type="dfn" data-noexport="" id="service-data">Service Data<a class="self-link" href="#service-data"></a></dfn>
           <li value="12"><dfn data-dfn-type="dfn" data-noexport="" id="appearance">Appearance<a class="self-link" href="#appearance"></a></dfn>
          </ol>
        </ol>
      </ol>
    </dl>
   </section>
  </main>
  <h2 class="no-ref no-num heading settled" id="conformance"><span class="content"> Conformance</span><a class="self-link" href="#conformance"></a></h2>
  <p> Conformance requirements are expressed with a combination of descriptive assertions and RFC 2119 terminology.
        The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL”
        in the normative parts of this document
        are to be interpreted as described in RFC 2119.
        However, for readability,
        these words do not appear in all uppercase letters in this specification. </p>
  <p> All of the text of this specification is normative
        except sections explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119">[RFC2119]</a> </p>
  <p> Examples in this specification are introduced with the words “for example”
        or are set apart from the normative text with <code>class="example"</code>, like this: </p>
  <div class="example" id="example-ae2b6bc0"><a class="self-link" href="#example-ae2b6bc0"></a> This is an example of an informative example. </div>
  <p> Informative notes begin with the word “Note”
        and are set apart from the normative text with <code>class="note"</code>, like this: </p>
  <p class="note" role="note"> Note, this is an informative note. </p>
  <h2 class="no-num heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="indexlist">
   <li><a href="#active-notification-context-set">active notification context set</a><span>, in §5.4</span>
   <li><a href="#add-an-allowed-bluetooth-device">add an allowed Bluetooth device</a><span>, in §4.2</span>
   <li><a href="#dom-bluetoothdevice-addata">adData</a><span>, in §4.3</span>
   <li><a href="#advertising-data">Advertising Data</a><span>, in §9</span>
   <li><a href="#dom-bluetoothuuid-canonicaluuid-alias-alias">alias</a><span>, in §6.1</span>
   <li><a href="#allowed-devices-map">allowed devices map</a><span>, in §4.2</span>
   <li><a href="#allowed-services-list">allowed services list</a><span>, in §4.2</span>
   <li><a href="#appearance">Appearance</a><span>, in §9</span>
   <li><a href="#dom-bluetoothadvertisingdata-appearance">appearance</a><span>, in §4.3.1</span>
   <li><a href="#att-bearer">ATT Bearer</a><span>, in §9</span>
   <li><a href="#attribute">Attribute</a><span>, in §5.1</span>
   <li><a href="#attribute-caching">Attribute Caching</a><span>, in §9</span>
   <li><a href="#attribute-handle">Attribute Handle</a><span>, in §9</span>
   <li><a href="#attribute-type">Attribute Type</a><span>, in §9</span>
   <li><a href="#dom-bluetoothcharacteristicproperties-authenticatedsignedwrites">authenticatedSignedWrites</a><span>, in §5.4.1</span>
   <li><a href="#bd_addr">BD_ADDR</a><span>, in §9</span>
   <li><a href="#blacklisted">blacklisted</a><span>, in §7</span>
   <li><a href="#blacklisted-for-reads">blacklisted for reads</a><span>, in §7</span>
   <li><a href="#blacklisted-for-writes">blacklisted for writes</a><span>, in §7</span>
   <li><a href="#bluetooth">Bluetooth</a><span>, in §3</span>
   <li><a href="#dom-navigator-bluetooth">bluetooth</a><span>, in §8</span>
   <li><a href="#bluetoothadvertisingdata0">BluetoothAdvertisingData</a><span>, in §4.3.1</span>
   <li><a href="#bluetooth-cache0">Bluetooth cache</a><span>, in §5.1.1</span>
   <li><a href="#bluetoothcharacteristicproperties">BluetoothCharacteristicProperties</a><span>, in §5.4.1</span>
   <li><a href="#typedefdef-bluetoothcharacteristicuuid">BluetoothCharacteristicUUID</a><span>, in §6.1</span>
   <li><a href="#typedefdef-bluetoothdescriptoruuid">BluetoothDescriptorUUID</a><span>, in §6.1</span>
   <li><a href="#bluetoothdevice0">BluetoothDevice</a><span>, in §4.3</span>
   <li><a href="#bluetooth-device">Bluetooth device</a><span>, in §4.1</span>
   <li><a href="#bluetooth-device-name">Bluetooth Device Name</a><span>, in §9</span>
   <li><a href="#bluetoothgattcharacteristic0">BluetoothGATTCharacteristic</a><span>, in §5.4</span>
   <li><a href="#bluetoothgattdescriptor0">BluetoothGATTDescriptor</a><span>, in §5.5</span>
   <li><a href="#bluetoothgattremoteserver0">BluetoothGATTRemoteServer</a><span>, in §5.2</span>
   <li><a href="#bluetoothgattservice0">BluetoothGATTService</a><span>, in §5.3</span>
   <li><a href="#dictdef-bluetoothscanfilter">BluetoothScanFilter</a><span>, in §3</span>
   <li><a href="#typedefdef-bluetoothserviceuuid">BluetoothServiceUUID</a><span>, in §6.1</span>
   <li><a href="#bluetooth-tree0">Bluetooth tree</a><span>, in §5.6.1</span>
   <li><a href="#bluetoothuuid">BluetoothUUID</a><span>, in §6.1</span>
   <li><a href="#bonded-flag">bonded flag</a><span>, in §4.1</span>
   <li><a href="#bonding-procedure">Bonding Procedure</a><span>, in §9</span>
   <li><a href="#dom-bluetoothcharacteristicproperties-broadcast">broadcast</a><span>, in §5.4.1</span>
   <li><a href="#broadcaster">Broadcaster</a><span>, in §9</span>
   <li><a href="#dom-bluetoothuuid-canonicaluuid">canonicalUUID(alias)</a><span>, in §6.1</span>
   <li><a href="#central">Central</a><span>, in §9</span>
   <li>
    characteristic
    <ul>
     <li><a href="#dom-bluetoothgattservice-getcharacteristic-characteristic-characteristic">argument for BluetoothGATTService/getCharacteristic(characteristic)</a><span>, in §5.3</span>
     <li><a href="#dom-bluetoothgattservice-getcharacteristics-characteristic-characteristic">argument for BluetoothGATTService/getCharacteristics(characteristic), BluetoothGATTService/getCharacteristics()</a><span>, in §5.3</span>
     <li><a href="#dom-bluetoothgattdescriptor-characteristic">attribute for BluetoothGATTDescriptor</a><span>, in §5.5</span>
    </ul>
   <li><a href="#characteristic">Characteristic</a><span>, in §9</span>
   <li><a href="#characteristic-descriptor-discovery">Characteristic Descriptor Discovery</a><span>, in §9</span>
   <li><a href="#characteristic-descriptors">Characteristic Descriptors</a><span>, in §9</span>
   <li><a href="#characteristic-discovery">Characteristic Discovery</a><span>, in §9</span>
   <li><a href="#characteristiceventhandlers">CharacteristicEventHandlers</a><span>, in §5.6.5</span>
   <li><a href="#characteristic-extended-properties">Characteristic Extended Properties</a><span>, in §9</span>
   <li><a href="#characteristic-properties">Characteristic Properties</a><span>, in §9</span>
   <li><a href="#dom-bluetoothgattcharacteristic-characteristicvaluechanged">characteristicvaluechanged</a><span>, in §5.6.2</span>
   <li><a href="#characteristic-value-indications">Characteristic Value Indications</a><span>, in §9</span>
   <li><a href="#characteristic-value-notification">Characteristic Value Notification</a><span>, in §9</span>
   <li><a href="#characteristic-value-read">Characteristic Value Read</a><span>, in §9</span>
   <li><a href="#characteristic-value-write">Characteristic Value Write</a><span>, in §9</span>
   <li><a href="#class-of-device">Class of Device</a><span>, in §9</span>
   <li><a href="#client-characteristic-configuration">Client Characteristic Configuration</a><span>, in §9</span>
   <li><a href="#dom-bluetoothgattremoteserver-connected">connected</a><span>, in §5.2</span>
   <li><a href="#dom-bluetoothdevice-connectgatt">connectGATT()</a><span>, in §4.3</span>
   <li><a href="#connection-modes-and-procedures">Connection Modes and Procedures</a><span>, in §9</span>
   <li><a href="#create-a-bluetoothadvertisingdata">create a BluetoothAdvertisingData</a><span>, in §4.3.1</span>
   <li><a href="#create-a-bluetoothcharacteristicproperties-instance-from-the-characteristic">create a BluetoothCharacteristicProperties instance
            from the Characteristic</a><span>, in §5.4.1</span>
   <li><a href="#create-a-bluetoothgattcharacteristic-representing">create a BluetoothGATTCharacteristic representing</a><span>, in §5.4</span>
   <li><a href="#create-a-bluetoothgattdescriptor-representing">create a BluetoothGATTDescriptor representing</a><span>, in §5.5</span>
   <li><a href="#create-a-bluetoothgattservice-representing">create a BluetoothGATTService representing</a><span>, in §5.3</span>
   <li><a href="#definition-of-keys-and-values">Definition of Keys and Values</a><span>, in §9</span>
   <li><a href="#descriptor">Descriptor</a><span>, in §9</span>
   <li>
    descriptor
    <ul>
     <li><a href="#dom-bluetoothgattcharacteristic-getdescriptor-descriptor-descriptor">argument for BluetoothGATTCharacteristic/getDescriptor(descriptor)</a><span>, in §5.4</span>
     <li><a href="#dom-bluetoothgattcharacteristic-getdescriptors-descriptor-descriptor">argument for BluetoothGATTCharacteristic/getDescriptors(descriptor), BluetoothGATTCharacteristic/getDescriptors()</a><span>, in §5.4</span>
    </ul>
   <li>
    device
    <ul>
     <li><a href="#dom-bluetoothgattremoteserver-device">attribute for BluetoothGATTRemoteServer</a><span>, in §5.2</span>
     <li><a href="#dom-bluetoothgattservice-device">attribute for BluetoothGATTService</a><span>, in §5.3</span>
    </ul>
   <li><a href="#dom-bluetoothdevice-deviceclass">deviceClass</a><span>, in §4.3</span>
   <li><a href="#device-discovery-procedure">Device Discovery Procedure</a><span>, in §9</span>
   <li><a href="#device-id">device id</a><span>, in §4.2</span>
   <li><a href="#device-instance-map">device instance map</a><span>, in §4.3</span>
   <li><a href="#dom-bluetoothgattremoteserver-disconnect">disconnect()</a><span>, in §5.2</span>
   <li><a href="#discover-all-characteristic-descriptors">Discover All Characteristic Descriptors</a><span>, in §9</span>
   <li><a href="#discover-all-characteristics-of-a-service">Discover All Characteristics of a Service</a><span>, in §9</span>
   <li><a href="#discover-all-primary-services">Discover All Primary Services</a><span>, in §9</span>
   <li><a href="#discover-characteristics-by-uuid">Discover Characteristics by UUID</a><span>, in §9</span>
   <li><a href="#discover-primary-service-by-service-uuid">Discover Primary Service by Service UUID</a><span>, in §9</span>
   <li><a href="#error-response">Error Response</a><span>, in §9</span>
   <li><a href="#extended-inquiry-response">Extended Inquiry Response</a><span>, in §9</span>
   <li><a href="#dom-requestdeviceoptions-filters">filters</a><span>, in §3</span>
   <li><a href="#find-included-services">Find Included Services</a><span>, in §9</span>
   <li><a href="#flags-data-type">Flags Data Type</a><span>, in §9</span>
   <li><a href="#gap-interoperability-requirements">GAP Interoperability Requirements</a><span>, in §9</span>
   <li><a href="#generic-attribute-profile">GATT</a><span>, in §9</span>
   <li><a href="#gatt-blacklist0">GATT blacklist</a><span>, in §7</span>
   <li><a href="#gatt-client">GATT Client</a><span>, in §9</span>
   <li><a href="#gatt-procedure">GATT procedure</a><span>, in §9</span>
   <li><a href="#gatt-procedure">GATT procedures</a><span>, in §9</span>
   <li><a href="#gatt-profile-hierarchy">GATT Profile Hierarchy</a><span>, in §9</span>
   <li><a href="#dom-bluetoothdevice-gattserver">gattServer</a><span>, in §4.3</span>
   <li><a href="#gatt-server">GATT Server</a><span>, in §9</span>
   <li><a href="#general-discovery-procedure">General Discovery Procedure</a><span>, in §9</span>
   <li><a href="#generic-attribute-profile">Generic Attribute Profile</a><span>, in §9</span>
   <li><a href="#dom-bluetoothgattservice-getcharacteristic">getCharacteristic(characteristic)</a><span>, in §5.3</span>
   <li><a href="#dom-bluetoothuuid-getcharacteristic">getCharacteristic(name)</a><span>, in §6.1</span>
   <li><a href="#dom-bluetoothgattservice-getcharacteristics">getCharacteristics(characteristic)</a><span>, in §5.3</span>
   <li><a href="#dom-bluetoothgattcharacteristic-getdescriptor">getDescriptor(descriptor)</a><span>, in §5.4</span>
   <li><a href="#dom-bluetoothuuid-getdescriptor">getDescriptor(name)</a><span>, in §6.1</span>
   <li><a href="#dom-bluetoothgattcharacteristic-getdescriptors">getDescriptors(descriptor)</a><span>, in §5.4</span>
   <li><a href="#getgattchildren">GetGATTChildren</a><span>, in §5.1.2</span>
   <li><a href="#dom-bluetoothgattservice-getincludedservice">getIncludedService(service)</a><span>, in §5.3</span>
   <li><a href="#dom-bluetoothgattservice-getincludedservices">getIncludedServices(service)</a><span>, in §5.3</span>
   <li><a href="#dom-bluetoothgattremoteserver-getprimaryservice">getPrimaryService(service)</a><span>, in §5.2</span>
   <li><a href="#dom-bluetoothgattremoteserver-getprimaryservices">getPrimaryServices(service)</a><span>, in §5.2</span>
   <li><a href="#dom-bluetoothuuid-getservice">getService(name)</a><span>, in §6.1</span>
   <li><a href="#get-the-bluetoothdevice-representing">get the BluetoothDevice representing</a><span>, in §4.3</span>
   <li><a href="#dom-bluetoothdevice-id">id</a><span>, in §4.3</span>
   <li><a href="#identity-resolving-key">Identity Resolving Key</a><span>, in §9</span>
   <li><a href="#included-service">Included Service</a><span>, in §9</span>
   <li><a href="#dom-bluetoothcharacteristicproperties-indicate">indicate</a><span>, in §5.4.1</span>
   <li><a href="#identity-resolving-key">IRK</a><span>, in §9</span>
   <li><a href="#dom-bluetoothgattservice-isprimary">isPrimary</a><span>, in §5.3</span>
   <li><a href="#local-name-data-type">Local Name Data Type</a><span>, in §9</span>
   <li><a href="#long-attribute-values">Long Attribute Values</a><span>, in §9</span>
   <li><a href="#dom-bluetoothadvertisingdata-manufacturerdata">manufacturerData</a><span>, in §4.3.1</span>
   <li><a href="#manufacturer-specific-data">Manufacturer Specific Data</a><span>, in §9</span>
   <li><a href="#matches-a-filter">match a filter</a><span>, in §3</span>
   <li><a href="#matches-a-filter">matches a filter</a><span>, in §3</span>
   <li>
    name
    <ul>
     <li><a href="#dom-bluetoothdevice-name">attribute for BluetoothDevice</a><span>, in §4.3</span>
     <li><a href="#dom-bluetoothuuid-getservice-name-name">argument for BluetoothUUID/getService(name)</a><span>, in §6.1</span>
     <li><a href="#dom-bluetoothuuid-getcharacteristic-name-name">argument for BluetoothUUID/getCharacteristic(name)</a><span>, in §6.1</span>
     <li><a href="#dom-bluetoothuuid-getdescriptor-name-name">argument for BluetoothUUID/getDescriptor(name)</a><span>, in §6.1</span>
    </ul>
   <li><a href="#name-discovery-procedure">Name Discovery Procedure</a><span>, in §9</span>
   <li><a href="#dom-bluetoothcharacteristicproperties-notify">notify</a><span>, in §5.4.1</span>
   <li><a href="#observation-procedure">Observation Procedure</a><span>, in §9</span>
   <li><a href="#observer">Observer</a><span>, in §9</span>
   <li><a href="#dom-characteristiceventhandlers-oncharacteristicvaluechanged">oncharacteristicvaluechanged</a><span>, in §5.6.5</span>
   <li><a href="#dom-serviceeventhandlers-onserviceadded">onserviceadded</a><span>, in §5.6.5</span>
   <li><a href="#dom-serviceeventhandlers-onservicechanged">onservicechanged</a><span>, in §5.6.5</span>
   <li><a href="#dom-serviceeventhandlers-onserviceremoved">onserviceremoved</a><span>, in §5.6.5</span>
   <li><a href="#dom-requestdeviceoptions-optionalservices">optionalServices</a><span>, in §3</span>
   <li><a href="#dom-bluetooth-requestdevice-options-options">options</a><span>, in §3</span>
   <li><a href="#dom-bluetoothdevice-paired">paired</a><span>, in §4.3</span>
   <li><a href="#parsing-the-blacklist">parsing the blacklist</a><span>, in §7</span>
   <li><a href="#passive-scanning">Passive Scanning</a><span>, in §9</span>
   <li><a href="#peripheral">Peripheral</a><span>, in §9</span>
   <li><a href="#populate-the-bluetooth-cache">populate the Bluetooth cache</a><span>, in §5.1.1</span>
   <li><a href="#primary-service-discovery">Primary Service Discovery</a><span>, in §9</span>
   <li><a href="#privacy-feature">Privacy Feature</a><span>, in §9</span>
   <li><a href="#private-address">Private address</a><span>, in §9</span>
   <li><a href="#procedure-timeouts">Procedure Timeouts</a><span>, in §9</span>
   <li><a href="#procedure-timeouts">procedure times out</a><span>, in §9</span>
   <li><a href="#dom-bluetoothdevice-productid">productID</a><span>, in §4.3</span>
   <li><a href="#dom-bluetoothdevice-productversion">productVersion</a><span>, in §4.3</span>
   <li><a href="#profile-fundamentals">Profile Fundamentals</a><span>, in §9</span>
   <li><a href="#dom-bluetoothgattcharacteristic-properties">properties</a><span>, in §5.4</span>
   <li><a href="#public-bluetooth-address">Public Bluetooth Address</a><span>, in §9</span>
   <li><a href="#public-device-address">Public Device Address</a><span>, in §9</span>
   <li><a href="#query-the-bluetooth-cache">query the Bluetooth cache</a><span>, in §5.1.1</span>
   <li><a href="#dom-bluetoothcharacteristicproperties-read">read</a><span>, in §5.4.1</span>
   <li><a href="#read-bd_addr-command">Read BD_ADDR Command</a><span>, in §9</span>
   <li><a href="#read-characteristic-descriptors">Read Characteristic Descriptors</a><span>, in §9</span>
   <li><a href="#read-long-characteristic-descriptors">Read Long Characteristic Descriptors</a><span>, in §9</span>
   <li><a href="#read-only-arraybuffer">read only ArrayBuffer</a><span>, in §9</span>
   <li><a href="#read-only-map">read only Map</a><span>, in §9</span>
   <li>
    readValue()
    <ul>
     <li><a href="#dom-bluetoothgattcharacteristic-readvalue">method for BluetoothGATTCharacteristic</a><span>, in §5.4</span>
     <li><a href="#dom-bluetoothgattdescriptor-readvalue">method for BluetoothGATTDescriptor</a><span>, in §5.5</span>
    </ul>
   <li><a href="#rssi">Received Signal Strength Indication</a><span>, in §9</span>
   <li><a href="#relationship-discovery">Relationship Discovery</a><span>, in §9</span>
   <li><a href="#dom-bluetoothcharacteristicproperties-reliablewrite">reliableWrite</a><span>, in §5.4.1</span>
   <li><a href="#dom-bluetooth-requestdevice">requestDevice(options)</a><span>, in §3</span>
   <li><a href="#dictdef-requestdeviceoptions">RequestDeviceOptions</a><span>, in §3</span>
   <li><a href="#resolvable-private-address-resolution-procedure">Resolvable Private Address Resolution Procedure</a><span>, in §9</span>
   <li><a href="#resolveuuidname">ResolveUUIDName</a><span>, in §6.1</span>
   <li><a href="#rssi">RSSI</a><span>, in §9</span>
   <li><a href="#dom-bluetoothadvertisingdata-rssi">rssi</a><span>, in §4.3.1</span>
   <li><a href="#same-attribute">same attribute</a><span>, in §5.1.3</span>
   <li><a href="#same-device">same device</a><span>, in §4.1</span>
   <li><a href="#scan-for-devices">scan for devices</a><span>, in §3</span>
   <li><a href="#searching-for-services">Searching for Services</a><span>, in §9</span>
   <li><a href="#service">Service</a><span>, in §9</span>
   <li>
    service
    <ul>
     <li><a href="#dom-bluetoothgattremoteserver-getprimaryservice-service-service">argument for BluetoothGATTRemoteServer/getPrimaryService(service)</a><span>, in §5.2</span>
     <li><a href="#dom-bluetoothgattremoteserver-getprimaryservices-service-service">argument for BluetoothGATTRemoteServer/getPrimaryServices(service), BluetoothGATTRemoteServer/getPrimaryServices()</a><span>, in §5.2</span>
     <li><a href="#dom-bluetoothgattservice-getincludedservice-service-service">argument for BluetoothGATTService/getIncludedService(service)</a><span>, in §5.3</span>
     <li><a href="#dom-bluetoothgattservice-getincludedservices-service-service">argument for BluetoothGATTService/getIncludedServices(service), BluetoothGATTService/getIncludedServices()</a><span>, in §5.3</span>
     <li><a href="#dom-bluetoothgattcharacteristic-service">attribute for BluetoothGATTCharacteristic</a><span>, in §5.4</span>
    </ul>
   <li><a href="#dom-bluetoothgattservice-serviceadded">serviceadded</a><span>, in §5.6.2</span>
   <li><a href="#service-changed">Service Changed</a><span>, in §9</span>
   <li><a href="#dom-bluetoothgattservice-servicechanged">servicechanged</a><span>, in §5.6.2</span>
   <li><a href="#dom-bluetoothadvertisingdata-servicedata">serviceData</a><span>, in §4.3.1</span>
   <li><a href="#service-data">Service Data</a><span>, in §9</span>
   <li><a href="#serviceeventhandlers">ServiceEventHandlers</a><span>, in §5.6.5</span>
   <li><a href="#dom-bluetoothgattservice-serviceremoved">serviceremoved</a><span>, in §5.6.2</span>
   <li><a href="#dom-bluetoothscanfilter-services">services</a><span>, in §3</span>
   <li><a href="#service-uuid-data-type">Service UUID Data Type</a><span>, in §9</span>
   <li><a href="#service-uuid-data-type">Service UUIDs</a><span>, in §9</span>
   <li><a href="#dom-bluetoothgattcharacteristic-startnotifications">startNotifications()</a><span>, in §5.4</span>
   <li><a href="#static-address">Static Address</a><span>, in §9</span>
   <li><a href="#static-device-address">Static Device Address</a><span>, in §9</span>
   <li><a href="#dom-bluetoothgattcharacteristic-stopnotifications">stopNotifications()</a><span>, in §5.4</span>
   <li><a href="#supported-physical-transports">supported physical transports</a><span>, in §4.1</span>
   <li><a href="#the-128-bit-uuid-represented">the 128-bit UUID represented</a><span>, in §9</span>
   <li><a href="#dom-bluetoothadvertisingdata-txpower">txPower</a><span>, in §4.3.1</span>
   <li><a href="#tx-power-level">TX Power Level</a><span>, in §9</span>
   <li>
    UUID
    <ul>
     <li><a href="#typedefdef-uuid">(typedef)</a><span>, in §6</span>
     <li><a href="#uuid">definition of</a><span>, in §9</span>
    </ul>
   <li>
    uuid
    <ul>
     <li><a href="#dom-bluetoothgattservice-uuid">attribute for BluetoothGATTService</a><span>, in §5.3</span>
     <li><a href="#dom-bluetoothgattcharacteristic-uuid">attribute for BluetoothGATTCharacteristic</a><span>, in §5.4</span>
     <li><a href="#dom-bluetoothgattdescriptor-uuid">attribute for BluetoothGATTDescriptor</a><span>, in §5.5</span>
    </ul>
   <li><a href="#uuid-alias">UUID alias</a><span>, in §9</span>
   <li><a href="#dom-bluetoothdevice-uuids">uuids</a><span>, in §4.3</span>
   <li><a href="#valid-uuid">valid UUID</a><span>, in §6</span>
   <li>
    value
    <ul>
     <li><a href="#dom-bluetoothgattcharacteristic-writevalue-value-value">argument for BluetoothGATTCharacteristic/writeValue(value)</a><span>, in §5.4</span>
     <li><a href="#dom-bluetoothgattcharacteristic-value">attribute for BluetoothGATTCharacteristic</a><span>, in §5.4</span>
     <li><a href="#dom-bluetoothgattdescriptor-writevalue-value-value">argument for BluetoothGATTDescriptor/writeValue(value)</a><span>, in §5.5</span>
     <li><a href="#dom-bluetoothgattdescriptor-value">attribute for BluetoothGATTDescriptor</a><span>, in §5.5</span>
    </ul>
   <li><a href="#dom-bluetoothdevice-vendorid">vendorID</a><span>, in §4.3</span>
   <li><a href="#enumdef-vendoridsource">VendorIDSource</a><span>, in §4.3</span>
   <li><a href="#dom-bluetoothdevice-vendoridsource">vendorIDSource</a><span>, in §4.3</span>
   <li><a href="#dom-bluetoothcharacteristicproperties-writableauxiliaries">writableAuxiliaries</a><span>, in §5.4.1</span>
   <li><a href="#dom-bluetoothcharacteristicproperties-write">write</a><span>, in §5.4.1</span>
   <li><a href="#write-characteristic-descriptors">Write Characteristic Descriptors</a><span>, in §9</span>
   <li><a href="#write-long-characteristic-descriptors">Write Long Characteristic Descriptors</a><span>, in §9</span>
   <li>
    writeValue(value)
    <ul>
     <li><a href="#dom-bluetoothgattcharacteristic-writevalue">method for BluetoothGATTCharacteristic</a><span>, in §5.4</span>
     <li><a href="#dom-bluetoothgattdescriptor-writevalue">method for BluetoothGATTDescriptor</a><span>, in §5.5</span>
    </ul>
   <li><a href="#dom-bluetoothcharacteristicproperties-writewithoutresponse">writeWithoutResponse</a><span>, in §5.4.1</span>
  </ul>
  <h3 class="no-num heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="indexlist">
   <li>
    <a data-link-type="biblio" href="#biblio-bluetooth-assigned">[BLUETOOTH-ASSIGNED]</a> defines the following terms:
    <ul>
     <li><a href="https://developer.bluetooth.org/gatt/characteristics/Pages/CharacteristicViewer.aspx?u=org.bluetooth.characteristic.body_sensor_location.xml#">org.bluetooth.characteristic.body_sensor_location</a>
     <li><a href="https://developer.bluetooth.org/gatt/characteristics/Pages/CharacteristicViewer.aspx?u=org.bluetooth.characteristic.gap.appearance.xml#">org.bluetooth.characteristic.gap.appearance</a>
     <li><a href="https://developer.bluetooth.org/gatt/characteristics/Pages/CharacteristicViewer.aspx?u=org.bluetooth.characteristic.heart_rate_control_point.xml#">org.bluetooth.characteristic.heart_rate_control_point</a>
     <li><a href="https://developer.bluetooth.org/gatt/characteristics/Pages/CharacteristicViewer.aspx?u=org.bluetooth.characteristic.heart_rate_measurement.xml#">org.bluetooth.characteristic.heart_rate_measurement</a>
     <li><a href="https://developer.bluetooth.org/gatt/characteristics/Pages/CharacteristicViewer.aspx?u=org.bluetooth.characteristic.ieee_11073-20601_regulatory_certification_data_list.xml#">org.bluetooth.characteristic.ieee_11073-20601_regulatory_certification_data_list</a>
     <li><a href="https://developer.bluetooth.org/gatt/characteristics/Pages/CharacteristicViewer.aspx?u=org.bluetooth.characteristic.pnp_id.xml#">org.bluetooth.characteristic.pnp_id</a>
     <li><a href="https://developer.bluetooth.org/gatt/descriptors/Pages/DescriptorViewer.aspx?u=org.bluetooth.descriptor.gatt.characteristic_presentation_format.xml#">org.bluetooth.descriptor.gatt.characteristic_presentation_format</a>
     <li><a href="https://developer.bluetooth.org/gatt/descriptors/Pages/DescriptorViewer.aspx?u=org.bluetooth.descriptor.gatt.client_characteristic_configuration.xml#">org.bluetooth.descriptor.gatt.client_characteristic_configuration</a>
     <li><a href="https://developer.bluetooth.org/gatt/services/Pages/ServiceViewer.aspx?u=org.bluetooth.service.cycling_power.xml#">org.bluetooth.service.cycling_power</a>
     <li><a href="https://developer.bluetooth.org/gatt/services/Pages/ServiceViewer.aspx?u=org.bluetooth.service.device_information.xml#">org.bluetooth.service.device_information</a>
     <li><a href="https://developer.bluetooth.org/gatt/services/Pages/ServiceViewer.aspx?u=org.bluetooth.service.heart_rate.xml#">org.bluetooth.service.heart_rate</a>
     <li><a href="https://www.bluetooth.org/en-us/specification/assigned-numbers/generic-access-profile#">shortened local name</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-ecmascript">[ECMASCRIPT]</a> defines the following terms:
    <ul>
     <li><a href="http://ecma-international.org/ecma-262/6.0/#sec-array-objects">Array</a>
     <li><a href="http://ecma-international.org/ecma-262/6.0/#sec-array.prototype.map">Array.prototype.map</a>
     <li><a href="http://ecma-international.org/ecma-262/6.0/#sec-arraybuffer-constructor">ArrayBuffer</a>
     <li><a href="http://ecma-international.org/ecma-262/6.0/#sec-dataview-constructor">DataView</a>
     <li><a href="http://ecma-international.org/ecma-262/6.0/#sec-map-constructor">Map</a>
     <li><a href="http://ecma-international.org/ecma-262/6.0/#sec-promise-objects">Promise</a>
     <li><a href="http://ecma-international.org/ecma-262/6.0/#sec-set-objects">Set</a>
     <li><a href="http://ecma-international.org/ecma-262/6.0/#sec-native-error-types-used-in-this-standard-typeerror">TypeError</a>
     <li><a href="http://ecma-international.org/ecma-262/6.0/#sec-typedarray-constructors">TypedArray</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-webidl">[WebIDL]</a> defines the following terms:
    <ul>
     <li><a href="https://heycam.github.io/webidl/#common-BufferSource">BufferSource</a>
     <li><a href="https://heycam.github.io/webidl/#invalidmodificationerror">InvalidModificationError</a>
     <li><a href="https://heycam.github.io/webidl/#networkerror">NetworkError</a>
     <li><a href="https://heycam.github.io/webidl/#notfounderror">NotFoundError</a>
     <li><a href="https://heycam.github.io/webidl/#notsupportederror">NotSupportedError</a>
     <li><a href="https://heycam.github.io/webidl/#securityerror">SecurityError</a>
     <li><a href="https://heycam.github.io/webidl/#syntaxerror">SyntaxError</a>
     <li><a href="https://heycam.github.io/webidl/#dfn-get-buffer-source-copy">a copy of the bytes held</a>
     <li><a href="https://heycam.github.io/webidl/#dfn-read-only-array">read only array</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-dom-ls">[dom-ls]</a> defines the following terms:
    <ul>
     <li><a href="https://dom.spec.whatwg.org/#eventtarget">EventTarget</a>
     <li><a href="https://dom.spec.whatwg.org/#concept-tree-child">children</a>
     <li><a href="https://dom.spec.whatwg.org/#concept-event-fire">fire an event</a>
     <li><a href="http://dom.spec.whatwg.org/#concept-tree-participate">participate in a tree</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-html">[HTML]</a> defines the following terms:
    <ul>
     <li><a href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a>
     <li><a href="https://html.spec.whatwg.org/multipage/webappapis.html#navigator">Navigator</a>
     <li><a href="https://html.spec.whatwg.org/multipage/browsers.html#allowed-to-show-a-popup">allowed to show a popup</a>
     <li><a href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-idl-attributes">event handler idl attribute</a>
     <li><a href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">in parallel</a>
     <li><a href="https://html.spec.whatwg.org/multipage/webappapis.html#incumbent-settings-object">incumbent settings object</a>
     <li><a href="https://html.spec.whatwg.org/multipage/webappapis.html#perform-a-microtask-checkpoint">perform a microtask checkpoint</a>
     <li><a href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">queue a task</a>
     <li><a href="https://html.spec.whatwg.org/multipage/webappapis.html#script-execution-environment">script execution environment</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-powerful-features">[powerful-features]</a> defines the following terms:
    <ul>
     <li><a href="https://w3c.github.io/webappsec/specs/powerfulfeatures/#secure-context">secure context</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-promises-guide">[promises-guide]</a> defines the following terms:
    <ul>
     <li><a href="https://www.w3.org/2001/tag/doc/promises-guide#a-new-promise">a new promise</a>
     <li><a href="https://www.w3.org/2001/tag/doc/promises-guide#a-promise-rejected-with">a promise rejected with</a>
     <li><a href="https://www.w3.org/2001/tag/doc/promises-guide#reject-promise">reject</a>
     <li><a href="https://www.w3.org/2001/tag/doc/promises-guide#resolve-promise">resolve</a>
     <li><a href="https://www.w3.org/2001/tag/doc/promises-guide#transforming-by">transforming</a>
     <li><a href="https://www.w3.org/2001/tag/doc/promises-guide#waiting-for-all">waiting for all</a>
    </ul>
  </ul>
  <h2 class="no-num heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-bluetooth-assigned"><a class="self-link" href="#biblio-bluetooth-assigned"></a>[BLUETOOTH-ASSIGNED]
   <dd><a href="https://www.bluetooth.org/en-us/specification/assigned-numbers">Assigned Numbers</a>. Living Standard. URL: <a href="https://www.bluetooth.org/en-us/specification/assigned-numbers">https://www.bluetooth.org/en-us/specification/assigned-numbers</a>
   <dt id="biblio-bluetooth-assigned-baseband"><a class="self-link" href="#biblio-bluetooth-assigned-baseband"></a>[BLUETOOTH-ASSIGNED-BASEBAND]
   <dd><a href="https://www.bluetooth.org/en-us/specification/assigned-numbers/baseband">Assigned Numbers for Baseband</a>. Living Standard. URL: <a href="https://www.bluetooth.org/en-us/specification/assigned-numbers/baseband">https://www.bluetooth.org/en-us/specification/assigned-numbers/baseband</a>
   <dt id="biblio-bluetooth-assigned-characteristics"><a class="self-link" href="#biblio-bluetooth-assigned-characteristics"></a>[BLUETOOTH-ASSIGNED-CHARACTERISTICS]
   <dd><a href="https://developer.bluetooth.org/gatt/characteristics/Pages/CharacteristicsHome.aspx">Bluetooth GATT Specifications > Characteristics</a>. Living Standard. URL: <a href="https://developer.bluetooth.org/gatt/characteristics/Pages/CharacteristicsHome.aspx">https://developer.bluetooth.org/gatt/characteristics/Pages/CharacteristicsHome.aspx</a>
   <dt id="biblio-bluetooth-assigned-descriptors"><a class="self-link" href="#biblio-bluetooth-assigned-descriptors"></a>[BLUETOOTH-ASSIGNED-DESCRIPTORS]
   <dd><a href="https://developer.bluetooth.org/gatt/descriptors/Pages/DescriptorsHomePage.aspx">Bluetooth GATT Specifications > Descriptors</a>. Living Standard. URL: <a href="https://developer.bluetooth.org/gatt/descriptors/Pages/DescriptorsHomePage.aspx">https://developer.bluetooth.org/gatt/descriptors/Pages/DescriptorsHomePage.aspx</a>
   <dt id="biblio-bluetooth-assigned-services"><a class="self-link" href="#biblio-bluetooth-assigned-services"></a>[BLUETOOTH-ASSIGNED-SERVICES]
   <dd><a href="https://developer.bluetooth.org/gatt/services/Pages/ServicesHome.aspx">Bluetooth GATT Specifications > Services</a>. Living Standard. URL: <a href="https://developer.bluetooth.org/gatt/services/Pages/ServicesHome.aspx">https://developer.bluetooth.org/gatt/services/Pages/ServicesHome.aspx</a>
   <dt id="biblio-bluetooth-supplement5"><a class="self-link" href="#biblio-bluetooth-supplement5"></a>[BLUETOOTH-SUPPLEMENT5]
   <dd><a href="https://www.bluetooth.org/DocMan/handlers/DownloadDoc.ashx?doc_id=291904">Supplement to the Bluetooth Core Specification Version 5</a>. 2 December 2014. URL: <a href="https://www.bluetooth.org/DocMan/handlers/DownloadDoc.ashx?doc_id=291904">https://www.bluetooth.org/DocMan/handlers/DownloadDoc.ashx?doc_id=291904</a>
   <dt id="biblio-bluetooth42"><a class="self-link" href="#biblio-bluetooth42"></a>[BLUETOOTH42]
   <dd><a href="https://www.bluetooth.org/DocMan/handlers/DownloadDoc.ashx?doc_id=286439">BLUETOOTH SPECIFICATION Version 4.2</a>. 2 December 2014. URL: <a href="https://www.bluetooth.org/DocMan/handlers/DownloadDoc.ashx?doc_id=286439">https://www.bluetooth.org/DocMan/handlers/DownloadDoc.ashx?doc_id=286439</a>
   <dt id="biblio-ecmascript"><a class="self-link" href="#biblio-ecmascript"></a>[ECMASCRIPT]
   <dd>Allen Wirfs-Brock. <a href="http://www.ecma-international.org/ecma-262/6.0/">ECMA-262 6th Edition, The ECMAScript 2015 Language Specification</a>. June 2015. Standard. URL: <a href="http://www.ecma-international.org/ecma-262/6.0/">http://www.ecma-international.org/ecma-262/6.0/</a>
   <dt id="biblio-html"><a class="self-link" href="#biblio-html"></a>[HTML]
   <dd>Ian Hickson. <a href="https://html.spec.whatwg.org/multipage/">HTML Standard</a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-webidl"><a class="self-link" href="#biblio-webidl"></a>[WebIDL]
   <dd>Cameron McCormack; Boris Zbarsky. <a href="http://www.w3.org/TR/WebIDL-1/">WebIDL Level 1</a>. 4 August 2015. WD. URL: <a href="http://www.w3.org/TR/WebIDL-1/">http://www.w3.org/TR/WebIDL-1/</a>
   <dt id="biblio-dom-ls"><a class="self-link" href="#biblio-dom-ls"></a>[DOM-LS]
   <dd>Document Object Model URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
   <dt id="biblio-powerful-features"><a class="self-link" href="#biblio-powerful-features"></a>[POWERFUL-FEATURES]
   <dd>Mike West; Yan Zhu. <a href="http://www.w3.org/TR/powerful-features/">Privileged Contexts</a>. 24 April 2015. WD. URL: <a href="http://www.w3.org/TR/powerful-features/">http://www.w3.org/TR/powerful-features/</a>
   <dt id="biblio-promises-guide"><a class="self-link" href="#biblio-promises-guide"></a>[PROMISES-GUIDE]
   <dd><a href="https://www.w3.org/2001/tag/doc/promises-guide">Writing Promise-Using Specifications</a>. 24 July 2015. Finding of the W3C TAG. URL: <a href="https://www.w3.org/2001/tag/doc/promises-guide">https://www.w3.org/2001/tag/doc/promises-guide</a>
   <dt id="biblio-rfc2119"><a class="self-link" href="#biblio-rfc2119"></a>[RFC2119]
   <dd>S. Bradner. <a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>. March 1997. Best Current Practice. URL: <a href="https://tools.ietf.org/html/rfc2119">https://tools.ietf.org/html/rfc2119</a>
   <dt id="biblio-rfc4122"><a class="self-link" href="#biblio-rfc4122"></a>[RFC4122]
   <dd>P. Leach; M. Mealling; R. Salz. <a href="https://tools.ietf.org/html/rfc4122">A Universally Unique IDentifier (UUID) URN Namespace</a>. July 2005. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc4122">https://tools.ietf.org/html/rfc4122</a>
  </dl>
  <h2 class="no-num heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
<pre class="idl">dictionary <a href="#dictdef-bluetoothscanfilter">BluetoothScanFilter</a> {
  sequence&lt;<a data-link-type="idl-name" href="#typedefdef-bluetoothserviceuuid">BluetoothServiceUUID</a>> <a class="idl-code" data-link-type="dict-member" data-type="sequence<BluetoothServiceUUID> " href="#dom-bluetoothscanfilter-services">services</a>;
};

dictionary <a href="#dictdef-requestdeviceoptions">RequestDeviceOptions</a> {
  required sequence&lt;<a data-link-type="idl-name" href="#dictdef-bluetoothscanfilter">BluetoothScanFilter</a>> <a class="idl-code" data-link-type="dict-member" data-type="sequence<BluetoothScanFilter> " href="#dom-requestdeviceoptions-filters">filters</a>;
  sequence&lt;<a data-link-type="idl-name" href="#typedefdef-bluetoothserviceuuid">BluetoothServiceUUID</a>> <a class="idl-code" data-default="None" data-link-type="dict-member" data-type="sequence<BluetoothServiceUUID> " href="#dom-requestdeviceoptions-optionalservices">optionalServices</a> = [];
};

interface <a href="#bluetooth">Bluetooth</a> {
  Promise&lt;<a data-link-type="idl-name" href="#bluetoothdevice0">BluetoothDevice</a>> <a class="idl-code" data-link-type="method" href="#dom-bluetooth-requestdevice">requestDevice</a>(<a data-link-type="idl-name" href="#dictdef-requestdeviceoptions">RequestDeviceOptions</a> <a href="#dom-bluetooth-requestdevice-options-options">options</a>);
};
<a data-link-type="idl-name" href="#bluetooth">Bluetooth</a> implements <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#eventtarget">EventTarget</a>;
<a data-link-type="idl-name" href="#bluetooth">Bluetooth</a> implements <a data-link-type="idl-name" href="#characteristiceventhandlers">CharacteristicEventHandlers</a>;
<a data-link-type="idl-name" href="#bluetooth">Bluetooth</a> implements <a data-link-type="idl-name" href="#serviceeventhandlers">ServiceEventHandlers</a>;

// Allocation authorities for Vendor IDs:
enum <a href="#enumdef-vendoridsource">VendorIDSource</a> {
  "bluetooth",
  "usb"
};

interface <a class="idl-code" data-link-type="interface" href="#bluetoothdevice0">BluetoothDevice</a> {
  readonly attribute DOMString <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="DOMString " href="#dom-bluetoothdevice-id">id</a>;
  readonly attribute DOMString? <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="DOMString? " href="#dom-bluetoothdevice-name">name</a>;
  readonly attribute <a data-link-type="idl-name" href="#bluetoothadvertisingdata0">BluetoothAdvertisingData</a> <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="BluetoothAdvertisingData " href="#dom-bluetoothdevice-addata">adData</a>;
  readonly attribute unsigned long? <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="unsigned long? " href="#dom-bluetoothdevice-deviceclass">deviceClass</a>;
  readonly attribute <a data-link-type="idl-name" href="#enumdef-vendoridsource">VendorIDSource</a>? <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="VendorIDSource? " href="#dom-bluetoothdevice-vendoridsource">vendorIDSource</a>;
  readonly attribute unsigned long? <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="unsigned long? " href="#dom-bluetoothdevice-vendorid">vendorID</a>;
  readonly attribute unsigned long? <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="unsigned long? " href="#dom-bluetoothdevice-productid">productID</a>;
  readonly attribute unsigned long? <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="unsigned long? " href="#dom-bluetoothdevice-productversion">productVersion</a>;
  readonly attribute boolean <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="boolean " href="#dom-bluetoothdevice-paired">paired</a>;
  readonly attribute <a data-link-type="idl-name" href="#bluetoothgattremoteserver0">BluetoothGATTRemoteServer</a>? <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="BluetoothGATTRemoteServer? " href="#dom-bluetoothdevice-gattserver">gattServer</a>;
  readonly attribute <a data-link-type="idl-name" href="#typedefdef-uuid">UUID</a>[] <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="UUID[] " href="#dom-bluetoothdevice-uuids">uuids</a>;
  Promise&lt;<a data-link-type="idl-name" href="#bluetoothgattremoteserver0">BluetoothGATTRemoteServer</a>> <a class="idl-code" data-link-type="method" href="#dom-bluetoothdevice-connectgatt">connectGATT</a>();
};
<a data-link-type="idl-name" href="#bluetoothdevice0">BluetoothDevice</a> implements <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#eventtarget">EventTarget</a>;
<a data-link-type="idl-name" href="#bluetoothdevice0">BluetoothDevice</a> implements <a data-link-type="idl-name" href="#characteristiceventhandlers">CharacteristicEventHandlers</a>;
<a data-link-type="idl-name" href="#bluetoothdevice0">BluetoothDevice</a> implements <a data-link-type="idl-name" href="#serviceeventhandlers">ServiceEventHandlers</a>;

interface <a class="idl-code" data-link-type="interface" href="#bluetoothadvertisingdata0">BluetoothAdvertisingData</a> {
  readonly attribute unsigned short? <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="unsigned short? " href="#dom-bluetoothadvertisingdata-appearance">appearance</a>;
  readonly attribute byte? <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="byte? " href="#dom-bluetoothadvertisingdata-txpower">txPower</a>;
  readonly attribute byte? <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="byte? " href="#dom-bluetoothadvertisingdata-rssi">rssi</a>;
  readonly attribute <a data-link-type="idl-name" href="http://ecma-international.org/ecma-262/6.0/#sec-map-constructor">Map</a> <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="Map " href="#dom-bluetoothadvertisingdata-manufacturerdata">manufacturerData</a>;
  readonly attribute <a data-link-type="idl-name" href="http://ecma-international.org/ecma-262/6.0/#sec-map-constructor">Map</a> <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="Map " href="#dom-bluetoothadvertisingdata-servicedata">serviceData</a>;
};

interface <a class="idl-code" data-link-type="interface" href="#bluetoothgattremoteserver0">BluetoothGATTRemoteServer</a> {
  readonly attribute <a data-link-type="idl-name" href="#bluetoothdevice0">BluetoothDevice</a> <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="BluetoothDevice " href="#dom-bluetoothgattremoteserver-device">device</a>;
  readonly attribute boolean <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="boolean " href="#dom-bluetoothgattremoteserver-connected">connected</a>;
  void <a class="idl-code" data-link-type="method" href="#dom-bluetoothgattremoteserver-disconnect">disconnect</a>();
  Promise&lt;<a data-link-type="idl-name" href="#bluetoothgattservice0">BluetoothGATTService</a>> <a class="idl-code" data-link-type="method" href="#dom-bluetoothgattremoteserver-getprimaryservice">getPrimaryService</a>(<a data-link-type="idl-name" href="#typedefdef-bluetoothserviceuuid">BluetoothServiceUUID</a> <a href="#dom-bluetoothgattremoteserver-getprimaryservice-service-service">service</a>);
  Promise&lt;sequence&lt;<a data-link-type="idl-name" href="#bluetoothgattservice0">BluetoothGATTService</a>>>
    <a class="idl-code" data-link-type="method" href="#dom-bluetoothgattremoteserver-getprimaryservices">getPrimaryServices</a>(optional <a data-link-type="idl-name" href="#typedefdef-bluetoothserviceuuid">BluetoothServiceUUID</a> <a href="#dom-bluetoothgattremoteserver-getprimaryservices-service-service">service</a>);
};
<a data-link-type="idl-name" href="#bluetoothgattremoteserver0">BluetoothGATTRemoteServer</a> implements <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#eventtarget">EventTarget</a>;
<a data-link-type="idl-name" href="#bluetoothgattremoteserver0">BluetoothGATTRemoteServer</a> implements <a data-link-type="idl-name" href="#characteristiceventhandlers">CharacteristicEventHandlers</a>;
<a data-link-type="idl-name" href="#bluetoothgattremoteserver0">BluetoothGATTRemoteServer</a> implements <a data-link-type="idl-name" href="#serviceeventhandlers">ServiceEventHandlers</a>;

interface <a class="idl-code" data-link-type="interface" href="#bluetoothgattservice0">BluetoothGATTService</a> {
  readonly attribute <a data-link-type="idl-name" href="#bluetoothdevice0">BluetoothDevice</a> <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="BluetoothDevice " href="#dom-bluetoothgattservice-device">device</a>;
  readonly attribute <a data-link-type="idl-name" href="#typedefdef-uuid">UUID</a> <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="UUID " href="#dom-bluetoothgattservice-uuid">uuid</a>;
  readonly attribute boolean <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="boolean " href="#dom-bluetoothgattservice-isprimary">isPrimary</a>;
  Promise&lt;<a data-link-type="idl-name" href="#bluetoothgattcharacteristic0">BluetoothGATTCharacteristic</a>>
    <a class="idl-code" data-link-type="method" href="#dom-bluetoothgattservice-getcharacteristic">getCharacteristic</a>(<a data-link-type="idl-name" href="#typedefdef-bluetoothcharacteristicuuid">BluetoothCharacteristicUUID</a> <a href="#dom-bluetoothgattservice-getcharacteristic-characteristic-characteristic">characteristic</a>);
  Promise&lt;sequence&lt;<a data-link-type="idl-name" href="#bluetoothgattcharacteristic0">BluetoothGATTCharacteristic</a>>>
    <a class="idl-code" data-link-type="method" href="#dom-bluetoothgattservice-getcharacteristics">getCharacteristics</a>(optional <a data-link-type="idl-name" href="#typedefdef-bluetoothcharacteristicuuid">BluetoothCharacteristicUUID</a> <a href="#dom-bluetoothgattservice-getcharacteristics-characteristic-characteristic">characteristic</a>);
  Promise&lt;<a data-link-type="idl-name" href="#bluetoothgattservice0">BluetoothGATTService</a>>
    <a class="idl-code" data-link-type="method" href="#dom-bluetoothgattservice-getincludedservice">getIncludedService</a>(<a data-link-type="idl-name" href="#typedefdef-bluetoothserviceuuid">BluetoothServiceUUID</a> <a href="#dom-bluetoothgattservice-getincludedservice-service-service">service</a>);
  Promise&lt;sequence&lt;<a data-link-type="idl-name" href="#bluetoothgattservice0">BluetoothGATTService</a>>>
    <a class="idl-code" data-link-type="method" href="#dom-bluetoothgattservice-getincludedservices">getIncludedServices</a>(optional <a data-link-type="idl-name" href="#typedefdef-bluetoothserviceuuid">BluetoothServiceUUID</a> <a href="#dom-bluetoothgattservice-getincludedservices-service-service">service</a>);
};
<a data-link-type="idl-name" href="#bluetoothgattservice0">BluetoothGATTService</a> implements <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#eventtarget">EventTarget</a>;
<a data-link-type="idl-name" href="#bluetoothgattservice0">BluetoothGATTService</a> implements <a data-link-type="idl-name" href="#characteristiceventhandlers">CharacteristicEventHandlers</a>;
<a data-link-type="idl-name" href="#bluetoothgattservice0">BluetoothGATTService</a> implements <a data-link-type="idl-name" href="#serviceeventhandlers">ServiceEventHandlers</a>;

interface <a class="idl-code" data-link-type="interface" href="#bluetoothgattcharacteristic0">BluetoothGATTCharacteristic</a> {
  readonly attribute <a data-link-type="idl-name" href="#bluetoothgattservice0">BluetoothGATTService</a> <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="BluetoothGATTService " href="#dom-bluetoothgattcharacteristic-service">service</a>;
  readonly attribute <a data-link-type="idl-name" href="#typedefdef-uuid">UUID</a> <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="UUID " href="#dom-bluetoothgattcharacteristic-uuid">uuid</a>;
  readonly attribute <a data-link-type="idl-name" href="#bluetoothcharacteristicproperties">BluetoothCharacteristicProperties</a> <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="BluetoothCharacteristicProperties " href="#dom-bluetoothgattcharacteristic-properties">properties</a>;
  readonly attribute ArrayBuffer? <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="ArrayBuffer? " href="#dom-bluetoothgattcharacteristic-value">value</a>;
  Promise&lt;<a data-link-type="idl-name" href="#bluetoothgattdescriptor0">BluetoothGATTDescriptor</a>> <a class="idl-code" data-link-type="method" href="#dom-bluetoothgattcharacteristic-getdescriptor">getDescriptor</a>(<a data-link-type="idl-name" href="#typedefdef-bluetoothdescriptoruuid">BluetoothDescriptorUUID</a> <a href="#dom-bluetoothgattcharacteristic-getdescriptor-descriptor-descriptor">descriptor</a>);
  Promise&lt;sequence&lt;<a data-link-type="idl-name" href="#bluetoothgattdescriptor0">BluetoothGATTDescriptor</a>>>
    <a class="idl-code" data-link-type="method" href="#dom-bluetoothgattcharacteristic-getdescriptors">getDescriptors</a>(optional <a data-link-type="idl-name" href="#typedefdef-bluetoothdescriptoruuid">BluetoothDescriptorUUID</a> <a href="#dom-bluetoothgattcharacteristic-getdescriptors-descriptor-descriptor">descriptor</a>);
  Promise&lt;ArrayBuffer> <a class="idl-code" data-link-type="method" href="#dom-bluetoothgattcharacteristic-readvalue">readValue</a>();
  Promise&lt;void> <a class="idl-code" data-link-type="method" href="#dom-bluetoothgattcharacteristic-writevalue">writeValue</a>(<a data-link-type="idl-name" href="https://heycam.github.io/webidl/#common-BufferSource">BufferSource</a> <a href="#dom-bluetoothgattcharacteristic-writevalue-value-value">value</a>);
  Promise&lt;void> <a class="idl-code" data-link-type="method" href="#dom-bluetoothgattcharacteristic-startnotifications">startNotifications</a>();
  Promise&lt;void> <a class="idl-code" data-link-type="method" href="#dom-bluetoothgattcharacteristic-stopnotifications">stopNotifications</a>();
};
<a data-link-type="idl-name" href="#bluetoothgattcharacteristic0">BluetoothGATTCharacteristic</a> implements <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#eventtarget">EventTarget</a>;
<a data-link-type="idl-name" href="#bluetoothgattcharacteristic0">BluetoothGATTCharacteristic</a> implements <a data-link-type="idl-name" href="#characteristiceventhandlers">CharacteristicEventHandlers</a>;

interface <a class="idl-code" data-link-type="interface" href="#bluetoothcharacteristicproperties">BluetoothCharacteristicProperties</a> {
  readonly attribute boolean <a data-readonly="" data-type="boolean " href="#dom-bluetoothcharacteristicproperties-broadcast">broadcast</a>;
  readonly attribute boolean <a data-readonly="" data-type="boolean " href="#dom-bluetoothcharacteristicproperties-read">read</a>;
  readonly attribute boolean <a data-readonly="" data-type="boolean " href="#dom-bluetoothcharacteristicproperties-writewithoutresponse">writeWithoutResponse</a>;
  readonly attribute boolean <a data-readonly="" data-type="boolean " href="#dom-bluetoothcharacteristicproperties-write">write</a>;
  readonly attribute boolean <a data-readonly="" data-type="boolean " href="#dom-bluetoothcharacteristicproperties-notify">notify</a>;
  readonly attribute boolean <a data-readonly="" data-type="boolean " href="#dom-bluetoothcharacteristicproperties-indicate">indicate</a>;
  readonly attribute boolean <a data-readonly="" data-type="boolean " href="#dom-bluetoothcharacteristicproperties-authenticatedsignedwrites">authenticatedSignedWrites</a>;
  readonly attribute boolean <a data-readonly="" data-type="boolean " href="#dom-bluetoothcharacteristicproperties-reliablewrite">reliableWrite</a>;
  readonly attribute boolean <a data-readonly="" data-type="boolean " href="#dom-bluetoothcharacteristicproperties-writableauxiliaries">writableAuxiliaries</a>;
};

interface <a class="idl-code" data-link-type="interface" href="#bluetoothgattdescriptor0">BluetoothGATTDescriptor</a> {
  readonly attribute <a data-link-type="idl-name" href="#bluetoothgattcharacteristic0">BluetoothGATTCharacteristic</a> <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="BluetoothGATTCharacteristic " href="#dom-bluetoothgattdescriptor-characteristic">characteristic</a>;
  readonly attribute <a data-link-type="idl-name" href="#typedefdef-uuid">UUID</a> <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="UUID " href="#dom-bluetoothgattdescriptor-uuid">uuid</a>;
  readonly attribute ArrayBuffer? <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="ArrayBuffer? " href="#dom-bluetoothgattdescriptor-value">value</a>;
  Promise&lt;ArrayBuffer> <a class="idl-code" data-link-type="method" href="#dom-bluetoothgattdescriptor-readvalue">readValue</a>();
  Promise&lt;void> <a class="idl-code" data-link-type="method" href="#dom-bluetoothgattdescriptor-writevalue">writeValue</a>(<a data-link-type="idl-name" href="https://heycam.github.io/webidl/#common-BufferSource">BufferSource</a> <a href="#dom-bluetoothgattdescriptor-writevalue-value-value">value</a>);
};

[NoInterfaceObject]
interface <a href="#characteristiceventhandlers">CharacteristicEventHandlers</a> {
  attribute <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler " href="#dom-characteristiceventhandlers-oncharacteristicvaluechanged">oncharacteristicvaluechanged</a>;
};

[NoInterfaceObject]
interface <a href="#serviceeventhandlers">ServiceEventHandlers</a> {
  attribute <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler " href="#dom-serviceeventhandlers-onserviceadded">onserviceadded</a>;
  attribute <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler " href="#dom-serviceeventhandlers-onservicechanged">onservicechanged</a>;
  attribute <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler " href="#dom-serviceeventhandlers-onserviceremoved">onserviceremoved</a>;
};

typedef DOMString <a href="#typedefdef-uuid">UUID</a>;
interface <a href="#bluetoothuuid">BluetoothUUID</a> {
  static <a data-link-type="idl-name" href="#typedefdef-uuid">UUID</a> <a class="idl-code" data-link-type="method" href="#dom-bluetoothuuid-getservice">getService</a>((DOMString or unsigned long) <a href="#dom-bluetoothuuid-getservice-name-name">name</a>);
  static <a data-link-type="idl-name" href="#typedefdef-uuid">UUID</a> <a class="idl-code" data-link-type="method" href="#dom-bluetoothuuid-getcharacteristic">getCharacteristic</a>((DOMString or unsigned long) <a href="#dom-bluetoothuuid-getcharacteristic-name-name">name</a>);
  static <a data-link-type="idl-name" href="#typedefdef-uuid">UUID</a> <a class="idl-code" data-link-type="method" href="#dom-bluetoothuuid-getdescriptor">getDescriptor</a>((DOMString or unsigned long) <a href="#dom-bluetoothuuid-getdescriptor-name-name">name</a>);

  static <a data-link-type="idl-name" href="#typedefdef-uuid">UUID</a> <a class="idl-code" data-link-type="method" href="#dom-bluetoothuuid-canonicaluuid">canonicalUUID</a>([EnforceRange] unsigned long <a href="#dom-bluetoothuuid-canonicaluuid-alias-alias">alias</a>);
};

typedef (DOMString or unsigned long) <a class="idl-code" data-link-type="typedef" href="#typedefdef-bluetoothserviceuuid">BluetoothServiceUUID</a>;
typedef (DOMString or unsigned long) <a class="idl-code" data-link-type="typedef" href="#typedefdef-bluetoothcharacteristicuuid">BluetoothCharacteristicUUID</a>;
typedef (DOMString or unsigned long) <a class="idl-code" data-link-type="typedef" href="#typedefdef-bluetoothdescriptoruuid">BluetoothDescriptorUUID</a>;

partial interface <a class="idl-code" data-link-type="interface" href="https://html.spec.whatwg.org/multipage/webappapis.html#navigator">Navigator</a> {
  readonly attribute <a data-link-type="idl-name" href="#bluetooth">Bluetooth</a> <a data-readonly="" data-type="Bluetooth " href="#dom-navigator-bluetooth">bluetooth</a>;
};

</pre>
  <h2 class="no-num heading settled" id="issues-index"><span class="content">Issues Index</span><a class="self-link" href="#issues-index"></a></h2>
  <div style="counter-reset:issue">
   <div class="issue">TODO: Nail down the amount of time.<a href="#issue-2f91a41d"> ↵ </a></div>
   <div class="issue"> Both <a data-link-type="dfn" href="#passive-scanning">passive scanning</a> and
            the <a data-link-type="dfn" href="#privacy-feature">Privacy Feature</a> avoid leaking the unique, immutable device ID.
            We ought to require UAs to use either one,
            but none of the OS APIs appear to expose either.
            Bluetooth also makes it hard to use <a data-link-type="dfn" href="#passive-scanning">passive scanning</a> since
            it doesn’t require <a data-link-type="dfn" href="#central">Central</a> devices to support the <a data-link-type="dfn" href="#observation-procedure">Observation Procedure</a>. <a href="#issue-fcedc6f5"> ↵ </a></div>
   <div class="issue"> All forms of BR/EDR inquiry/discovery
            appear to leak the unique, immutable device address. <a href="#issue-549b652c"> ↵ </a></div>
   <div class="issue"> We need a way for a site to register to receive an event
        when an interesting device comes within range. <a href="#issue-3bfaaba4"> ↵ </a></div>
   <div class="issue"> This needs a definition involving
            removing <code class="idl"><a data-link-type="idl" href="#bluetoothdevice0">BluetoothDevice</a></code> instances from <a data-link-type="dfn" href="#device-instance-map">device instance map</a>s
            and clearing out their [[representedDevice]] fields. <a href="#issue-32ef5736"> ↵ </a></div>
   <div class="issue">TODO: Write the algorithm to update this
              when an advertising packet is received.<a href="#issue-11ea2a6f"> ↵ </a></div>
   <div class="issue"> <a data-link-type="dfn" href="#characteristic-extended-properties">Characteristic Extended Properties</a> isn’t clear whether
                    the extended properties are immutable for a given Characteristic.
                    If they are, the UA should be allowed to cache them. <a href="#issue-25c55f53"> ↵ </a></div>
  </div>
 </body>
</html>